"use strict";(self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["shared~bundle.ReaderMode~bundle.Birdwatch~bundle.TwitterArticles~bundle.Compose~bundle.Settings~bund-d622e6ad"],{549116:(t,e,n)=>{n.d(e,{NR:()=>d,Yt:()=>c});var s=n(499627),r=n(56519);const o="liveTweetCounts",i="rweb/liveTweetCounts/UPDATE",a={};function c(t,e){return t[o][e]}function d(t){return(e,n)=>e({payload:t,type:i})}s.Z.register({[o]:function(t=a,e){if(!e)return t;switch(e.type){case r.ud:{const n=e.payload?.tweets;if(n){const e={...t};return Object.keys(n).forEach((t=>{e[t]&&delete e[t]})),e}return t}case i:return{...t,[e.payload.tweetId]:{...t[e.payload.tweetId],...e.payload.liveCounts}};default:return t}}})},137855:(t,e,n)=>{n.d(e,{HP:()=>a,NR:()=>c});var s=n(499627);const r="nudges",o={actioned_tweets:{}},i="rweb/nudges/SET_TWEET_NUDGE_ACTION_TAKEN";s.Z.register({[r]:function(t=o,e){return e&&e.type===i&&e.payload?{...t,actioned_tweets:{...t.actioned_tweets,[e.payload]:!0}}:t}});const a=(t,e)=>!!t[r].actioned_tweets[e],c=t=>({type:i,payload:t})},694180:(t,e,n)=>{n.d(e,{cM:()=>f,dS:()=>E,iY:()=>T});var s=n(370751),r=n(399896),o=n(663550),i=n(499627),a=n(917799);const c={},d=Object.freeze({REQUEST:"rweb/promotedContent/LOG_REQUEST",SUCCESS:"rweb/promotedContent/LOG_SUCCESS",FAILURE:"rweb/promotedContent/LOG_FAILURE"}),l="rweb/promotedContent/LOG_UNIQUE_EVENT",u=(0,s.Z)([o.dx.IMPRESSION,o.dx.DWELL]),p=(0,s.Z)([o.AJ.TREND_VIEW,o.AJ.SPOTLIGHT_IMPRESSION]),m=t=>({payload:{eventKey:t},type:l});const _=(t,e)=>!!t.promotedContent[e],E=t=>(e,n,{api:s})=>{const{event:o,impression_id:i,promoted_trend_id:c}=t,l=`trend-${c}-${o}`;if(p.has(o)&&_(n(),l))return Promise.resolve();const u={promoted_trend_id:c,event:o,impression_id:i};return(0,a._O)(e,{params:u,request:s.withEndpoint(r.Z).log})({actionTypes:d,context:"APP_PROMOTED_CONTENT_LOG",meta:u},((t,e)=>{if(!e&&p.has(o))return[m(l)]}))},f=({disclosureType:t,itemId:e,itemType:n,params:s})=>(o,i,{api:c})=>{const{event:l,impression_id:p}=s,E=`${n}-${e??"undefined"}-${p??"undefined"}-${l??"undefined"}`;if(u.has(l)&&_(i(),E))return Promise.resolve();const f=t&&"earned"===t.toLowerCase()?"1":null,T={...s,earned:f,epoch_ms:Date.now()};return(0,a._O)(o,{params:T,request:c.withEndpoint(r.Z).log})({actionTypes:d,context:"APP_PROMOTED_CONTENT_LOG",meta:T},((t,e)=>{if(!e&&u.has(l))return[m(E)]}))},T=t=>(e,n,{api:s})=>(0,a._O)(e,{params:t,request:s.withEndpoint(r.Z).log})({actionTypes:d,context:"APP_PROMOTED_CONTENT_LOG",meta:t});i.Z.register({promotedContent:function(t=c,e){if(!e)return t;if(e.type===l){if(!e.payload)return t;const{eventKey:n}=e.payload;return{...t,[n]:!0}}return t}})},629196:(t,e,n)=>{n.d(e,{r:()=>d});n(136728);var s=n(161821),r=n(390387),o=n(836255),i=n(255117),a=n(166506),c=n(919022);const d=(t,e)=>(n,d,{api:l,featureSwitches:u})=>n(c.ZP.mute(t,e)).then((()=>{const e=d(),c=(0,s.Z)(o.Z.selectAll(e)).reduce(((n,s)=>{if(null!=s)if(s.user===t)n[s.id_str]=!0;else if(s.retweeted_status){const r=o.Z.select(e,s.retweeted_status);r?.user===t&&(n[s.id_str]=!0)}return n}),{}),l=(0,r._h)(d()),u=l?[(0,i.ZP)({useLatest:!1,userId:l}).removeTweets(c),(0,i.ZP)({useLatest:!0,userId:l}).removeTweets(c)]:[],p=(0,a.k9)();if(p.selectInitialFetchStatus(e)&&!p.selectCanRefresh(e)){const n=(0,a.f8)(t,e,p);n&&u.push(n)}return n(u)}))},545521:(t,e,n)=>{n.d(e,{Z:()=>u});var s=n(99107),r=n(166852),o=n(841198),i=n(917799),a=n(312771),c=n(56519),d=n(877848);const l=t=>[(0,c.dP)(t)];function u({contextSuffix:t,getEndpointParams:e,getFetchApiEndpoint:n,mapEntitiesToActions:c=l,sliceKey:u,injectionOptions:{identityFunction:p}={}}){const m=[],_=t=>t[o.Yf]?.[u],E=t=>{const e=_(t);if(!e)return m;const n=e.items||m,s=e.injections;return s?.length>0?(0,r.Z)(s.concat(n),p):n},f=t=>{const e=_(t),n=E(t),s=n?.length>0;return e?(0,a.ke)(e.fetchStatus,s):a.ZP.NONE},T=s=>(r,a,{api:d})=>{const l=e(s);return(0,i._O)(r,{params:l,request:n(d)})(o.t5({contextSuffix:t,params:s,sliceKey:u}),(t=>{if(t)return c(t.entities)}))};return{select:_,selectItems:E,selectFetchStatus:f,fetch:T,fetchIfNeeded:t=>(e,n)=>{const r=n(),o=_(r),i=f(r);return!o||i!==a.ZP.LOADING&&i!==a.ZP.LOADED?e(T(t)):s.O4.resolve()},fetchBottom:t=>(e,n)=>{const r=n(),o=_(r),i=(t=>{const e=_(t);return e?.cursors?.next_cursor})(r);return o.fetchStatus[d.Yj.BOTTOM]!==a.ZP.LOADING&&i?e(T({...t,cursor:i})):s.O4.resolve()},injectItems:t=>o.WC({items:t,sliceKey:u,identityFunction:p}),removeItems:t=>o.Er({items:t,sliceKey:u,identityFunction:p})}}},841198:(t,e,n)=>{n.d(e,{Be:()=>y,Er:()=>I,Ev:()=>f,WC:()=>S,Yf:()=>u,t5:()=>g});n(571372);var s=n(166852),r=n(370751),o=n(499627),i=n(917799),a=n(312771),c=n(877848);const d={},l=[],u="slices",p=()=>({cursors:{},fetchStatus:{top:a.ZP.NONE,bottom:a.ZP.NONE},items:l,injections:l}),m=(0,i.dg)("rweb/slices","FETCH");const _=(t,e)=>{if(!e)return t;switch(e.type){case m.REQUEST:{const{direction:n}=e.meta;return n?{...t,fetchStatus:{...t.fetchStatus,[n]:a.ZP.LOADING}}:t}case m.SUCCESS:{const{direction:n}=e.meta,r=e.payload,o=t.items;return!n||r instanceof Error?t:{...t,items:(0,s.Z)(o.concat(r?.result)),cursors:{...r?.slice_info},error:null,fetchStatus:{...t.fetchStatus,[n]:a.ZP.LOADED}}}case m.FAILURE:{const{direction:n}=e.meta;return n?{...t,error:e.payload,fetchStatus:{...t.fetchStatus,[n]:a.ZP.FAILED}}:t}default:return t}},E="rweb/slices/CLEAR_PARTIAL_SLICES_CACHE",f=t=>({type:E,meta:{sliceKey:t}}),T="rweb/slices/DELETE_SLICE",y=t=>({type:T,meta:{sliceKey:t}}),w="rweb/slices/RESTORE_SLICE",h="rweb/slices/INJECT_ITEMS_SLICE",S=({identityFunction:t,items:e,sliceKey:n})=>({type:h,meta:{sliceKey:n,identityFunction:t},payload:e}),O="rweb/slices/REMOVE_ITEMS_SLICE",I=({identityFunction:t,items:e,sliceKey:n})=>({type:O,meta:{sliceKey:n,identityFunction:t},payload:e}),g=({contextSuffix:t,params:e,sliceKey:n})=>({actionTypes:m,context:`FETCH_${t}`,meta:{sliceKey:n,direction:e?.cursor?c.Yj.BOTTOM:c.Yj.TOP}});o.Z.register({[u]:function(t=d,e){if(!e)return t;const{sliceKey:n}=e.meta||{};if(!n)return t;switch(e.type){case T:{const e={...t};return delete e[n],e}case w:return{...t,[n]:e.payload};case E:{const e={...t};return Object.keys(e).forEach((t=>{t.includes(n)&&delete e[t]})),e}case h:{const r=t[n]||p(),o=e.meta.identityFunction?e.meta.identityFunction:void 0,i=Array.isArray(e.payload)?e.payload:void 0;return i?.length?{...t,[n]:{...r,injections:(0,s.Z)(i.concat(r.injections),o)}}:t}case O:{const s=t[n]||p(),o=e.meta.identityFunction?e.meta.identityFunction:void 0,i=Array.isArray(e.payload)?(0,r.Z)(o?e.payload.map(o):e.payload):void 0,a=(t,e)=>!i?.has(o?o(t,e,s.injections):t);return i?.size?{...t,[n]:{...s,injections:s.injections.filter(a),items:s.items.filter(a)}}:t}default:{const s=t[n]||p(),r=_(s,e);return{...t,[n]:{...r}}}}}})},251441:(t,e,n)=>{n.d(e,{Z:()=>y});n(571372);var s=n(506899),r=n(697926),o=n(265617),i=n(88963),a=n(163889),c=n(312771),d=n(502909),l=n(600823),u=n(3693),p=n(926597),m=n(298219);const _=(0,d.ZP)({namespace:"translationsTweets",fetchOneContext:"FETCH_TWEET_TRANSLATION",fetchOneEndpoint:t=>(e,n)=>t.withEndpoint(o.ZP).fetchTranslation(e,n).then(T),fetchOneParams:(t,e)=>({id:t,...e})}),E="empty string when done";_.fetchStreamedGrokTranslation=(t,e,n)=>async(n,s,{api:r})=>{const o=async s=>{const i=Date.now(),d={content_type:"POST",id:t,dst_lang:e.userLanguage,include_polls:e.includePolls},l={id:t,id_str:t,entities:{symbols:[],hashtags:[],user_mentions:[],urls:[],media:[],timestamps:[]},streamedTranslationFetchStatus:c.iF.LOADING,sourceLanguage:e.lang,destinationLanguage:e.userLanguage,translationSource:"Grok",text:"",pollTranslations:[]};n(_.updateOrAddOne(t,f({tweetId:t,translatedTweet:l})));const T=new AbortController;try{const s=await r.fetchClient.dispatch("/2/grok/translation.json",{method:"POST",credentials:"include",body:JSON.stringify(d),signal:T.signal});if(!s.ok)throw l.translationState=u.H.ERROR,l.streamedTranslationFetchStatus=c.iF.FAILED,n(_.updateOrAddOne(t,f({tweetId:t,translatedTweet:l}))),new Error(`invalid response ${s.status}`);const o=s.body?.getReader();if(!o)throw l.translationState=u.H.ERROR,l.streamedTranslationFetchStatus=c.iF.FAILED,n(_.updateOrAddOne(t,f({tweetId:t,translatedTweet:l}))),new Error("reader not present");const y=new TextDecoder;let w="",h="";const S=async s=>{const{done:r,value:d}=await(0,m.yE)("POST_TIMEOUT_BETWEEN_CHUNKS",(()=>o.read()),s?"FIRST_CHUNK":"BETWEEN_CHUNKS");if(r||!d){if(e.analytics.scribe({component:"grok_button_translation",element:"time_to_last_token_post",action:"complete",data:{duration_ms:Date.now()-i}}),0===w.length)throw E;return l.translationState=u.H.SUCCESS,l.streamedTranslationFetchStatus=c.iF.LOADED,l.text=w,void n(_.updateOrAddOne(t,f({tweetId:t,translatedTweet:l})))}s&&e.analytics.scribe({component:"grok_button_translation",element:"time_to_first_token_post",action:"complete",data:{duration_ms:Date.now()-i}});const T=y.decode(d);if(h+=T,h.includes("\n")){const e=h.split("\n");h=e.pop();for(const s of e){const e=JSON.parse(s);if(e.error)throw new Error(JSON.stringify(e.error));if(e.result&&"POST"===e.result.content_type){e.result.text&&(w+=e.result.text,l.text=w);const n=e.result.entities;if(n){if(n.urls){const{errors:e,result:s}=(0,p.bK)(n.urls);e.length>0&&(0,a.ZP)(`invalid url entities in translating tweet:${t} - ${e.join(",")}`),l.entities.urls=[...l.entities.urls??[],...s]}if(n.user_mentions){const{errors:e,result:s}=(0,p.l5)(n.user_mentions);e.length>0&&(0,a.ZP)(`invalid user mention entities in translating tweet:${t} - ${e.join(",")}`),l.entities.user_mentions=[...l.entities.user_mentions??[],...s]}n.hashtags&&(l.entities.hashtags=[...l.entities.hashtags??[],...n.hashtags]),n.symbols&&(l.entities.symbols=[...l.entities.symbols??[],...n.symbols])}}if(e.result&&"POLL"===e.result.content_type){const{index:t,text:n}=e.result;if(null!=t&&t>0&&null!=n){const e=t-1;null==l.pollTranslations&&(l.pollTranslations=[]),null==l.pollTranslations[e]?l.pollTranslations[e]=n:l.pollTranslations[e]+=n}}n(_.updateOrAddOne(t,f({tweetId:t,translatedTweet:l})))}}await S()};await S(!0)}catch(r){if(r===E&&s>0)return void await o(s-1);l.translationState=u.H.ERROR,l.streamedTranslationFetchStatus=c.iF.FAILED,n(_.updateOrAddOne(t,f({tweetId:t,translatedTweet:l}))),T.abort(),(0,a.ZP)(`Failed to translate tweet:${t} to ${e.userLanguage} - ${String(r)}`),r instanceof m.mn?e.analytics.scribe({component:"grok_button_translation",element:"FIRST_CHUNK"===r.type?"error_timeout_first_token_post":"error_timeout_within_tokens_post",action:"error"}):e.analytics.scribe({component:"grok_button_translation",element:"error_post",action:"error"})}};await o(1)};const f=({translatedTweet:t,tweetId:e})=>(0,s.Fv)(t,i.Z).entities.tweets[`${e}`],T=t=>{const e=Array.isArray(t)?t:[t];return{entities:{translationsTweets:(0,r.Z)(e,(t=>t.id_str))}}},y=l.Z.register(_)},3693:(t,e,n)=>{n.d(e,{H:()=>s});const s=Object.freeze({SUCCESS:"Success",ERROR:"Error",TIMEOUT:"Timeout",DISABLED:"Disabled",MISSING:"Missing",NOT_TRANSLATABLE:"NotTranslatable",NOT_CACHED:"NotCached",VISIBILITY_FILTERED:"VisibilityFiltered"})},556303:(t,e,n)=>{function s(t,e){const n=t.isTrue("responsive_web_grok_tweet_translation"),s=t.getNumberValue("responsive_web_grok_tweet_translation_limit",180);return n&&e.length<=s}n.d(e,{F:()=>s})},298219:(t,e,n)=>{n.d(e,{mn:()=>s,yE:()=>o});n(571372);class s extends Error{constructor(t){const e="FIRST_CHUNK"===t?"timeout to first chunk":"timeout between chunks";super(e),this.name="StreamingTimeoutError",this.message=e,this.type=t}}const r={},o=(t,e,n)=>{r[t]&&clearTimeout(r[t]);const o="FIRST_CHUNK"===n?1e4:5e3,i=new Promise(((e,i)=>{const a=setTimeout((()=>{i(new s(n)),delete r[t]}),o);r[t]=a}));return Promise.race([e(),i])}},268617:(t,e,n)=>{n.d(e,{Z:()=>i});var s=n(836255),r=n(390387),o=n(195250);const i=(t,e)=>(n,i,{api:a,featureSwitches:c})=>n(s.Z.unretweet(t,e)).then((()=>{const e=(0,r._h)(i()),a=s.Z.select(i(),t),d=a?.retweeted_status,l=a&&(d?s.Z.select(i(),d):a);if(e&&l&&(l.user!==e||l.id_str!==t))return n([(0,o.ZP)(c,e,"default").removeTweets({[t]:!0}),(0,o.ZP)(c,e,"with_replies").removeTweets({[t]:!0})])}))},977154:(t,e,n)=>{n.d(e,{H$:()=>u,ZP:()=>d,m:()=>l,qk:()=>p});var s=n(403911),r=n(750085),o=n(555875),i=n(218951);const a="bookmarks",c=(0,i.Z)({timelineId:a,network:{getEndpoint:t=>t.withEndpoint(s.Z).fetchBookmarksTimeline,getEndpointParams:({count:t,cursor:e})=>({count:t,cursor:"string"==typeof e?e:void 0})},formatResponse:r.Z,context:"FETCH_BOOKMARKS_TIMELINE",perfKey:"bookmarksGraphQL"}),d=c,l=t=>(0,i.Z)({timelineId:`bookmarkFolder-${t}`,network:{getEndpoint:t=>t.withEndpoint(s.Z).fetchBookmarkFolderTimeline,getEndpointParams:({cursor:e})=>({cursor:"string"==typeof e?e:void 0,bookmark_collection_id:t})},formatResponse:r.Z,context:"FETCH_BOOKMARK_FOLDER_TIMELINE",perfKey:"bookmarkFolderGraphQL"}),u=()=>(t,e,{api:n,featureSwitches:r})=>n.withEndpoint(s.Z).deleteAll().then((()=>t(c.deleteTimeline()))),p=o.CG.bind(null,a)},166506:(t,e,n)=>{n.d(e,{du:()=>l,f8:()=>u,k9:()=>d});var s=n(503768),r=n(750085),o=n(962741),i=n(466015),a=n(919022),c=n(218951);const d=()=>(0,c.Z)({timelineId:"mutedAccountsGraphQL",network:{getEndpoint:t=>t.withEndpoint(s.ZP).fetchMutedAccounts,getEndpointParams:({count:t,cursor:e})=>({count:t,cursor:"string"==typeof e?e:void 0})},context:"FETCH_MUTED_ACCOUNTS",perfKey:"mutedAccountsGraphql",formatResponse:r.Z}),l=t=>(e,n)=>{const s=n();e(t.selectEntries(s).filter((t=>{const e=t.type===o.ZP.User?t.content.id:"",n=a.ZP.select(s,e);return n&&!n.muting})).map((e=>t.removeEntry(e.entryId))))},u=(t,e,n)=>{if(!n.selectEntries(e).find((e=>e.type===o.ZP.User&&e.content.id===t))){const e=(0,i.OD)(t),s=(0,i.$0)({entryId:e,id:t,sortIndex:Date.now().toString()});return n.injectEntry(s)}}}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~bundle.ReaderMode~bundle.Birdwatch~bundle.TwitterArticles~bundle.Compose~bundle.Settings~bund-d622e6ad.c2e70baa.js.map