"use strict";(self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["modules.audio-b7a8a5fb"],{703533:(e,t,n)=>{n.d(t,{C:()=>d});var a=n(202784),s=n(154003),r=n(731708),i=n(392237),o=n(111677),c=n.n(o),l=n(484633),u=n(610214),p=n(979037);function d(e){const t=u.gy(),n=e.spaceUserRole===l.Q.host,i=(0,p.UH)();return a.createElement(s.ZP,{onPress:e.onPress,pullRight:!0,size:"medium",style:i?h.hidden:void 0,type:"destructiveText"},a.createElement(r.ZP,{size:"body",weight:"bold"},t?m.close:n?m.end:m.leave))}const m={leave:c().bb1d57b6,close:c().ia5e7488,end:c().c371fb9a},h=i.default.create((()=>({hidden:{display:"none"}})))},736346:(e,t,n)=>{n.d(t,{Z:()=>b});var a=n(202784),s=n(325686),r=n(138099),i=n(731708),o=n(154003),c=n(392237),l=n(111677),u=n.n(l),p=n(161335);const d=u().fb6c0bbc,m=u().e49a1f42,h=u().jf01aea4,f=u().j24c37b2;function b({onDismiss:e}){return a.createElement(r.Z,{onMaskClick:e,style:y.sheet,type:"bottom",withMask:!0},a.createElement(s.Z,{style:y.titleContainer},a.createElement(p.default,{style:y.icon}),a.createElement(i.ZP,{align:"center",color:"text",size:"headline1",weight:"bold"},d)),a.createElement(i.ZP,{align:"center",color:"text"},m),a.createElement(i.ZP,{align:"center",color:"text"},h),a.createElement(o.ZP,{backgroundColor:"purple500",color:"whiteOnColor",onPress:e,style:y.button},f))}const y=c.default.create((e=>({button:{width:"100%"},icon:{color:e.colors.purple500,height:e.spaces.space32,width:e.spaces.space32},sheet:{gap:e.spaces.space20,paddingHorizontal:e.spaces.space16,paddingVertical:e.spaces.space40},titleContainer:{alignItems:"center",gap:e.spaces.space8}})))},595561:(e,t,n)=>{n.d(t,{j:()=>V,q:()=>W});var a=n(807896),s=(n(136728),n(202784)),r=n(400752),i=n(555874),o=n(325686),c=n(107267),l=n(625944),u=n(844685),p=n(673510),d=n(154003),m=n(797553),h=n(143670),f=n(392237),b=n(111677),y=n.n(b),v=n(620763),C=n(123638),k=n(40904),g=n(41065),_=n(616894),E=n(149170),S=n(656898),I=n(304148),w=n(400915),x=n(757700),Z=n(952793),Q=n(625555),P=n(4427),T=n(790997),D=n(509599),L=n(443781),F=n(42134),U=n(670687),R=n(484633),z=n(36809),M=n(220919);const O={hostTitle:y().cededf2a,cohostTitle:y().i2caef48,speakerTitle:y().j245c654,listenerTitle:y().eda23a02,manage:y().h16eeb42,inviteToSpeak:y().b90eb348,removeFromSpeakers:y().d9a63e82,inviteToCohost:y().bd917b26,removeFromCohosts:y().d7357e7e,removeFromSpace:y().e68b09b4,blockAndRemoveLabel:y().bf307fc0,reportLabel:y().ccf2f24e,mute:y().hb568af4,unmute:y().bb1cbeb6,approveRequest:y().i22835de,denyRequest:y().cb59a0fe,requestsToSpeak:y().c2376960,inviteFormatter:y().aba7dcdd},H=y().f5c7aaa7,A=y().fc56c8b1,q=y().iba0f45d,B=y().dc066955,N=y().b53ed9ab,j=y().c3b5b829;function V(e){s.useEffect((()=>(e.isSideNavLayout||l.Z.disable(),function(){l.Z.enable()})),[e.isSideNavLayout]);const{audioSpaceId:t}=e,{cohosts:n,host:a,listeners:i,speakers:c}=(0,r.Dv)(z.Lg),u=(0,I.zC)(),[p,d]=s.useState({}),m=s.useCallback((e=>{d((t=>({...t,[e.guest_user_id]:e})))}),[]),h=u.filter((e=>!p.hasOwnProperty(e.guest_user_id))),{max_admin_capacity:f,max_guest_sessions:b}=(0,r.Dv)(S.Cm.maxCapacityAtom),y=f-1,v=b;return s.createElement(o.Z,{style:J.manageViewContainer},a&&s.createElement($,{audioSpaceId:t,participants:[a],type:R.Q.host}),s.createElement($,{audioSpaceId:t,capacity:y,listeners:i,participants:n,type:R.Q.cohost}),s.createElement($,{audioSpaceId:t,capacity:v,listeners:i,participants:c,type:R.Q.speaker}),h.length>0&&s.createElement(G,{audioSpaceId:t,onApproveOrDeny:m,prospectiveSpeakers:h}),s.createElement($,{audioSpaceId:t,participants:i,type:R.Q.listener}))}function W(){const e=(0,F.rx)()??"",{max_guest_sessions:t}=(0,r.Dv)(S.Cm.maxCapacityAtom),{listeners:n,speakers:a}=(0,r.Dv)(z.Lg),i=t,o=(0,I.zC)(),[c,l]=s.useState({}),u=o.filter((e=>!c.hasOwnProperty(e.guest_user_id))),p=s.useCallback((e=>{l((t=>({...t,[e.guest_user_id]:e})))}),[]);return s.createElement(s.Fragment,null,s.createElement($,{audioSpaceId:e,capacity:i,listeners:n,participants:a,type:R.Q.speaker}),u.length>0&&s.createElement(G,{audioSpaceId:e,onApproveOrDeny:p,prospectiveSpeakers:u}),n.length>0&&s.createElement($,{audioSpaceId:e,participants:n,type:R.Q.listener}))}function G(e){const{onApproveOrDeny:t,prospectiveSpeakers:n}=e;return s.createElement(i.Z,{ListHeaderComponent:s.createElement(u.Z,{subtext:j({count:n.length}),text:O.requestsToSpeak}),data:n,keyExtractor:function(e){return e.guest_user_id},numColumns:1,renderItem:function({item:e}){return s.createElement(K,{guestSession:e,onApproveOrDeny:t})}})}function K(e){const{guestSession:t,onApproveOrDeny:n}=e,{guest_avatar_url:a,guest_display_name:i,guest_user_id:c,guest_username:l}=t,u=(0,r.b9)(Q.FS),m=(0,r.b9)(Q.hs),h=s.useCallback((()=>{u(c),n(t)}),[u,t,n,c]),f=s.useCallback((()=>{m(c),n(t)}),[t,n,m,c]);return s.createElement(o.Z,{style:J.prospectiveSpeakerUserRow},s.createElement(p.ZP,{avatarUri:a,displayMode:"UserCompact",name:i,screenName:l,style:J.userCell,userId:c}),s.createElement(o.Z,{style:J.prospectiveSpeakerUserRowButtonsContainer},s.createElement(d.ZP,{borderColor:"blue500",color:"blue500",onPress:h,size:"small",style:J.prospectiveSpeakerUserRowButton},O.approveRequest),s.createElement(d.ZP,{borderColor:"red500",color:"red500",onPress:f,size:"small",style:J.prospectiveSpeakerUserRowButton},O.denyRequest)))}const Y=Object.freeze({[R.Q.host]:{title:O.hostTitle,maybePluralFormatter:H},[R.Q.cohost]:{title:O.cohostTitle,maybePluralFormatter:A},[R.Q.speaker]:{title:O.speakerTitle,maybePluralFormatter:q},[R.Q.listener]:{title:O.listenerTitle,maybePluralFormatter:B}});function $(e){const{audioSpaceId:t,capacity:n,listeners:a,participants:l,type:p}=e,{isUserAdminRole:m}=(0,w.l7)(),h=(0,r.b9)(Q.Yy),f=(0,r.b9)(Q.w),b=(0,c.useHistory)(),y=(0,Z.hC)("rweb_spaces_invite_search_enabled"),{maybePluralFormatter:v,title:C}=Y[p],[k,g]=s.useState(!1);const _=l?.length??0,E=n?N({participantCount:_,remainingCapacityCount:n-_,title:v({count:_})}):"",S=y&&n!==_&&m&&[R.Q.cohost,R.Q.speaker].includes(p);return s.createElement(o.Z,null,s.createElement(i.Z,{ListHeaderComponent:s.createElement(u.Z,{subtext:E,text:C}),data:l,keyExtractor:function(e){return e.twitter_screen_name??e.user_id??e.periscope_user_id},numColumns:1,renderItem:function({item:e}){return s.createElement(X,{audioSpaceId:t,type:p,user:e})}}),S&&s.createElement(d.ZP,{onPress:()=>g(!0),size:"small",type:"brandText"},O.inviteFormatter({name:C})),a&&k&&s.createElement(x.ZP,{clickMaskToClose:!0,history:b,modalSize:x.Cg.dynamic,onMaskClick:()=>{g(!1)}},s.createElement(M.Z,{handleInvites:e=>{e.map((e=>{e.user_id&&e.periscope_user_id&&(p===R.Q.speaker?h(t,e.user_id,e.periscope_user_id):p===R.Q.cohost&&f(t,e.user_id))})),g(!1)},users:a})))}function X(e){const{audioSpaceId:t,type:n,user:i}=e,{avatar_url:c,display_name:l,periscope_user_id:u="",twitter_screen_name:f,user_id:b=""}=i,[y,S]=s.useState(!1),I=s.useCallback((()=>{S(!y)}),[y]),x=[R.Q.host,R.Q.cohost,R.Q.speaker].includes(n),{isUserAdminRole:Z,role:F}=(0,w.l7)(),z=F===R.Q.host&&n===R.Q.cohost,M=(0,L.QZ)().viewerUserId,H=(0,r.b9)(Q.Yy),A=(0,r.b9)(Q.w),q=(0,r.b9)(Q.N8),B=(0,r.b9)(Q.ZN),N=(0,r.b9)(T.jo),j=(0,r.b9)(Q.rc),V=(0,r.Dv)(D.p5),W=(0,r.Dv)(P.MG),G=(0,r.Dv)((0,T.Bz)(u)),K=(0,r.Dv)((0,U.kD)(G));if(!(c&&l&&f))return null;function Y(){q(t,u)}function $(){B(t,b)}const X=[];return Z?(x||X.push({Icon:v.default,actionText:O.inviteToSpeak,onClick:function(){H(t,b,u)}}),x&&n!==R.Q.host&&!K&&X.push({Icon:C.default,actionText:O.mute,onClick:Y}),F===R.Q.host&&(n===R.Q.cohost?X.push({Icon:k.default,actionText:O.removeFromCohosts,onClick:function(){j(t,b)}}):X.push({Icon:g.default,actionText:O.inviteToCohost,onClick:function(){A(t,b)}})),n===R.Q.speaker&&X.push({Icon:k.default,actionText:O.removeFromSpeakers,onClick:function(){G&&N(t,G)}}),(z||n===R.Q.listener||n===R.Q.speaker)&&X.push({Icon:_.default,actionText:O.removeFromSpace,onClick:$,textColor:"red500"})):(V&&M!==b&&x&&!K&&X.push({Icon:C.default,actionText:O.mute,onClick:Y}),V&&M!==b&&n===R.Q.speaker&&X.push({Icon:_.default,actionText:O.removeFromSpace,onClick:$,textColor:"red500"})),s.createElement(o.Z,{style:J.userCellRow},s.createElement(p.ZP,{avatarUri:c,displayMode:"UserCompact",name:l,screenName:f,style:J.userCell,userId:b,withLink:!W}),M!==b&&X.length>0&&s.createElement(d.ZP,{"aria-label":O.manage,hoverLabel:{label:O.manage},icon:s.createElement(E.default,null),onPress:I,size:"medium",type:"primaryText"}),y&&s.createElement(m.default,{isFixed:!0,onDismiss:I},X.map((e=>s.createElement(h.Z,(0,a.Z)({},e,{onClick:()=>{e.onClick(),S(!1)},key:e.actionText}))))))}const J=f.default.create((e=>({userCellRow:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},userCell:{flex:1},fill:{flex:1},redIcon:{color:e.colors.red300},manageViewContainer:{gap:e.spaces.space16},prospectiveSpeakerUserRow:{width:"100%",flexDirection:"column",justifyContent:"center"},prospectiveSpeakerUserRowButtonsContainer:{flexDirection:"row",gap:e.spaces.space16,marginStart:e.spaces.space16,marginEnd:e.spaces.space16,justifyContent:"center"},prospectiveSpeakerUserRowButton:{flex:1}})))},837759:(e,t,n)=>{n.d(t,{G3:()=>m,eD:()=>h,vW:()=>f});var a=n(202784),s=n(400752),r=n(565058),i=n(529356),o=n(111677),c=n.n(o),l=n(123638);const u=c().hd50e064,p=c().i76d640e,d=c().fdaa0be8,m=()=>{const[e,t]=(0,s.KO)(h),n=a.useCallback((()=>t(!1)),[t]);return e&&a.createElement(i.Z,{actionLabel:u,actionType:"primaryOutlined",enableMaskForDismiss:!0,graphic:l.default,headline:p,onAction:n,onClose:n,subtext:d,withCloseButton:!0})},h=(0,r.cn)(!1);function f(){return(0,s.b9)(h)}},24461:(e,t,n)=>{n.d(t,{d:()=>M});n(136728);var a=n(202784),s=n(400752),r=n(811176),i=n(154003),o=n(111677),c=n.n(o),l=n(941563),u=n(808525),p=n(133272),d=n(597237),m=n(656898),h=n(400915),f=n(952793),b=n(790997),y=n(254810),v=n(125363),C=n(390387),k=n(928875),g=n(42134),_=n(484633),E=n(384757),S=n(610214),I=n(325686),w=n(731708),x=n(721266),Z=n(451566),Q=n(392237),P=n(757700);const T=c().c0ce822e,D=c().caa8d928,L=c().ia5e7488;const F=Q.default.create((e=>({noiseSuppressionRow:{flexDirection:"row"},modalContainer:{padding:e.spaces.space20}}))),U=function({setIsMicSettingsModalOpen:e}){const[t,n]=(0,s.KO)(y.Qc);return a.createElement(P.ZP,{modalSize:P.Cg.dynamic,withBackground:!0},a.createElement(I.Z,{style:F.modalContainer},a.createElement(w.ZP,{size:"headline1",weight:"heavy"},T),a.createElement(x.Z,{axis:"y",size:"space32"}),a.createElement(I.Z,{style:F.noiseSuppressionRow},a.createElement(w.ZP,{align:"left"},D),a.createElement(x.Z,{axis:"x",size:"space16"}),a.createElement(Z.Z,{onValueChange:e=>n(e),value:t})),a.createElement(x.Z,{axis:"y",size:"space32"}),a.createElement(i.ZP,{onPress:()=>e(!1),type:"primaryFilled"},L)))};var R=n(384509);const z=c().c0ce822e;function M(e){const[t,n]=a.useState(!1),o=function(e,t,n){const a=(0,m.bd)(),r=(0,v.v9)(C.Qb),{openSheet:i}=S.VE(),o=(0,E.O)(e,(()=>i(S.IX.report))),c=(0,f.hC)("netzdg_in_spaces_enabled"),{isUserAdminRole:I,role:w}=(0,h.l7)(),x=(0,s.Dv)(y.fm),Z=(0,s.b9)(g.cI),Q=(0,R.q)({audioSpaceId:e}),P=(0,s.b9)(b.Hs),T=[];I&&T.push({Icon:l.default,text:O.spaceSettings,onClick:t});r&&x&&navigator.mediaDevices?.getSupportedConstraints?.().noiseSuppression&&T.push({Icon:u.default,text:z,selectable:!1,onClick:e=>{n(!0)}});w!==_.Q.speaker&&w!==_.Q.cohost||T.push({Icon:p.default,text:O.switchToListening,onClick:()=>{P({spaceId:e}).finally((()=>{Z(_.Q.listener)}))}});r&&(T.push({Icon:Q.Icon,text:Q.label,onClick:Q.onPress}),T.push({Icon:d.default,text:O.reportThisSpace,isEmphasized:!0,onClick:()=>{o(),a(":audiospace::caret:report:click")}}));c&&T.push(k.T({audioSpaceId:e}));return{items:T}}(e.audioSpaceId,e.handleShowSettingsView,n),[c,I]=a.useState(!1);if(o.items.length<1)return null;const w=c?a.createElement(r.Z,{isFixed:!0,items:o.items,onCloseRequested:()=>I(!1),shouldCloseOnClick:!0}):null;return a.createElement(a.Fragment,null,a.createElement(i.ZP,{"aria-label":O.more,borderColor:"transparent",color:"text",hoverLabel:{label:O.more},icon:e.icon,onPress:()=>I(!0),pullRight:e.pullRight,size:"medium",type:e.type}),w,t&&a.createElement(U,{setIsMicSettingsModalOpen:n}))}const O={more:c().h63a5c3c,reportThisSpace:c().f123fea8,switchToListening:c().a2bf8b8a,spaceSettings:c().fed1388a}},338645:(e,t,n)=>{n.d(t,{oG:()=>D,iK:()=>F});var a=n(807896),s=n(202784),r=n(400752),i=n(555874),o=n(325686),c=n(392237),l=n(625944),u=n(642139),p=n(418050),d=n(396963),m=n(113788),h=n(484633),f=n(36809),b=n(625125),y=n(947638),v=n(123638),C=n(2138),k=n(400915),g=n(663859),_=n(163889),E=n(790997),S=n(254810),I=n(526626),w=n(670687),x=n(877506);function Z(e){const{initiallyMuted:t,isHost:n,periscopeUserId:a}=e,{isUserSpeakingRole:i}=(0,k.l7)(),o=x.Z.useAudioLevel({isHost:n,periscopeUserId:a}),l=(0,r.Dv)((0,E.De)(a)),u=(0,w.bq)(l)??t,p=function(e){const t=(0,r.Dv)(E.kw),n=(0,r.Dv)(e&&e!==t?(0,E.xQ)(e):S.dB),[a,i]=s.useState(0),{isUserSpeakingRole:o}=(0,k.l7)();return s.useEffect((()=>{if(n&&o)try{const e=(0,C.Z)(i,250),t=(0,g.h)(n,(t=>{e(t)}));return()=>{t()}}catch(e){(0,_.Hj)(e)}}),[n,o]),a}(l),d={isMuted:u,audioLevel:i?p:o};return d.isMuted?s.createElement(v.default,{size:c.default.theme.spacesPx.space16,style:Q.mutedIcon}):s.createElement(I._,{audioLevel:d.audioLevel,size:c.default.theme.spacesPx.space16})}const Q=c.default.create((e=>({mutedIcon:{color:e.colors.red300,width:e.spaces.space16,height:e.spaces.space16}})));var P=n(979037);const T=4;function D(e){const{cohosts:t,host:n,listeners:d,speakers:v,total:C}=(0,r.Dv)(f.Lg),k=[...(n?[n]:[]).map((e=>({...e,kind:h.Q.host}))),...t.map((e=>({...e,kind:h.Q.cohost}))),...v.map((e=>({...e,kind:h.Q.speaker}))),...d],g=C-k.length;m.FN();const _=(0,p.C)(c.default.theme),E=T,S=(0,P.UH)();return s.useEffect((()=>{if(!S)return e.isSideNavLayout||l.Z.disable(),function(){l.Z.enable()}}),[S,e.isSideNavLayout]),s.useMemo((()=>{const t={data:k,numColumns:E,keyExtractor:function(e){return e.twitter_screen_name??e.user_id??e.periscope_user_id},getItemLayout:function(e,t){return{length:_,offset:_*t,index:t}},renderItem:function({item:e}){return s.createElement(L,{community:e.community,highlightedLabel:e.highlightedLabel,initiallyMuted:e.is_muted_by_guest||e.is_muted_by_admin,isBlueVerified:e.is_blue_verified,isHost:e.kind===h.Q.host,isVerified:e.is_verified,kind:e.kind||h.Q.listener,name:e.display_name,periscopeUserId:e.periscope_user_id||"",profile_image_url_https:e.avatar_url,screenName:e.twitter_screen_name,style:U.participantCell,verifiedType:e.verified_type})},ListHeaderComponent:s.createElement(b.W,{audioSpaceId:e.audioSpaceId}),ListFooterComponent:s.createElement(y.C,null,s.createElement(o.Z,{style:U.participantsFooterContainer},s.createElement(u.q,{audioSpaceId:e.audioSpaceId,count:g,interactive:!0})))};return s.createElement(i.Z,(0,a.Z)({key:E,style:U.participantsFlatList},t))}),[k])}function L(e){const{initiallyMuted:t,isHost:n,periscopeUserId:a,...r}=e,i={statusIndicator:[h.Q.host,h.Q.cohost,h.Q.speaker].includes(e.kind)&&a!==d.L1&&s.createElement(Z,{initiallyMuted:t,isHost:n,periscopeUserId:a}),periscopeUserId:a,...r};return s.createElement(p.Q,i)}function F(e){return{container:{paddingHorizontal:e.spacesPx.space8}}}const U=c.default.create((e=>({participantCell:{width:"25%"},participantsFlatList:{scrollbarWidth:"none"},participantsFooterContainer:{paddingVertical:e.spaces.space16}})))},979037:(e,t,n)=>{n.d(t,{N$:()=>y,Oy:()=>d,UH:()=>m,ZP:()=>v,ZZ:()=>p,cz:()=>b,w:()=>u});var a=n(202784),s=n(565058),r=n(400752),i=n(928316),o=n(398601),c=n(420182),l=n(359127);const u=600,p=(0,s.cn)(null),d=(0,s.cn)((e=>!!e(p)));function m(){return(0,r.Dv)(d)}const h=(0,s.cn)(),f=(0,s.cn)(null,((e,t,n)=>{e(h)?.fn(),t(h,n)})),b=(0,s.cn)(null,((e,t,{height:n,width:a})=>{if(null!=e(p))return Promise.resolve();const s=e(c.f0);return(0,l.Q$)({options:{width:a,height:n},featureSwitches:s}).then((({dispose:e,dpip:n})=>{n.addEventListener("pagehide",(function(){t(f,void 0),t(p,null)})),t(f,e?{fn:e}:void 0),t(p,n)}))})),y=(0,s.cn)(null,((e,t)=>{const n=e(p);n&&(t(f,void 0),n.close(),t(p,null))}));function v({children:e,pipWindow:t}){return(0,i.createPortal)(a.createElement(o.Bt,null,e),t.document.body)}(0,s.cn)(null,((e,t)=>{const n=e(p);n?.opener.focus()}))}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/modules.audio-b7a8a5fb.2c2d048a.js.map