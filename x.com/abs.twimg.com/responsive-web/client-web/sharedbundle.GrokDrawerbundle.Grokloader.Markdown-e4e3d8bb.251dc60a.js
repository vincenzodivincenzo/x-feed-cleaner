"use strict";(self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["shared~bundle.GrokDrawer~bundle.Grok~loader.Markdown-e4e3d8bb"],{839090:(e,t,a)=>{a.d(t,{Z:()=>n});a(202784);const n=(0,a(523561).Z)({loader:()=>Promise.all([a.e("icons.13"),a.e("icons.0"),a.e("icons.22"),a.e("icons.5"),a.e("icons.29"),a.e("icons.7"),a.e("icons.1"),a.e("icons.15"),a.e("icons.25"),a.e("icons.10"),a.e("icons.20"),a.e("modules.common-e907d115"),a.e("modules.common-e019dbda"),a.e("icons.11"),a.e("icons.16"),a.e("icons.24"),a.e("icons.9"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-289382e4"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-d2034e67"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-b903813c"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-2ff6f611"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-828b2167"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-84f39d3f"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-0bfd6d7b"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-23859224"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-91facaf4"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-6365605c"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~bundle.GrokDrawer~ondemand.-d60bd222"),a.e("shared~loader.Typeahead~loader.AppModules~loader.DMDrawer~ondemand.HoverCard~ondemand.NotFound~bundle.AboutTh"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-2078c561"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-9bd28fed"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-6a872481"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-9b130c11"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-d35a04b3"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-9b361606"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-885c42d5"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-7082ec04"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-fd0b2cf1"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-c7e58553"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-ff4a34e0"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-db3d5daf"),a.e("shared~loader.AudioDock~loader.DashMenu~loader.DashModal~loader.DMDrawer~ondemand.InlinePlayer~ondem-2d219c28"),a.e("shared~loader.Typeahead~loader.DMDrawer~ondemand.HoverCard~bundle.ReaderMode~bundle.AudioSpacePeek~bundle.Bir"),a.e("shared~bundle.JobSearch~bundle.UserJobs~loader.WideLayout"),a.e("loader.WideLayout")]).then(a.bind(a,616753))})},207137:(e,t,a)=>{a.d(t,{BC:()=>d,FI:()=>l,Pm:()=>i,gO:()=>r,zk:()=>o});const n=()=>new Date(Date.now());function o(e,t=n()){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}function r(e,t=n()){const a=new Date(t);return a.setHours(a.getHours()-24),o(e,a)}function i(e,t=n()){const a=new Date(t);return a.setHours(a.getHours()+24),o(e,a)}const s=6048e5;function l(e,t=n()){const a=t-e;return a>=0&&a<=s}function d(e,t){const a=new Date;return t<a||t<e?0:Math.min(1,(a-e)/(t-e))}},270172:(e,t,a)=>{a.d(t,{X:()=>o});var n=a(692518);const o=e=>(t,a,{api:o})=>{const r=(0,n.j)(e);return o.fetchClient.dispatch(r,{method:"GET",credentials:"include"}).then((e=>e.blob()))}},309373:(e,t,a)=>{a.d(t,{X:()=>l});var n=a(323265),o=a(389071),r=a(623494),i=a(958602),s=a(250781);const l=({analytics:e,conversationKey:t})=>({analysisEntityId:a,editingMessageId:l,fileAttachments:d,mode:c,onStart:m,returnCitations:u,returnSearchResults:p=!0,features:h={eagerTweets:!0,serverHistory:!0},text:g,trendPromptIdStr:y,imageGenerationCount:b,isReasoning:f,isDeepsearch:w,personalityId:D})=>async(c,y,{api:M,featureSwitches:I})=>{const v=!n.ZP.isTwitterApp()&&I.isTrue("responsive_web_grok_api_enable_grok_host"),k=(0,o.bD)(t),E=k.selectConversationId(y()),C=n.ZP.isAndroid(),P=n.ZP.isIOS();if(!E)return void(0,r.Uk)(e,"edit function failed to find a conversationId");const A=k.selectMode(y()),R=k.selectMessageIds(y()),Z=k.selectConversationWithLocalMessages(y()),_=(0,o.F9)(y()),x=R.indexOf(l);if(-1===x)return void(0,r.Uk)(e,"edit function couldn't find an actionable response");const U=Z[x];let L={promptSource:"NATURAL",action:"EDIT"};"IMAGE_EDIT"===U?.promptMetadata?.promptSource?L={...U.promptMetadata,action:"EDIT"}:"FOLLOW_UP"===U?.promptMetadata?.promptSource&&"IMAGE_GEN"===U?.promptMetadata?.properties?.messageType&&(L={promptSource:"FOLLOW_UP",action:"INPUT",properties:{followUpType:"MODIFY",messageType:"IMAGE_GEN"}});const S=[...Z.slice(0,x).map((e=>({message:e.message,fileAttachments:e.fileAttachments,sender:e.sender,isDeepsearch:e.isDeepsearch,isReasoning:e.isReasoning}))),{sender:U.sender,fileAttachments:d,message:g,isDeepsearch:w,isReasoning:f}],T=(0,o.en)(y());let z={};T&&T.toolOverrides&&(z=T.toolOverrides);const F={responses:S,systemPromptName:A,conversationId:E,grokModelOptionId:_?.id,modelMode:_?.mode,resampleResponseId:U.userChatItemId,returnSearchResults:p,returnCitations:u,requestFeatures:h,...a&&1===S.length?{analysisEntityId:a}:void 0,promptMetadata:L,imageGenerationCount:b,enableSideBySide:!C&&!P,isDeepsearch:w,isReasoning:f,personalityId:D,toolOverrides:z,deepsearchArgs:w?T?.deepsearchArgs:void 0};null!=k.selectCurrentResponseMessage(y())&&await c((0,i.I)({analytics:e,conversationKey:t})),g&&c(k.commitEditChanges(l,g,d)),(0,r.dd)(e,{conversationLength:S.length,isDeepsearch:F.isDeepsearch||void 0,isReasoning:F.isReasoning||void 0}),m?.();const O=I.isTrue("responsive_web_grok_enable_add_response_keepalive")&&(w||f);(0,s.D)({grokModule:k,requestBody:F,analytics:e,dispatch:c,api:M,eventTag:"rewrite",flags:{enableGrokApiHost:v,enableKeepalive:O},featureSwitches:I})}},480243:(e,t,a)=>{a.d(t,{W:()=>h});var n=a(927974),o=a(202784),r=a(565058),i=a(400752),s=a(10622),l=a.n(s),d=(a(585488),a(437429)),c=a.n(d);const m=n.Z,u=(0,r.cn)(void 0),p=(0,r.cn)([]);function h(){const e=c()(),[t,a]=(0,i.KO)(p),[n,r]=(0,i.KO)(u);o.useEffect((()=>{l()(e,m,{},{networkCacheConfig:{force:!1}}).toPromise().then((e=>{e?.grok_user_personalities?.personalities&&a([...e.grok_user_personalities.personalities])})).catch((e=>{}))}),[e,r,a]);const s=o.useCallback((e=>{r(e)}),[r]);return{userPersonalities:t,setGrokPersonality:s,getPersonality:e=>t.find((t=>t.personality_id===e)),currentPersonalityId:n}}},246277:(e,t,a)=>{a.d(t,{$:()=>S,Z:()=>T});var n=a(807896),o=a(202784),r=a(215045),i=a(325686),s=a(466792),l=a(67369),d=a(992942),c=a(392237),m=a(731708),u=a(154003),p=a(721266),h=a(111677),g=a.n(h),y=a(47086),b=a(161335),f=a(149170),w=a(837020),D=a(189700),M=a(839090),I=a(928831),v=a(45843),k=a(457566),E=a(774038);const C=({status:e,expectedChunks:t=[.25,.5,.75,1],intermediateResults:a=[],url:n,aspectRatio:r,isModerated:s,withActionRow:l,openMediaToEdit:c,onImageSize:m,mediaId:u,mediaUrl:p,allMediaIds:h,allMediaUrls:g})=>{const[y,b]=o.useState(0),f=A({expectedChunks:t,progress:y}),w=o.useMemo((()=>[...a].sort(((e,t)=>e.progress-t.progress)).map(((e,t)=>{const a=r??4/3,n=Math.round(a/e.progress*100)/100;return y>e.progress?null:o.createElement(d.Z,{key:`progress_${e.progress}`,onLoad:()=>{b((t=>Math.max(t,e.progress)))},resizeMode:"cover",source:e.imageUrl,style:[P.image,{aspectRatio:n}]})}))),[a,y,r]),D=a.length>0&&y>0,M=o.useMemo((()=>({top:0,height:100*y+"%",overflow:"hidden",transitionProperty:"height, mask",transitionDuration:`${f}ms`,transitionTimingFunction:1===y?"ease-in":"linear",zIndex:50,mask:y<1?"linear-gradient(\n        to bottom,\n        rgba(0, 0, 0, 1) 0%,\n        rgba(0, 0, 0, 1) calc(100% - 5px),\n        rgba(0, 0, 0, 0) 100%\n      )":void 0})),[y,f]),I=o.useMemo((()=>({top:0,height:100*y+"%",overflow:"hidden",transform:"translate3d(0,0,0)",transitionProperty:"height",transitionDuration:f/1.5+"ms",transitionTimingFunction:"linear",filter:"blur(70px) contrast(2)",zIndex:10})),[y,f]),[C,R]=o.useState(0);return o.useEffect((()=>{n&&v.Z.getSize(n,((e,t)=>{e&&t&&(R(e/t),m?.(e,t))}),(e=>{}))}),[n,R]),o.createElement(i.Z,{style:P.container},"loading"===e?o.createElement(i.Z,{style:P.logoContainer},o.createElement(k.x1,{style:P.grokIcon})):null,"loading"===e||"aborted"===e||D?o.createElement(o.Fragment,null,o.createElement(i.Z,{style:[P.content,M]},o.createElement(i.Z,{style:s||"aborted"===e?P.contentModerated:void 0},w)),o.createElement(i.Z,{style:[P.content,I]},w)):null,o.createElement(d.Z,{resizeMode:"cover",source:D||s?void 0:n,style:[P.finalImage,{aspectRatio:r??(C||4/3)}]}),l&&"aborted"!==e?o.createElement(i.Z,{style:[P.actionRow,P.animation]},o.createElement(E.rO,{allMediaIds:h,allMediaUrls:g,buttonSize:"medium",buttonType:"onMediaText",contentUrl:n,isLoading:"ready"!==e,mediaId:u,mediaUrl:p,setEditMode:c||(()=>{}),withStartAlignment:!0})):null)},P=c.default.create((e=>({animation:{opacity:1,animationDuration:".3s",animationTimingFunction:"ease-out",animationKeyframes:[{"0%":{opacity:0},"100%":{opacity:1}}]},actionRow:{position:"absolute",bottom:0,width:"100%",backdropFilter:"blur(4px) brightness(70%)",zIndex:300},content:{position:"absolute",height:"100%",width:"100%",start:0,opacity:1},contentModerated:{transitionProperty:"opacity",transitionDuration:"500ms",transitionTimingFunction:"linear",opacity:0},image:{position:"absolute",start:0,top:0,width:"100%",zIndex:100},transparent:{opacity:0},finalImage:{position:"relative",zIndex:200,width:"100%"},container:{borderRadius:e.borderRadii.large,backgroundColor:e.colors.gray50,transform:"translate3d(0,0,0)",width:"100%",overflow:"hidden",position:"relative"},logoContainer:{position:"absolute",start:0,top:0,width:"100%",height:"100%",justifyContent:"center",alignItems:"center",opacity:0,animationIterationCount:"infinite",animationDuration:"1.5s",animationKeyframes:[{"0%":{opacity:"0"},"50%":{opacity:"1"},"100%":{opacity:"0"}}]},grokIcon:{color:e.colors.gray200,width:"20%",maxWidth:e.spaces.space64,height:"20%",maxHeight:e.spaces.space64}}))),A=({expectedChunks:e,progress:t})=>{const a=o.useRef(Date.now());return o.useMemo((()=>{const n=Date.now()-a.current,o=0===t?1e4:n/t,r=e.findIndex((e=>e>=t)),i=e[r+1];if(-1===r)return 0;if(!i)return 200;return o*(i-t)*1.2}),[t,e])},R=g().e68b09b4,Z=g().c26b9b9c,_={label:R},x=g().ac85c6b2,U=g().g10600b0,L={label:U},S=["image/jpeg","image/webp","image/png"];function T({allMediaIds:e,allMediaUrls:t,aspectRatio:a,centerJustify:h,disableClickWhileLoading:g=!0,filename:v,height:k,intermediateResults:E,isInputAttachmentPreview:P,isModerated:A,mediaId:T,mediaUrl:F,menuItems:O,mimetype:G,onClick:j,onImageSize:N,onRemove:B,openMediaToEdit:H,preloadedImageUrl:W,status:J,style:K,url:$,useActionRowButtons:V,width:X}){const{handlers:Y,interactivityState:q}=(0,s.x)({}),Q=(0,l.yu)(),[ee,te]=o.useState(!1),ae=O&&O.length>0,[ne,oe]=o.useState(!1),re="error"===J,ie="aborted"===J,se=Q?60:80,le={width:1.5*se,height:se},de=o.useCallback((e=>{e.stopPropagation(),te(!0)}),[]),ce=o.useCallback((()=>te(!1)),[]),me=!X||!k||X>200&&k>150,ue=o.useMemo((()=>({width:X??"100%",height:k??"auto",outline:"none"})),[X,k]),pe=o.useCallback((e=>{e.stopPropagation(),e.preventDefault(),B?.()}),[B]),{isInputFocused:he}=(0,I.w)();if(S.includes(G)){const s="ready"===J&&ae&&q.isHovered&&!V;return o.createElement(r.Z,(0,n.Z)({disabled:g&&!$||ie},Y,{onLongPress:Q?de:void 0,onMouseEnter:()=>{oe(!0)},onMouseLeave:()=>{oe(!1)},onPress:j,style:[h&&{justifyContent:"center"},ue,A||re||ie?z.noClick:void 0,K]}),P?!$||$.startsWith("blob:")?o.createElement(i.Z,{style:[z.inputAttachmentPreview,z.inputAttachmentPreviewPlaceholder,{width:X??se,height:k??se}]}):o.createElement(d.Z,{resizeMode:"cover",source:W||$,style:[z.inputAttachmentPreview,{width:X??se,height:k??se}]}):o.createElement(C,{allMediaIds:e,allMediaUrls:t,aspectRatio:a,intermediateResults:E,isModerated:A,mediaId:T,mediaUrl:F,onImageSize:N,openMediaToEdit:H,resizeMode:"cover",status:J,url:W||$,withActionRow:V&&q.isHovered}),re?o.createElement(i.Z,{style:z.errorContainer},o.createElement(y.default,{color:c.default.theme.colors.gray600,style:z.errorIcon}),me?o.createElement(m.ZP,{size:"body",style:z.errorMessage},x):null):A||ie?o.createElement(i.Z,{style:z.errorContainer},o.createElement(b.default,{color:c.default.theme.colors.text,style:z.errorIconLarge})):null,o.createElement(i.Z,{style:z.imageButtonContainer},s?o.createElement(u.ZP,{"aria-label":U,hoverLabel:L,icon:o.createElement(f.default,null),onClick:de,size:"xSmall",type:"onMediaDominantColorFilled"}):null,ae&&ee?o.createElement(M.Z,{onDismiss:ce},o.createElement(r.Z,{onPress:ce},O)):null,B&&(Q||!Q&&ne)?o.createElement(u.ZP,{"aria-label":R,hoverLabel:_,icon:o.createElement(w.default,null),onClick:pe,size:"xSmall",style:z.removeBtn,type:"onMediaDominantColorFilled"}):null))}if(P){const e=function(e){if(!e||"string"!=typeof e)return"";const t=e.lastIndexOf(".");if(-1===t||0===t)return"";return e.slice(t+1).toLowerCase()}(v);return o.createElement(i.Z,{onMouseEnter:()=>{oe(!0)},onMouseLeave:()=>{oe(!1)},style:[z.inputAttachmentPreviewFileContainer,{width:X??le.width,height:k??le.height},K]},o.createElement(i.Z,{style:z.inputAttachmentPreviewFileContainerContent},o.createElement(m.ZP,{hoverLabel:{label:v},numberOfLines:2,selectable:!1,size:"subtext2"},v),o.createElement(i.Z,{style:z.inputAttachmentPreviewBottomContainer},o.createElement(i.Z,{style:z.inputAttachmentPreviewFileIconContainer},o.createElement(D.default,{style:z.inputAttachmentPreviewFileIcon})),o.createElement(m.ZP,{numberOfLines:1,size:"subtext3"},e.toUpperCase()))),B&&(Q||!Q&&ne)?o.createElement(o.Fragment,null,o.createElement(u.ZP,{"aria-label":R,hoverLabel:_,icon:o.createElement(w.default,null),onClick:pe,size:"xSmall",style:[z.removeBtn,z.inputAttachmentPreviewRemoveBtn],type:"onMediaDominantColorFilled"})):null)}return o.createElement(i.Z,{style:[z.documentContainer,he?z.documentContainerActive:null,K]},o.createElement(i.Z,{style:z.iconContainer},o.createElement(D.default,{style:z.documentIcon})),o.createElement(i.Z,{style:z.documentNameContainer},o.createElement(m.ZP,{hoverLabel:{label:v},numberOfLines:1,selectable:!1,size:"subtext2",weight:"medium"},v),o.createElement(p.Z,{size:"space4"}),o.createElement(m.ZP,{color:"gray700",selectable:!1,size:"subtext3",weight:"normal"},Z)),B&&(Q||!Q&&ne)?o.createElement(o.Fragment,null,o.createElement(p.Z,{size:"space4"}),o.createElement(u.ZP,{"aria-label":R,hoverLabel:_,icon:o.createElement(w.default,null),onClick:pe,size:"xSmall",style:z.removeBtn,type:"primaryText"})):null)}const z=c.default.create((e=>({documentContainer:{flexDirection:"row",alignItems:"center",width:"100%",maxWidth:"100%",paddingHorizontal:e.spaces.space12,paddingVertical:e.spaces.space12,gap:e.spaces.space8,backgroundColor:"light"===e.paletteName?e.colors.gray50:e.colors.gray100,borderRadius:e.spaces.space12,flexGrow:1,flexShrink:0},documentContainerActive:{backgroundColor:"light"===e.paletteName?e.colors.gray100:e.colors.gray200},noClick:{pointerEvents:"none"},iconContainer:{padding:6,justifyContent:"center",alignItems:"center",backgroundColor:"light"===e.paletteName?e.colors.gray100:e.colors.gray700,borderRadius:e.spaces.space8},documentIcon:{width:16,height:16},imageActivityIndicator:{position:"absolute",start:0,top:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center"},imageButtonContainer:{position:"absolute",top:e.spaces.space2,gap:e.spaces.space4,end:e.spaces.space2,display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"flex-start"},documentNameContainer:{minWidth:0,flex:1},errorContainer:{position:"absolute",start:0,top:0,width:"100%",height:"100%",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:e.spaces.space8,padding:e.spaces.space8},errorIcon:{width:24,height:24},errorIconLarge:{width:"15%",height:"15%",minHeight:24,minWidth:24},errorMessage:{color:e.colors.gray600},removeBtn:{animationDuration:"0.2s",animationKeyframes:[{"0%":{opacity:0},"100%":{opacity:1}}],animationTimingFunction:"ease",animationFillMode:"both",position:"absolute",top:0,end:0},inputAttachmentPreviewRemoveBtn:{top:e.spaces.space4,end:e.spaces.space4},inputAttachmentPreviewPlaceholder:{backgroundColor:"light"===e.paletteName?e.colors.gray100:e.colors.gray200},inputAttachmentPreview:{borderRadius:e.spaces.space8},inputAttachmentPreviewFileContainer:{position:"relative",borderRadius:e.spaces.space8,padding:e.spaces.space8,backgroundColor:"light"===e.paletteName?e.colors.gray100:e.colors.gray300},inputAttachmentPreviewFileContainerContent:{display:"flex",flexDirection:"column",justifyContent:"space-between",gap:e.spaces.space4,height:"100%"},inputAttachmentPreviewBottomContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:e.spaces.space4,padding:e.spaces.space4,borderRadius:e.spaces.space8,borderWidth:1,borderStyle:"solid",borderColor:"light"===e.paletteName?e.colors.gray200:e.colors.gray400,width:"max-content",overflow:"hidden"},inputAttachmentPreviewFileIconContainer:{width:e.spaces.space12,height:e.spaces.space12},inputAttachmentPreviewFileIcon:{width:"100%",height:"100%"}})))},335785:(e,t,a)=>{a.d(t,{L:()=>c});a(543673),a(240753),a(128399);var n=a(202784),o=a(325686),r=a(167630),i=a(392237),s=a(246277),l=a(523253),d=a(86657);function c({height:e,isInputAttachmentPreview:t,onRemove:a,selectedFile:i,width:c}){const u=n.useRef(void 0);if(n.useEffect((()=>{if(i?.local){const e=i.local,t=URL.createObjectURL(e);u.current!==t&&(u.current=t)}}),[i]),!i)return;return s.$.includes(i?.local?.type)||s.$.includes(i?.remote?.mimeType)?n.createElement(o.Z,null,i.remote&&n.createElement(o.Z,{style:m.default},n.createElement(d.Z,{file:i.remote,height:e,isImageActionsEnabled:!1,isInputAttachmentPreview:!0,isLoading:!1,onRemove:a,preloadedImageUrl:u.current,width:c})),i.local&&n.createElement(o.Z,{style:[m.default,i.remote?m.hidden:void 0]},n.createElement(l.Z,{file:i.local,height:e,isInputAttachmentPreview:!0,onRemove:a,width:c}),n.createElement(r.Z,{style:{top:"50%",start:"50%",position:"absolute",transform:"translate(-50%, -50%)"}}))):n.createElement(o.Z,null,i.remote?n.createElement(d.Z,{file:i.remote,height:e,isImageActionsEnabled:!1,isInputAttachmentPreview:!0,isLoading:!1,onRemove:a,preloadedImageUrl:u.current,width:c}):i.local?n.createElement(n.Fragment,null,n.createElement(l.Z,{file:i.local,height:e,isInputAttachmentPreview:!0,onRemove:a,width:c}),n.createElement(r.Z,{style:[{top:"50%",start:"50%",position:"absolute",transform:"translate(-50%, -50%)"},i.remote?m.hidden:void 0]})):null)}const m=i.default.create((e=>({default:{opacity:1,zIndex:1},hidden:{position:"absolute",zIndex:-1}})))},523253:(e,t,a)=>{a.d(t,{Z:()=>r});a(543673),a(240753),a(128399);var n=a(202784),o=a(246277);function r({file:e,height:t,isInputAttachmentPreview:a,onImageSize:r,onRemove:i,style:s,width:l}){const d=n.useMemo((()=>URL.createObjectURL(e)),[e]);return n.createElement(o.Z,{filename:e.name,height:t,isInputAttachmentPreview:a,mimetype:e.type,onImageSize:r,onRemove:i,status:"ready",style:s,url:d,width:l})}},86657:(e,t,a)=>{a.d(t,{Z:()=>R});a(543673),a(240753),a(128399),a(136728);var n=a(202784),o=a(107267),r=a(143670),i=a(111677),s=a.n(i),l=a(254944),d=a(72591),c=a(427783),m=a(186444),u=a(276259),p=a(323265),h=a(952793),g=a(128225),y=a(725516),b=a(125363),f=a(270172),w=a(601576),D=a(654917),M=a(246277);const I=s().j826e722,v=s().a9325f10,k=s().f88553c8,E=s().g0b12442,C=s().edd0c172,P=s().d1d3a41a,A=["ton.x.com","ton.twitter.com","pbs.twimg.com"];function R({allFileAttachments:e,allIntermediateImageResults:t,aspectRatio:a,centerJustify:i,extraMenuItems:s,file:R,height:Z,index:_,intermediateResults:x,isAborted:U,isImageActionsEnabled:L=!0,isInputAttachmentPreview:S,isLoading:T,messageId:z,onClick:F,onImageSize:O,onRemove:G,onViewed:j,preloadedImageUrl:N,style:B,useActionRowButtons:H,width:W,withMediaCarousel:J}){const K=(0,b.I0)(),$=(0,o.useHistory)(),V=(0,y.z)(),[X,Y]=n.useState(!1),[q,Q]=n.useState(),ee=!!p.ZP.isWebView(),te=(0,h.hC)("responsive_web_grok_webview_file_actions_enabled"),ae=(0,h.hC)("responsive_web_grok_image_edit"),ne=L&&(!ee||te),oe=!!R?.url&&A.includes(new URL(R.url).hostname),re=n.useMemo((()=>R.url&&oe||R.isPublic?R.url:q?URL.createObjectURL(q):void 0),[q,oe,R.isPublic,R.url]);n.useEffect((()=>{if(!R.url||R.isPublic||!u.v5.includes(R.mimeType)||oe)return;const e=R.url;Y(!0),K((0,f.X)(e)).then((e=>{Q(e??void 0)})).catch().finally((()=>{Y(!1)}))}),[R.url,R.isPublic,Y,oe,R.mimeType,K]);const{conversationKey:ie}=(0,D.ZP)(),se=n.useCallback((({editMode:a}={})=>{let n=R.mediaId;const o=R.url;if(!n&&o){n=new URL(o).searchParams.get("mediaId")??void 0}if(V.scribe({element:"expand_image",action:"click",data:{event_info:JSON.stringify({mediaId:n,mediaUrl:o,allMediaIds:e?e.map((e=>e.mediaId)):void 0,allMediaUrls:e?e.map((e=>e.url)):void 0})}}),J){const n="/i/grok/media-carousel";$.push({pathname:n,state:{file:R,messageId:z,conversationKey:ie,index:_,editMode:a,fileAttachments:e,intermediateImageResults:t}})}else{const e=!n||oe?"/i/grok/media":`/i/grok/media/${n}`;$.push({pathname:e,state:{file:R}})}j&&j({...R,mediaId:n})}),[R,$,oe,j,ie,_,z,J,e,V,t]),le=n.useCallback((()=>{se({editMode:!0})}),[se]),de=n.useMemo((()=>re?"ready":U?"aborted":T||X?"loading":"error"),[re,T,U,X]),ce=n.useMemo((()=>J&&ae?[n.createElement(r.Z,{Icon:l.default,actionText:P,key:"editImage",onClick:e=>se({editMode:!0})})]:[]),[ae,J,se]),me=n.useMemo((()=>ne?[n.createElement(r.Z,{Icon:d.default,actionText:I,key:"saveImage",onClick:e=>{(async()=>{if(V.scribe({element:"save_image_button",action:"click"}),re){const e=await(0,g.f)(re,!0,!0),t=URL.createObjectURL(e);(0,u.uv)(t,"image.jpg")}})()}}),n.createElement(r.Z,{Icon:c.default,actionText:v,key:"copyImage",onClick:e=>{(async()=>{if(V.scribe({element:"copy_image_button",action:"click"}),re){const e=await(0,g.f)(re,!0,!0),t=URL.createObjectURL(e);(0,u.VJ)(t).then((()=>{K((0,w.fz)({text:k}))})).catch((e=>{K((0,w.fz)({text:E}))}))}})()}}),n.createElement(r.Z,{Icon:m.default,actionText:C,key:"postImage",onClick:e=>{(async()=>{if(V.scribe({element:"post_image_button",action:"click"}),!re)return;const e=await(0,g.f)(re,!0,!0),t=URL.createObjectURL(e);$.push({pathname:"/compose/post",state:{externalMedia:[t],positionCursorAtBeginning:!0}})})()}}),...ce,...s??[]]:[]),[re,V,K,$,ne,s,ce]),ue=n.useCallback((()=>F?F(se):se()),[F,se]);return n.createElement(M.Z,{allMediaIds:e?e.map((e=>e.mediaId||"")):void 0,aspectRatio:a,centerJustify:i,disableClickWhileLoading:!J,filename:R.fileName,height:Z,intermediateResults:x,isInputAttachmentPreview:S,isModerated:!!R.moderated,mediaId:R.mediaId,menuItems:me,mimetype:R.mimeType,onClick:ue,onImageSize:O,onRemove:G,openMediaToEdit:le,preloadedImageUrl:N,status:de,style:B,url:re,useActionRowButtons:H,width:W})}},774038:(e,t,a)=>{a.d(t,{N6:()=>j,eQ:()=>B,rO:()=>N});a(543673),a(240753),a(128399),a(136728);var n=a(202784),o=a(107267),r=a(108362),i=a(154003),s=a(731708),l=a(370006),d=a(392237),c=a(111677),m=a.n(c),u=a(72591),p=a(427783),h=a(186444),g=a(254944),y=a(276259),b=a(323265),f=a(952793),w=a(128225),D=a(725405),M=a(125363),I=a(270172),v=a(327597),k=a(601576),E=a(475007),C=a(928831),P=a(988290),A=a(737368),R=a(305442);const Z=b.ZP.isTwitterApp(),_=b.ZP.isTwitterApp()?b.ZP.isAndroid()?"grok_android":"grok_ios":"grok",x=m().j826e722,U=m().a9325f10,L=m().f88553c8,S=m().g0b12442,T=m().edd0c172,z=m().abd845fe,F=m().d1d3a41a,O=m().a2697040,G=["ton.x.com","ton.twitter.com","pbs.twimg.com"];function j(e){const t=n.useMemo((()=>e||{fileName:"",mimeType:""}),[e]),a=(0,M.I0)(),[o,r]=n.useState(),i=n.useMemo((()=>!!t?.url&&G.includes(new URL(t.url).hostname)),[t]),s=n.useMemo((()=>t.url&&i||t.isPublic?t.url:o?URL.createObjectURL(o):void 0),[o,i,t.isPublic,t.url]);return n.useEffect((()=>{if(!t.url||t.isPublic||!y.v5.includes(t.mimeType)||i)return;const e=t.url;a((0,I.X)(e)).then((e=>{r(e??void 0)})).catch()}),[t.url,t.isPublic,i,t.mimeType,a]),s}function N({allMediaIds:e,allMediaUrls:t,buttonSize:a="xLarge",buttonType:l="alwaysBlack",contentUrl:d,isLoading:c,mediaId:m,mediaUrl:b,setEditMode:I,withStartAlignment:v}){const E=(0,M.I0)(),C=(0,D.Z)(),A=(0,o.useHistory)(),{isGrokDrawer:R}=(0,P.ZP)(),O=(0,f.hC)("responsive_web_grok_image_edit"),G=(0,f.hC)("responsive_web_grok_enable_android_image_donwload")&&window.AndroidMessageHandler&&window.AndroidMessageHandler.postMessage;return n.createElement(r.Z,{onClick:e=>e.stopPropagation(),style:v?H.containerCorner:H.container,withGutter:!0},n.createElement(n.Fragment,null,(!Z||G)&&n.createElement(i.ZP,{disabled:c,hoverLabel:{label:x},icon:n.createElement(u.default,{style:H.white}),key:"saveImage",onClick:a=>{(async()=>{if(C.scribe({page:_,element:"save_image_button",action:"click",data:{event_info:JSON.stringify({mediaId:m,mediaUrl:b,allMediaIds:e,allMediaUrls:t})}}),d){const e=await(0,w.f)(d,!0,!0);if(Z)return void window.AndroidMessageHandler.postMessage(JSON.stringify({type:"download_image",data:{url:b,contentDisposition:"attachment",mimeType:e.type}}));const t=URL.createObjectURL(e);(0,y.uv)(t,"image.jpg")}})()},size:a,style:H.button,type:l}),!Z&&n.createElement(i.ZP,{disabled:c,hoverLabel:{label:U},icon:n.createElement(p.default,{style:H.white}),key:"copyImage",onClick:a=>{(async()=>{if(C.scribe({page:_,element:"copy_image_button",action:"click",data:{event_info:JSON.stringify({mediaId:m,mediaUrl:b,allMediaIds:e,allMediaUrls:t})}}),d){const e=await(0,w.f)(d,!0,!0),t=URL.createObjectURL(e);(0,y.VJ)(t).then((()=>{E((0,k.fz)({text:L}))})).catch((e=>{E((0,k.fz)({text:S}))}))}})()},size:a,style:H.button,type:l}),(!Z||G)&&n.createElement(i.ZP,{disabled:c,hoverLabel:{label:T},icon:n.createElement(h.default,{style:H.white}),key:"postImage",onClick:a=>{(async()=>{if(C.scribe({page:_,element:"post_image_button",action:"click",data:{event_info:JSON.stringify({mediaId:m,mediaUrl:b,allMediaIds:e,allMediaUrls:t})}}),!d)return;const a=await(0,w.f)(d,!0,!0);if(Z)return void window.AndroidMessageHandler.postMessage(JSON.stringify({type:"post_image",data:{url:b,contentDisposition:"attachment",mimeType:a.type}}));const n=URL.createObjectURL(a);A.push({pathname:"/compose/post",state:{externalMedia:[n],positionCursorAtBeginning:!0}})})()},size:a,style:H.button,type:l})),O?n.createElement(i.ZP,{disabled:c,hoverLabel:{label:F},icon:n.createElement(g.default,{style:H.white}),key:"editImage",onClick:a=>{(async()=>{C.scribe({page:_,element:"edit_image_button",action:"click",data:{event_info:JSON.stringify({mediaId:m,mediaUrl:b,allMediaIds:e,allMediaUrls:t})}}),I&&I(!0)})()},size:a,style:H.button,type:l},!R&&!G&&n.createElement(s.ZP,{style:H.white},z)):null)}function B({contentUrl:e,conversationKey:t,grokFile:a,onSend:o,setEditMode:i}){const s=(0,A.k)(),d=(0,M.I0)(),c=(0,D.Z)(),{isImageEditEnabled:m,selectImageEditFilterKey:u}=(0,C.w)(),p=(0,R.Z)("image_edit"),h=n.useRef(!1),g=n.useCallback((n=>{h.current||(h.current=!0,(async()=>{const r=[];if(a&&a.mediaId)r.push(a);else{const t=await(0,w.f)(e,!0,!0),a=new AbortController,n=await s((i=t,l="edit_grok.jpeg",new File([i],l,{type:i.type})),a);r.push(n)}var i,l;const h={...n,attachments:r,imageGenerationCount:p,promptMetadata:{promptSource:"IMAGE_EDIT",action:"INPUT",properties:{imageUrl:a?.url||e}}};m||u(),d((0,v.u)({analytics:c,conversationKey:t})(h)),o()})())}),[p,d,c,s,e,t,o,a,m,u]);return n.createElement(r.Z,{onClick:e=>e.stopPropagation(),style:H.container,withGutter:!0},!Z&&n.createElement(l.Z,{backButtonType:"close",onClick:()=>i(!1)}),n.createElement(E.Z,{conversationKey:t,disableFileUploads:!0,hasAccess:!0,isIdle:!0,mode:"",placeholder:O,promptSender:g,useMagicWandIcon:!0,useNonExpanded:!0}))}const H=d.default.create((e=>({button:{backdropFilter:"blur(8px)"},container:{padding:e.spaces.space12,flexDirection:"row",gap:e.spaces.space20,justifyContent:"center"},containerCorner:{padding:e.spaces.space4,flexDirection:"row",gap:e.spaces.space8,justifyContent:"center"},center:{justifyContent:"center",alignItems:"center"},flex:{flex:1},white:{color:"white"}})))}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~bundle.GrokDrawer~bundle.Grok~loader.Markdown-e4e3d8bb.251dc60a.js.map