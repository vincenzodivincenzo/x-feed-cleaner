"use strict";(self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["shared~loader.DashMenu~loader.SideNav~loader.SideNavRedesign~loader.AppModules~loader.DMDrawer~bundl-93606ba8"],{702166:(e,t,r)=>{r.d(t,{MH:()=>d,dy:()=>u});var o=r(499627);const s="cardState",i="rweb.cardState",n=["cardState","carouselIndex"],a={};const d=(e,t)=>e[s][t],c="rweb/cardState/SET_CARD_STATE",l=e=>({payload:e,type:c}),u=(e,t)=>(r,o,{userPersistence:a})=>{const c=d(o(),e);r(l({[e]:{...c,...t}}));const u=o()[s];Object.keys(t).some((e=>n.includes(e)))&&a.set(i,p(u))},p=e=>"object"==typeof e?Object.keys(e).reduce(((t,r)=>{const o=e[r],s=Object.keys(o).filter((e=>n.includes(e)));return s.length>0&&(t[r]=s.reduce(((e,t)=>(e[t]=o[t],e)),{})),t}),{}):{},_=e=>"object"==typeof e?Object.keys(e).reduce(((t,r)=>(t[r]="string"==typeof e[r]?{cardState:e[r]}:e[r],t)),{}):{};o.Z.register({[s]:function(e=a,t){return t&&t.type===c?{...e,...t.payload}:e}},(()=>(e,t,{userPersistence:r})=>r.get(i,2592e6).then((t=>{t&&e(l(_(t)))}))))},669002:(e,t,r)=>{r.d(t,{CA:()=>c,Fq:()=>m,I4:()=>u,Le:()=>T,UD:()=>E,bR:()=>w});var o=r(180274),s=r(499627),i=r(917799),n=r(312771);const a="draftTweets",d={fetchStatus:n.ZP.NONE,draftTweets:[]},c="FETCH_DRAFT_TWEETS",l=Object.freeze({REQUEST:"rweb/draftTweets/FETCH_DRAFT_TWEETS_REQUEST",SUCCESS:"rweb/draftTweets/FETCH_DRAFT_TWEETS_SUCCESS",FAILURE:"rweb/draftTweets/FETCH_DRAFT_TWEETS_FAILURE"}),u="DELETE_DRAFT_TWEET",p=Object.freeze({REQUEST:"rweb/draftTweets/DELETE_DRAFT_TWEET_REQUEST",SUCCESS:"rweb/draftTweets/DELETE_DRAFT_TWEET_SUCCESS",FAILURE:"rweb/draftTweets/DELETE_DRAFT_TWEET_FAILURE"});function _(e=d,t){if(!t)return e;switch(t.type){case l.SUCCESS:return{...e,fetchStatus:n.ZP.LOADED,draftTweets:t.payload||e.draftTweets};case l.FAILURE:return{...e,fetchStatus:n.ZP.FAILED};case l.REQUEST:return{...e,fetchStatus:n.ZP.LOADING};case p.SUCCESS:{const{meta:r}=t,o=r?.draftTweetId&&e.draftTweets.filter((e=>e.rest_id!==r.draftTweetId));return o?{...e,draftTweets:o}:e}default:return e}}s.Z.register({[a]:_});const m=e=>e[a].draftTweets,E=e=>e[a].fetchStatus,T=()=>(e,t,{api:r})=>(0,i._O)(e,{request:r.withEndpoint(o.Z).fetchDraftTweets,params:{}})({actionTypes:l,context:c}),w=e=>(t,r,{api:s})=>(0,i._O)(t,{request:s.withEndpoint(o.Z).deleteDraftTweet,params:{draftTweetId:e}})({actionTypes:p,context:u,meta:{draftTweetId:e}})},287578:(e,t,r)=>{r.d(t,{io:()=>d,rS:()=>l});var o=r(499627),s=r(312771);const i=Object.freeze({LOCAL_STATE_LOADED:"rweb/editTweet/LOCAL_STATE_LOADED",LOCAL_STATE_REQUEST:"rweb/editTweet/LOCAL_STATE_REQUEST"}),n="editTweet",a="rweb.editTweet",d=e=>(e=>e[n].fetchStatus===s.ZP.LOADED)(e)&&!e[n].editTweetLimitedMarketPromptDismissedEpochMilliseconds,c=e=>({payload:e,type:i.LOCAL_STATE_LOADED}),l=()=>{return e={editTweetLimitedMarketPromptDismissedEpochMilliseconds:Date.now()},(t,r,{userPersistence:o})=>{const{[n]:{fetchStatus:s,...i}}=r(),d={...i,...e};return t(c(d)),o.set(a,d)};var e},u=Object.freeze({fetchStatus:s.ZP.NONE,editTweetLimitedMarketPromptDismissedEpochMilliseconds:0});o.Z.register({[n]:function(e=u,t){if(!t)return e;switch(t.type){case i.LOCAL_STATE_REQUEST:return{...e,fetchStatus:s.ZP.LOADING};case i.LOCAL_STATE_LOADED:return{...e,fetchStatus:s.ZP.LOADED,...t.payload};default:return e}}},(()=>(e,t,{userPersistence:r})=>(e({payload:{},type:i.LOCAL_STATE_REQUEST}),r.get(a).then((t=>{e(c(t))})).catch((()=>{e(c({}))})))))},723819:(e,t,r)=>{r.d(t,{ED:()=>c,gN:()=>l,nQ:()=>u});var o=r(24949),s=r(175856),i=r(558369),n=r(919022);const a=(0,o.P1)((e=>(0,i.FG)(e,"graduated_access_user_prompt_enabled")),(e=>(0,i.FG)(e,"graduated_access_invisible_treatment_enabled")),((e,t)=>!(!e||!t))),d=(0,o.P1)((e=>(0,i.FG)(e,"graduated_access_botmaker_decider_enabled")),(e=>!!e)),c=(0,o.P1)(n.ZP.selectViewerUser,(e=>(0,s.t5)(e,s.Uq)),a,d,((e,t,r,o)=>{const s=e?.has_graduated_access??null;if(null===s)return!1;if(!o){const t=e?.created_at??"";if(!(0===t?.length))return!1;const r=21,o=Date.now(),s=Date.parse(t);if(new Date(o-s)/864e5>r)return!1}return!s&&t&&r})),l=(0,o.P1)(n.ZP.selectViewerUser,(e=>(0,s.t5)(e,s.d7)),(e=>(0,s.t5)(e,s.Uq)),a,((e,t,r,o)=>!0===e?.has_graduated_access&&!r&&t&&o)),u=(0,o.P1)(c,l,((e,t)=>e||t))},843138:(e,t,r)=>{r.d(t,{Px:()=>I,BJ:()=>h,k6:()=>y,Xm:()=>S,ke:()=>E,jK:()=>m,tn:()=>w,uD:()=>T,T5:()=>R});var o=r(242419),s=r(499627),i=r(917799),n=r(312771),a=r(806528),d=r(341276),c=r(936572),l=r(27498);const u="placePicker",p=Object.freeze({REQUEST:"rweb/placePicker/SEARCH_REQUEST",SUCCESS:"rweb/placePicker/SEARCH_SUCCESS",FAILURE:"rweb/placePicker/SEARCH_FAILURE"}),_=Object.freeze({initial:{fetchStatus:n.ZP.NONE},lastSearch:{fetchStatus:n.ZP.NONE},lastSelectedPlace:void 0});const m=e=>e[u].initial.results,E=e=>e[u].initial.fetchStatus,T=e=>e[u].lastSearch.results,w=e=>e[u].lastSearch.fetchStatus,S=e=>{const t=m(e),r=(e=>e[u].lastSelectedPlace)(e);return((e,t)=>t??e?.places.find((t=>e?.autotag_place_id===t.place.id)))(t,r)},f=(e,t)=>(r,s,{api:n})=>(0,i._O)(r,{request:n.withEndpoint(o.Z).search,params:e})({actionTypes:p,context:"SEARCH_PLACES_ACTION",meta:{resultSet:t}}),y=e=>(t,r,{api:o})=>{const s=(0,a.Bz)(r());return t(f({query_type:l.ZV.tweet_compose_location,lat:s?.coords.latitude,long:s?.coords.longitude,hacc:s?.coords.accuracy,search_term:e},l.Z0.lastSearch))},h=()=>(e,t,{api:r})=>{const o=E(t()),s=m(t());if(o===n.ZP.LOADING||s)return Promise.resolve();const i=(0,a.Bz)(t());return i?e(f({lat:i.coords.latitude,long:i.coords.longitude,hacc:i.coords.accuracy,query_type:l.ZV.tweet_compose_location,count:50},l.Z0.initial)):Promise.resolve()},I=()=>(e,t,{api:r})=>(0,c.t$)(t())&&(0,a.wM)(t())===d.S.granted?e((0,a.ZW)()).then((()=>e(h()))).then((()=>S(t()))):Promise.resolve(),C="rweb/placePicker/UPDATE_LAST_SELECTED_PLACE",R=e=>({type:C,payload:e});s.Z.register({[u]:function(e=_,t){if(!t)return e;switch(t.type){case p.REQUEST:{const{resultSet:r}=t.meta;return{...e,[r]:{fetchStatus:n.ZP.LOADING}}}case p.FAILURE:{const{resultSet:r}=t.meta;return{...e,[r]:{fetchStatus:n.ZP.FAILED}}}case p.SUCCESS:{const{meta:{resultSet:r},payload:o}=t;return{...e,[r]:{fetchStatus:n.ZP.LOADED,results:o}}}case C:{const{payload:r}=t;return{...e,lastSelectedPlace:r??void 0}}default:return e}}})},27498:(e,t,r)=>{r.d(t,{Z0:()=>i,ZV:()=>o,xt:()=>s});const o=Object.freeze({profile_location:"profile_location",tweet_compose_location:"tweet_compose_location"}),s=Object.freeze({foursquare:"foursquare",yelp:"yelp"}),i=Object.freeze({initial:"initial",lastSearch:"lastSearch"})},24546:(e,t,r)=>{r.d(t,{Ed:()=>F,MH:()=>M,NS:()=>O,Ox:()=>Z,Qx:()=>U,Qz:()=>h,W:()=>b,dD:()=>x,wz:()=>A});r(136728);var o=r(111677),s=r.n(o),i=r(161821),n=r(88656),a=r(638873),d=r(499627),c=r(704279),l=r(497294),u=r(390387),p=r(936572),_=r(601576),m=r(632960),E=r(492292),T=r(836255),w=r(360142),S=r(255117),f=r(195250);const y="previews",h=20,I=Object.freeze({}),C="rweb/previews/STORE_PREVIEW",R="rweb/previews/REMOVE_PREVIEW_TWEET",v="rweb/previews/LINK_TWEET_TO_PREVIEW",D=s().g61ed8a4,g={};function P(e){return(0,p.zD)(e).durationSecs||h}function L(e,t,r){const o=e?.errors?e.errors[0]?.code:null,s=e instanceof n.Z&&o?a.Z[o]:null,i={text:s&&s.toast?s.toast.text:D};r(_.fz(i))}d.Z.register({[y]:function(e=I,t){if(!t)return e;switch(t.type){case C:return t?.payload?.id?{...e,[t.payload.id]:{...t.payload,linkedTweetIds:[]}}:e;case v:return t?.payload?.id?{...e,[t.payload.id]:{...e[t.payload.id],linkedTweetIds:[...e[t.payload.id].linkedTweetIds,t.payload.linkedTweetId]}}:e;case R:if(t.payload){const r=e[t.payload]?.timeoutId;r&&clearTimeout(r);const o={...e};return delete o[t.payload],o}return e;default:return e}}});const b=e=>e[y],U=(e,{previewTweetId:t})=>b(e)[t],A=e=>({payload:e,type:v}),x=e=>(t,r,{featureSwitches:o})=>{const s=U(r(),{previewTweetId:e});if(!s)return;const i=s.composerData.map((e=>({...e,draftTweetId:void 0})));t(m.RU(i,"modal")),t(Z(e))},Z=e=>(t,r,{featureSwitches:o})=>{const s=(0,u._h)(r()),i=U(r(),{previewTweetId:e}),n=i?.previewData?.inReplyToStatus?.id_str,a=i?.linkedTweetIds;if(void 0===s)return Promise.resolve();const d={[e]:!0};if(a&&a.length>0&&a.forEach((e=>{d[e]=!0})),n){t((0,w.ZP)({focalTweetId:n}).removeTweets(d))}return t(T.Z.deletePreview(e)),t({payload:e,type:R}),Promise.resolve(t([(0,S.ZP)({useLatest:!0,userId:s}).removeTweets(d),(0,S.ZP)({useLatest:!1,userId:s}).removeTweets(d),(0,f.ZP)(o,s,"default").removeTweets(d)]))},F=e=>(t,r)=>{const o=P(r()),s=1e3*o,{id:i,previewData:n}=e,a=Date.now()+s,d=r().tweetComposer.activeParentKey,l=(0,E.vY)(m.tS(r(),d),0,{}),u={subscription_details:{draft_id:i,undo_period:s/1e3,tweet_type:n.tweetType}};return new Promise((e=>{const r=setTimeout((()=>{t(c.n({section:"composition",element:"undo_tweet",page:"home",action:"timer_elapsed"},u)),e(t(O(i)))}),s);t(c.n({section:"composition",element:"undo_tweet",page:"home",action:"queued"},u)),t((e=>({payload:e,type:C}))({timeToSend:a,id:i,composerData:l,timeoutId:r,previewData:n,linkedTweetIds:[],undoDurationSecs:o}))}))},O=e=>(t,r)=>{if(!0===g[e])return Promise.resolve();const o=1e3*P(r()),s=U(r(),{previewTweetId:e});if(!s)return Promise.resolve();const{composerData:i,id:n,previewData:a}=s;return g[e]=!0,t(m.lW({...a,isPreview:!1,isSendPreview:!0})).then((()=>{const e={subscription_details:{draft_id:n,undo_period:o/1e3,tweet_type:a.tweetType}};t(c.n({section:"composition",element:"undo_tweet",page:"app",action:"sent"},e))})).catch((e=>{L(e,0,t)})).finally((()=>{delete g[e],i.forEach((e=>{e?.mediaIds?.length&&t((0,l.WU)(e.mediaIds))})),t(Z(n))}))},M=()=>(e,t)=>{const r=P(t()),o=b(t()),s=(0,i.Z)(o),n=[],a=[];for(const t in o)if(!0!==g[t]){g[t]=!0,a.push(t);const{previewData:s}=o[t],i={subscription_details:{draft_id:t,undo_period:r,tweet_type:s.tweetType}};n.push(e(m.lW({...s,isPreview:!1,isSendPreview:!0})),e(c.n({element:"undo_tweet",page:"app",action:"send_unload"},i)))}return Promise.all(n).catch((t=>L(t,0,e))).finally((()=>{s.forEach((t=>{e(Z(t.id))})),a.forEach((e=>{delete g[e]}))}))}},137204:(e,t,r)=>{r.d(t,{BS:()=>_,Ln:()=>u,MI:()=>m});var o=r(235975),s=r(499627),i=r(917799),n=r(312771);const a="trustedFriends",d=Object.freeze({REQUEST:"rweb/trustedFriendsLists/FETCH_TRUSTED_FRIENDS_LISTS_REQUEST",SUCCESS:"rweb/trustedFriendsLists/FETCH_TRUSTED_FRIENDS_LISTS_SUCCESS",FAILURE:"rweb/trustedFriendsLists/FETCH_TRUSTED_FRIENDS_LISTS_FAILURE"}),c=Object.freeze({REQUEST:"rweb/trustedFriendsLists/CREATE_TRUSTED_FRIENDS_LIST_REQUEST",SUCCESS:"rweb/trustedFriendsLists/CREATE_TRUSTED_FRIENDS_LIST_SUCCESS",FAILURE:"rweb/trustedFriendsLists/CREATE_TRUSTED_FRIENDS_LIST_FAILURE"}),l="rweb/trustedFriendsLists/SET_TRUSTED_FRIENDS_LIST",u=e=>e[a].lists,p=()=>(e,t,{api:r})=>i._O(e,{request:r.withEndpoint(o.Z).createTrustedFriendsList})({actionTypes:c,context:"CREATE_TRUSTED_FRIENDS_LIST"}),_=()=>(e,t)=>{const r=t(),s=u(r);(s.length?s[0]:void 0)||e(((e,t,{api:r})=>i._O(e,{request:r.withEndpoint(o.Z).fetchAuthenticatedUserTFLists})({actionTypes:d,context:"FETCH_TRUSTED_FRIENDS_LISTS"}))).then((t=>{!t.authenticated_user_trusted_friends_lists.length&&p&&e(p())}))},m=e=>(t,r)=>{const o=r(),[s]=u(o);if(s){const r={...s,member_count:e};t({payload:r,type:l})}},E=Object.freeze({lists:[],fetchStatus:n.ZP.NONE});s.Z.register({[a]:function(e=E,t){if(!t)return e;switch(t.type){case d.REQUEST:return{...e,fetchStatus:n.ZP.LOADING};case d.FAILURE:return{...e,error:t.payload,fetchStatus:n.ZP.FAILED};case d.SUCCESS:if(t.payload)return{...e,lists:t.payload.authenticated_user_trusted_friends_lists,error:null,fetchStatus:n.ZP.LOADED};break;case c.REQUEST:return{...e,fetchStatus:n.ZP.LOADING};case c.FAILURE:return{...e,error:t.payload,fetchStatus:n.ZP.FAILED};case c.SUCCESS:if(t.payload)return{...e,lists:[t.payload.trusted_friends_list_create],error:null,fetchStatus:n.ZP.LOADED};break;case l:if(t.payload)return{...e,lists:[t.payload]};break;default:return e}return e}})},632960:(e,t,r)=>{r.d(t,{Bv:()=>ve,Ol:()=>Re,oI:()=>Y,$P:()=>De,Es:()=>Oe,RU:()=>Ze,Os:()=>G,E_:()=>me,oN:()=>Ee,SJ:()=>Te,tS:()=>le,KS:()=>ue,Gz:()=>_e,WQ:()=>pe,R5:()=>Se,ZE:()=>we,_d:()=>fe,lW:()=>J,jr:()=>je,tD:()=>Ie,JC:()=>Ae,mi:()=>he,sU:()=>ke,JF:()=>ge,qO:()=>Pe,OO:()=>be,wk:()=>Qe,zi:()=>ye});r(136728);var o=r(715729),s=r(908478),i=r(323265),n=r(459660),a=r(976006),d=r(429650),c=r(349745),l=r(499627),u=r(497294);const p=Object.freeze({REQUEST:"rweb/tweetComposer/SCHEDULE_REQUEST",SUCCESS:"rweb/tweetComposer/SCHEDULE_SUCCESS",FAILURE:"rweb/tweetComposer/SCHEDULE_FAILURE"}),_=Object.freeze({REQUEST:"rweb/tweetComposer/DRAFT_REQUEST",SUCCESS:"rweb/tweetComposer/DRAFT_SUCCESS",FAILURE:"rweb/tweetComposer/DRAFT_FAILURE"}),m=Object.freeze({REQUEST:"rweb/tweetComposer/SEND_REQUEST",SUCCESS:"rweb/tweetComposer/SEND_SUCCESS",FAILURE:"rweb/tweetComposer/SEND_FAILURE"}),E=Object.freeze({REQUEST:"rweb/tweetComposer/SEND_PREVIEW_REQUEST",SUCCESS:"rweb/tweetComposer/SEND_PREVIEW_SUCCESS",FAILURE:"rweb/tweetComposer/SEND_PREVIEW_FAILURE"});var T=r(122868),w=r(492292),S=(r(571372),r(925873)),f=r(688715),y=r(697926),h=r(803810),I=r(180274),C=r(439058),R=r(265617),v=r(873793),D=r(466015),g=r(917799);const P=({conversationControlsValue:e,inReplyToStatus:t,isSelfThreadReply:r})=>{if(!(!!t.id_str||r)&&"all"!==e)return e};var L=r(669002),b=r(56519),U=r(558369),A=r(24546),x=r(390387),Z=r(836255),F=r(985366),O=r(360142),M=r(255117),k=r(195250),N=r(919022),j=r(163889),V=r(276001);const Q="CREATE_POLL_ERROR";const W="rweb.savedConversationControl",K="rweb.broadcastCommunityTweetPreferenceV2";class z extends Error{}const H=(e,t,r,o)=>{const s=(0,U.mz)(t),i=(0,x._h)(t)||"";if(r&&r.length){let t;const n={},a=r[0]?.self_thread?.id_str;if(a&&e(Z.Z.disableEdit(a)),r.length>1){const o=r[0].id_str;e(Z.Z.disableEdit(o));const s=r[r.length-1];t=D.Ds({sortIndex:s.id_str,tweetIds:r.map((e=>e.id_str)),stayAtTop:s.isPreview})}else{const e=r[0];t=D.Se({id:e.id_str,sortIndex:e.id_str,stayAtTop:e.isPreview}),e.edit_control?.edit_tweet_ids&&e.edit_control.edit_tweet_ids.length>1&&e.edit_control.edit_tweet_ids.slice(0,-1).forEach((e=>{n[e]=!0}))}const d=r[0].in_reply_to_status_id_str;if(d){const t=(0,O.ZP)({focalTweetId:d});e((0,O.gr)(t,d,r.map((e=>e.id_str))))}const c=r[0].in_reply_to_user_id_str;if(o&&!c)return[(0,F.Qx)(o,{rankingMode:"Recency",displayLocation:"Community"}).injectEntry(t),(0,F.Qx)(o,{rankingMode:"Recency",displayLocation:"Home"}).injectEntry(t),(0,F.Qx)(o,{rankingMode:"Relevance",displayLocation:"Community"}).injectEntry(t),(0,F.Qx)(o,{rankingMode:"Relevance",displayLocation:"Home"}).injectEntry(t)];{const e=r[0].in_reply_to_user_id_str&&r[0].in_reply_to_user_id_str!==r[0].user.id_str,o=(0,M.ZP)({userId:i,useLatest:!1}),a=(0,M.ZP)({userId:i,useLatest:!0});return[(0,k.ZP)(s,i,e?"with_replies":"default").injectEntry(t),o.injectEntry(t),a.injectEntry(t),(0,k.ZP)(s,i,e?"with_replies":"default").removeTweets(n),o.removeTweets(n),a.removeTweets(n)]}}};function q(e,t,r){const{mediaTags:o=[]}=t;let s,i,n;if(t.editorStateRaw){const e=S.Z.initEditorState(t.editorStateRaw),r=(0,v.c)(e);s=r.text,i=r.richtext_options,n=r.media_options}else s=t.text;const{batchMode:a=R._m.SINGLE_TWEET,broadcast:d,composeSemanticCoreId:c,conversationControlsValue:l,excludedRecipients:p=[],exclusivityControlValue:_,inReplyToStatusIdStr:m,promotedContent:E,isPreview:T,trustedFriendsValue:I,previousTweetId:C,premiumExclusiveControlOptions:D,disallowedReplyControls:g}=r,P=function(e,t){const{gifMetadata:r={},media:o=[],mediaTags:s=[],isPreview:i,previousTweetId:n}=t,{found_media_origin:a}=r,d=o.map((e=>e.id)),c=e((0,u.$i)(d,{withoutReUpload:!!n})),l=o.map((e=>e.mediaMetadata?.subtitles?.upload.id)).filter(Boolean),p=e((0,u.$i)(l));return Promise.all([c,p]).then((([t,r])=>{const n=t.map((e=>e.uploadId||"")).filter((e=>""!==e)),d=(0,y.Z)(n,(e=>e),(e=>s.map((e=>({type:e.type,user_id:e.id}))))),c=t.map((t=>{const o=t.mediaMetadata?.subtitles,s=r.find((e=>e.id===o?.upload.id)),n=t?.mediaMetadata?.altText||t?.mediaMetadata?.defaultAltText,d=t?.mediaMetadata?.sensitiveMediaWarning,c=t?.mediaMetadata?.allowDownloadStatus,l=[];return(n||a||d?.size||c)&&t.uploadId&&l.push((0,u.o6)({found_media_origin:a,media_id:t.uploadId,...(0,h.Z)(n?{alt_text:{text:n}}:null),...(0,h.Z)(d?.size?{sensitive_media_warning:Array.from(d)}:null),...(0,h.Z)(c?{allow_download_status:{allow_download:c.allowDownload?"true":"false"}}:null)})),o&&s&&s.uploadId&&t.uploadId&&!i&&l.push((0,u.pJ)({mediaItem:t,videoMediaUploadId:t.uploadId,subtitlesMediaUploadId:s.uploadId||"",subtitlesLang:o.lang,subtitlesDisplayName:o.displayName})),Promise.all(l.map(e))}));return Promise.all(c).then((()=>({uploadedMedia:t,uploadedMediaIds:n,uploadedMediaTags:d,originalMedia:o})))}))}(e,{gifMetadata:t.gifMetadata,media:t.media,mediaTags:t.mediaTags,isPreview:T,previousTweetId:C});let L=Promise.resolve();t.pollDuration&&t.pollChoices&&t.pollActive&&(L=function(e,{pollChoices:t,pollDuration:r}){const o=(0,w.xM)(r);return e(V.Z.createPoll(null,{choices:t,durationMinutes:o})).then((e=>{if("OK"!==e.status||!e.card_uri){const t=new Error("Poll create response was not OK");throw t.name=Q,(0,j.ZP)(t,{extra:e}),t}return e}),(e=>{throw e.name=Q,(0,j.ZP)(e),e}))}(e,{pollDuration:t.pollDuration,pollChoices:t.pollChoices}));const b=[P,L];return Promise.all(b).then((e=>{const[r,u]=e;if(t.editorStateRaw){const e=n?.inline_media,t=[];e&&(e.forEach((e=>{const o=r.originalMedia.find((t=>t.uploadId===e.media_id))?.mediaFileHash;if(o){const s=r.uploadedMedia.find((e=>e.mediaFileHash===o))?.uploadId;s?t.push({...e,media_id:s}):t.push(e)}else t.push(e)})),n={inline_media:t})}const T=r.uploadedMediaIds.join(",");let w,S;o.length&&(w=r.uploadedMediaTags),m&&p.length&&(S=p.join(","));const y=t.cardUrl||u&&u.card_uri;let h;t.quotedStatus?.permalink&&(h=(0,f.ju)(`https://x.com${t.quotedStatus.permalink}`));const R=!!m;let v;if(t.taggedLocation){v={place_id:t.taggedLocation.place.id,geo_search_request_id:t.taggedLocation.geo_search_request_id}}return{attachment_url:h,auto_populate_reply_metadata:R,batch_mode:a,broadcast:d,card_uri:y,conversation_control:l,exclude_reply_user_ids:S,exclusive_tweet_control_options:_,trusted_friends_control_options:I,geo:v,in_reply_to_status_id:m,media_ids:T,media_tags:w,media_title:t.mediaTitle,media_description:t.mediaDescription,promotedContent:E,semantic_annotation_ids:c,status:s,richtext_options:i,media_options:n,previous_tweet_id:C,disallowed_reply_controls:g,premium_tweet_control_options:D}}))}const G=e=>(t,r,{api:o})=>{const s=g._O(t,{params:e,request:e=>{const{excludedRecipients:r,inReplyToStatus:o={},scheduleData:s}=e;return t(((e,t)=>(r,o,{api:s,featureSwitches:i})=>{const[n]=e,{draftTweetId:a,scheduledFor:d,scheduledTweetId:l}=n,u=(0,c.o3)(d);if(!u){const e=new z("Invalid `scheduledFor`");return e.scheduledFor=d,Promise.reject(e)}return Promise.all(e.map((e=>q(r,{...e},{...t}).then((({attachment_url:e,auto_populate_reply_metadata:t,exclude_reply_user_ids:r,in_reply_to_status_id:o,media_ids:s,media_options:i,richtext_options:n,status:a})=>({attachment_url:e,auto_populate_reply_metadata:t,exclude_reply_user_ids:r,in_reply_to_status_id:o,media_ids:s,media_options:i,richtext_options:n,status:a})))))).then((e=>{const[t,...r]=e,o=l||a,{in_reply_to_status_id:n}=t,d=i.isTrue("longform_notetweets_scheduling_non_reply_enabled")&&!n,c={...t,richtext_options:d?t.richtext_options:void 0,media_options:d?t.media_options:void 0,thread_tweets:r.map((({attachment_url:e,media_ids:t,media_options:r,richtext_options:o,status:s})=>({attachment_url:e,media_ids:t,media_options:r,richtext_options:o,status:s}))),executeAt:u};return o?s.withEndpoint(C.Z).editScheduledTweet({...c,scheduledTweetId:o}):s.withEndpoint(C.Z).scheduleTweet(c)}))})(s,{excludedRecipients:r,inReplyToStatusIdStr:o.id_str})).then((e=>({...s[0],scheduled_id_str:e})),(e=>(e.scheduledTweet=s,Promise.reject(e))))}}),{scheduleData:{scheduledTweetId:i}={}}=e;return s({actionTypes:p,context:i?"SCHEDULE_TWEET_EDIT":"SCHEDULE_TWEET",meta:{scheduleParams:e}})},Y=e=>(t,r,{api:o})=>{const s=g._O(t,{params:e,request:e=>{const{excludedRecipients:r,inReplyToStatus:o={},draftData:s}=e,i=s[0];return t(((e,t)=>(r,o,{api:s})=>{const{draftTweetId:i}=e[0];return Promise.all(e.map((e=>q(r,{...e},{...t}).then((({attachment_url:e,auto_populate_reply_metadata:t,exclude_reply_user_ids:r,in_reply_to_status_id:o,media_ids:s,media_options:i,richtext_options:n,status:a})=>({attachment_url:e,auto_populate_reply_metadata:t,exclude_reply_user_ids:r,in_reply_to_status_id:o,media_ids:s,media_options:i,richtext_options:n,status:a})))))).then((e=>{const[t,...r]=e,o={...t,thread_tweets:r.map((({attachment_url:e,media_ids:t,media_options:r,richtext_options:o,status:s})=>({attachment_url:e,media_ids:t,media_options:r,richtext_options:o,status:s})))};return i?s.withEndpoint(I.Z).editDraftTweet({...o,draftTweetId:i}):s.withEndpoint(I.Z).createDraftTweet(o)}))})(s,{excludedRecipients:r,inReplyToStatusIdStr:o.id_str})).then((e=>({...i,draft_id_str:e})),(e=>(e.draftTweet=i,Promise.reject(e))))}}),{draftData:{draftTweetId:i}={},isAutoSave:n}=e;return s({actionTypes:_,context:i?"DRAFT_TWEET_EDIT":"DRAFT_TWEET",meta:{draftParams:e,isAutoSave:n}})},B=(e,t={excludedRecipients:[]})=>(r,o,{api:s,featureSwitches:i})=>q(r,e,t).then((i=>s.withEndpoint(R.ZP).sendTweet(i).then((s=>{const i=o(),n=N.ZP.selectViewerUser(i),a=(s.entities.tweets||{})[s.result];a.conversation_id_str=t.conversationId||a.conversation_id_str,n&&t.trustedFriendsValue?.trusted_friends_list_id&&(a.trusted_friends_info={screen_name:n.screen_name}),s.entities&&r((0,b.dP)(s.entities)),e.draftTweetId&&r((0,L.bR)(e.draftTweetId)),t.communityIdValue&&r(Z.Z.fetchOne(a.id_str)).catch(),a.isEdited&&r(Z.Z.updateEditVersions(a.id_str));const d=Z.Z.selectHydrated(o(),a.id_str);if(!d)throw new Error("No hydratedTweet found in redux store for Tweet ID after sending");return d})))),$=(e,t,r={excludedRecipients:[]})=>(o,s,{api:i,featureSwitches:n})=>{const a="subsequent"===r.batchMode&&t.sendData.length>1,d=r.isSelfThreadReply&&r.isFirstTweet;return q(o,e,{...r,isPreview:!0,inReplyToStatusIdStr:a&&!d?void 0:r.inReplyToStatusIdStr}).then((n=>(n.preview=!0,i.withEndpoint(R.ZP).sendTweet(n).then((i=>{const n=(i.entities.tweets||{})[i.result];n.isPreview=!0,n.conversation_id_str=r.conversationId,i.entities&&o((0,b.dP)(i.entities)),!a||d?o((0,A.Ed)({previewData:t,id:n.id_str})):r.firstTweetId&&o((0,A.wz)({id:r.firstTweetId,linkedTweetId:n.id_str})),e.draftTweetId&&o((0,L.bR)(e.draftTweetId));const c=Z.Z.selectHydrated(s(),n.id_str);if(!c)throw new Error("No hydratedTweet found in redux store for Tweet ID after sending");return c})))))};function J(e){return(t,r,{api:o,featureSwitches:s,userPersistence:i})=>{const{communityIdValue:a}=e,d=r();return g._O(t,{params:e,request:e=>{const{composeSemanticCoreId:r,conversationControlsValue:o,sendData:d=[],excludedRecipients:c,exclusivityControlValue:l,inReplyToStatus:u={},isSelfThreadReply:p=!1,promotedContent:_,isPreview:m=!1,previousTweetId:E,trustedFriendsValue:T,broadcast:w,disallowedReplyControls:S,premiumExclusiveControlOptions:f}=e,y=P({featureSwitches:s,conversationControlsValue:o,inReplyToStatus:u,isSelfThreadReply:p});return y!==n.k.community_members&&y!==n.k.super_followers_exclusive&&y!==n.k.trusted_friends_tweet&&y!==n.k.premium&&i.set(W,{conversationControl:y||n.k.all}),y!==n.k.community_members||u.conversation_id_str||i.set(K,{broadcast:w}),d.reduce(((o,s,i)=>{const n=0===i;return o.then((o=>{const h=u.conversation_id_str,I=n?u.id_str:o[i-1].id_str,C=n?c:[],v=n?_:void 0,D=n?null:o[0].id_str,g=n&&void 0===u.id_str?l:void 0,P=n&&void 0===u.id_str?T:void 0;let L;a||l?L=void 0:n&&(L=y);const b={batchMode:n&&!p?1===d.length?R._m.SINGLE_TWEET:R._m.FIRST_TWEET:R._m.SUBSEQUENT_TWEET,broadcast:w,communityIdValue:a,conversationId:h,conversationControlsValue:L,composeSemanticCoreId:r,excludedRecipients:C,exclusivityControlValue:g,inReplyToStatusIdStr:I,promotedContent:v,firstTweetId:D,trustedFriendsValue:P,isSelfThreadReply:p,isFirstTweet:n,previousTweetId:E,disallowedReplyControls:S,premiumExclusiveControlOptions:f},U=m?$(s,e,b):B(s,b);return t(U).then((e=>{const r=[...o,e];return t(Qe(r.length)),r}),(e=>(e.sentTweets=o,Promise.reject(e))))}))}),Promise.resolve([]))}})({actionTypes:e.isSendPreview?E:m,context:"SEND_SELF_THREAD",meta:{sendParams:e}},((e,r)=>{if(e)return H(t,d,e,a);if(r){const{sentTweets:e=[]}=r;return H(t,d,e,a)}}))}}const X="tweetComposer",ee=[T.x.homeTimeline,T.x.modal],te=Object.freeze({text:"",cardUrl:void 0,mediaIds:[],mediaTags:[],gifMetadata:void 0,pollActive:!1,pollChoices:void 0,pollDuration:void 0,pollValid:!1,scheduledFor:void 0,scheduledTweetId:void 0,draftTweetId:void 0,taggedLocation:void 0,isEmpty:!0,isValid:!1});let re=0;function oe(e){const t=`composer-${re}`,r=w.bY({...te,key:t,...e});return re+=1,r}const se=e=>({activeComposerIndex:0,audienceControls:{_type:"conversation_controls",conversationControlsValue:"all"},composerData:[e||oe()],excludedRecipients:[],isSending:!1,isAutoSaving:!1,sentTweetsCount:0,broadcastCommunityTweet:!0}),ie=se(),ne=T.x.modal;let ae;const de=()=>ae||(ae={activeParentKey:ne},ee.forEach((e=>{ae[e]=se()})),ae);const ce=(e,t)=>{const r=t||e[X].activeParentKey;return e[X][r]||ie};function le(e,t){return ce(e,t).composerData}const ue=(e,t)=>ce(e,t).excludedRecipients,pe=(e,t)=>ce(e,t).isSending,_e=(e,t)=>ce(e,t).isAutoSaving,me=(e,t)=>ce(e,t).activeComposerIndex,Ee=(e,t)=>ce(e,t).audienceControls,Te=(e,t)=>!!ce(e,t).broadcastCommunityTweet,we=e=>{const t=le(e),r=(e=>ce(e).sentTweetsCount)(e),o=t.length;let s=0;if(r<o){const o=t[r].mediaIds;s=w.vW(e,o)}return(r+s)/o},Se=e=>{const t=me(e),r=le(e)[t],o=e.scheduledTweets&&e.scheduledTweets.scheduledTweets;return o&&r&&!r?.scheduledFor?((e,t)=>{const r=t.find((t=>t.rest_id===e&&t.scheduling_info&&t.scheduling_info.execute_at)),o=r?.scheduling_info?.execute_at;if(o)return(0,c.BR)(o)})(r.scheduledTweetId,o):r&&r.scheduledFor},fe=e=>{const t=me(e),r=le(e)[t];return r&&r.taggedLocation};function ye(e){return(t,r)=>{const o="number"==typeof e.index?e.index:me(r(),e.parentKey);t(Ze(w.vY(le(r(),e.parentKey),o,e.updates),e.parentKey))}}function he(e){return(t,r)=>{const o=le(r(),e.parentKey);t(Ze(o.map(((t,r)=>(0,w.bY)({...t,...e.updates}))),e.parentKey))}}function Ie(e){return(t,r)=>{const o=oe(e.data);t(Ze([o],e.parentKey))}}function Ce(e){return(t,r)=>{const o=e.data.map(oe);t(Ze(o,e.parentKey))}}const Re=e=>(t,r)=>{const o=e??T.x.homeTimeline;t(function({from:e,to:t}){return(r,o)=>{r(Ze(w.vY(le(o(),e),0,{}),t))}}({from:o,to:T.x.modal})),t(ke(Ee(r(),o),T.x.modal)),t(je(T.x.modal)),t({type:Fe,meta:{parentKey:o}})};function ve(){return(e,t)=>{const r=me(t());let o;const s=le(t()),i=s[0]?.scheduledFor,n=s.reduce(((e,t,s)=>((0,d.m_)(t)||e.push(t),s===r&&(null!=i?e.push(oe({scheduledFor:i})):e.push(oe()),o=e.length-1),e)),[]);e([Ze(n),Ae(o)])}}const De=()=>(e,t)=>{const r=le(t()),o=me(t()),s=Math.max(0,o-1);e([Ae(s),Ze([...r.slice(0,o),...r.slice(o+1)])])};function ge(e){return(t,r,{featureSwitches:o})=>{const{parentKey:s}=e;let n,d;n=!!o.isTrue("longform_notetweets_mobile_richtextinput")||!i.ZP.isMobileOS();const{thread_tweets:c,...l}=e.data;if(n){const{media_options:e,richtext_options:t,tweetId:o,...s}=l,i=(0,u.gz)(r()),n=(0,a.eq)(s.text,t?.richtext_tags,i,e?.inline_media);d={...s,editorStateRaw:n,draftTweetId:o}}else{const{tweetId:e,...t}=l;d={...t,draftTweetId:e}}t(Ce({data:[d,...c?.map((e=>{if(n){const{media_options:t,richtext_options:o,...s}=e,i=(0,u.gz)(r()),n=(0,a.eq)(s.text,o?.richtext_tags,i,t?.inline_media);return{...s,editorStateRaw:n}}return e}))??[]],parentKey:s}))}}function Pe(e){return(t,r,{featureSwitches:o})=>{const{parentKey:s}=e;let n,d;n=!!o.isTrue("longform_notetweets_mobile_richtextinput")||!i.ZP.isMobileOS();const{thread_tweets:c,...l}=e.data;if(n){const{media_options:e,richtext_options:t,tweetId:o,...s}=l,i=(0,u.gz)(r()),n=(0,a.eq)(s.text,t?.richtext_tags,i,e?.inline_media);d={...s,editorStateRaw:n,scheduledTweetId:o}}else{const{tweetId:e,...t}=l;d={...t,scheduledTweetId:e}}const p=l.scheduledFor;t(Ce({data:[d,...c?.map((e=>{if(n){const{richtext_options:t,...o}=e,s=(0,u.gz)(r()),i=(0,a.eq)(o.text,t?.richtext_tags,s);return{...o,editorStateRaw:i,scheduledFor:p}}return{...e,scheduledFor:p}}))??[]],parentKey:s}))}}const Le="rweb/tweetComposer/UPDATE_EXCLUDED_RECIPIENTS",be=e=>({payload:e,type:Le}),Ue="rweb/tweetComposer/UPDATE_ACTIVE_COMPOSER_INDEX",Ae=(e=0)=>({type:Ue,payload:e}),xe="rweb/tweetComposer/SAVE_COMPOSER_DATA",Ze=(e,t)=>({type:xe,payload:e,meta:{parentKey:t}}),Fe="rweb/tweetComposer/RESET_DRAFT",Oe=e=>(t,r)=>{e?.isPreview||le(r(),e?.parentKey).forEach((e=>{e?.mediaIds?.length&&t((0,u.WU)(e.mediaIds))})),t(ze()),t({type:Fe,meta:{parentKey:e?.parentKey}})},Me="rweb/tweetComposer/UPDATE_AUDIENCE_CONTROLS_VALUE",ke=(e,t)=>({type:Me,payload:e,meta:{parentKey:t}}),Ne="rweb/tweetComposer/SET_ACTIVE_PARENT_KEY",je=e=>({type:Ne,payload:e}),Ve="rweb/tweetComposer/UPDATE_SENT_TWEETS_COUNT",Qe=e=>({type:Ve,payload:e}),We="rweb/tweetComposer/UPDATE_BROADCAST_COMMUNITY_TWEET",Ke=e=>(t,r,{featureSwitches:o})=>{ee.forEach((r=>{t({type:We,payload:!!e,meta:{parentKey:r}})}))},ze=()=>(e,t,{userPersistence:r})=>r.get("rweb.savedConversationControl").then((t=>{var r;t&&t.conversationControl!==n.k.community_members&&t.conversationControl!==n.k.super_followers_exclusive&&t.conversationControl!==n.k.trusted_friends_tweet&&e((r=t.conversationControl,(e,t,{featureSwitches:o})=>{ee.forEach((t=>{e(ke({_type:"conversation_controls",conversationControlsValue:r},t))}))}))})).then((()=>r.get("rweb.broadcastCommunityTweetPreferenceV2"))).then((t=>{t&&e(Ke(t.broadcast))}));l.Z.register({[X]:function(e=de(),t){if(!t)return e;const r=t.meta?.isAutoSave??!1,i=t.meta?.parentKey||e.activeParentKey;switch(t.type){case _.REQUEST:return{...e,[i]:{...e[i],isSending:!0,isAutoSaving:r}};case p.REQUEST:case m.REQUEST:return{...e,[i]:{...e[i],isSending:!0}};case E.REQUEST:case p.FAILURE:case p.SUCCESS:case _.FAILURE:case _.SUCCESS:case E.FAILURE:case E.SUCCESS:case m.SUCCESS:return{...e,[i]:{...e[i],isSending:!1,isAutoSaving:!1}};case m.FAILURE:return{...e,[i]:{...e[i],isSending:!1,composerData:[...e[i].composerData.slice(t.payload?.sentTweets.length)],sentTweetsCount:0}};case Fe:return{...e,[i]:se()};case xe:return(0,o.ZP)(e,(e=>{e[i]||(e[i]={...ie});const r=e[i].composerData,o=t.payload;(0,s.Z)(r,o)||(e[i].composerData=o)}));case Ne:return void 0===t.payload?{...e,activeParentKey:ne}:"string"==typeof t.payload?{...e,activeParentKey:t.payload,[t.payload]:e[t.payload]||se()}:e;case Ve:return{...e,[i]:{...e[i],sentTweetsCount:t.payload}};case Ue:return{...e,[i]:{...e[i],activeComposerIndex:t.payload}};case Le:return{...e,[i]:{...e[i],excludedRecipients:t.payload}};case Me:return{...e,[i]:{...e[i],audienceControls:t.payload}};case We:return{...e,[i]:{...e[i],broadcastCommunityTweet:t.payload}};default:return e}}},ze)},122868:(e,t,r)=>{r.d(t,{x:()=>o});const o=Object.freeze({homeTimeline:"homeTimeline",modal:"modal"})},492292:(e,t,r)=>{r.d(t,{bY:()=>l,vW:()=>a,vY:()=>d,xM:()=>c});var o=r(733357),s=r(718480),i=r(968664),n=r(497294);function a(e,t){return t&&t.length?(0,n._T)(e,t):1}function d(e,t,r){return[...e.slice(0,t),l({...e[t],...r}),...e.slice(t+1)]}function c(e){if(!e)return null;return 60*(24*e.days+e.hours)+e.minutes}function l(e){let t=!0,r=!1;const{text:n}=e,a="string"!=typeof n||(0,o.Z)(n);if(a){const o=(e?.mediaIds?.length||0)>0;t=o,r=!o&&!e.pollActive}else{const r=(0,s.Z)(n.trim(),i.Z.version3),o=!e.pollActive||e.pollValid;t=r.valid&&o&&!a}return{...e,isEmpty:r,isValid:t}}},985366:(e,t,r)=>{r.d(t,{En:()=>l,Qx:()=>c,Uu:()=>u,Y1:()=>p,rK:()=>d});r(136728);var o=r(189676),s=r(750085),i=r(218951);const n="FETCH_COMMUNITY_TWEETS_TIMELINE";function a({communityId:e,displayLocation:t="Community",isMedia:r=!1,rankingMode:o="Relevance"}){const s=["communityTweets",o];return t&&s.push(t),r&&s.push("media"),s.push(e),s.join("-")}const d=(e,t)=>(0,i.Z)({timelineId:a({communityId:e,displayLocation:t,rankingMode:"Recency"}),network:{getEndpoint:e=>e.withEndpoint(o.Z).fetchCommunityLoggedOutTweets,getEndpointParams:({count:r,cursor:o})=>({communityId:e,count:r,cursor:"string"==typeof o?o:void 0,displayLocation:t})},context:n,perfKey:"communityTweets",formatResponse:s.Z});function c(e,t){const r=t?.displayLocation??"Community",d=t?.rankingMode??"Relevance";return(0,i.Z)({timelineId:a({communityId:e,displayLocation:r,rankingMode:d}),network:{getEndpoint:e=>e.withEndpoint(o.Z).fetchCommunityTweets,getEndpointParams:({count:t,cursor:o})=>({communityId:e,count:t,cursor:"string"==typeof o?o:void 0,displayLocation:r,rankingMode:d})},context:n,perfKey:"communityTweets",formatResponse:s.Z})}const l=(e,t)=>(0,i.Z)({timelineId:a({communityId:e,displayLocation:t,isMedia:!0,rankingMode:"Recency"}),network:{getEndpoint:e=>e.withEndpoint(o.Z).fetchCommunityMediaLoggedOutTweets,getEndpointParams:({count:r,cursor:o})=>({communityId:e,count:r,cursor:"string"==typeof o?o:void 0,displayLocation:t})},context:n,perfKey:"communityTweets",formatResponse:s.Z}),u=(e,t)=>(0,i.Z)({timelineId:a({communityId:e,displayLocation:t,isMedia:!0,rankingMode:"Recency"}),network:{getEndpoint:e=>e.withEndpoint(o.Z).fetchCommunityMediaTweets,getEndpointParams:({count:r,cursor:o})=>({communityId:e,count:r,cursor:"string"==typeof o?o:void 0,displayLocation:t})},context:n,perfKey:"communityTweets",formatResponse:s.Z}),p=(e,t)=>(0,i.Z)({timelineId:a({communityId:e,displayLocation:t}),network:{getEndpoint:e=>e.withEndpoint(o.Z).fetchCommunityRankedLoggedOutTweets,getEndpointParams:({count:r,cursor:o})=>({communityId:e,count:r,cursor:"string"==typeof o?o:void 0,displayLocation:t})},context:n,perfKey:"communityTweets",formatResponse:s.Z})}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~loader.DashMenu~loader.SideNav~loader.SideNavRedesign~loader.AppModules~loader.DMDrawer~bundl-93606ba8.fc1cf84a.js.map