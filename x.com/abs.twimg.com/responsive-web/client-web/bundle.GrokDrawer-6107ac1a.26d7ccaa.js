"use strict";(self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["bundle.GrokDrawer-6107ac1a","loader.directMessagesData-6107ac1a"],{326439:(e,t,n)=>{n.d(t,{Z:()=>d});var i,s,a,r,o,l={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SensitiveMediaSettingsQuery",selections:[{alias:"viewer",args:i=[{kind:"Literal",name:"s",value:"cd25"}],concreteType:"Viewer",kind:"LinkedField",name:"viewer_v2",plural:!1,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[a={alias:null,args:null,kind:"ScalarField",name:"rest_id",storageKey:null},{alias:null,args:null,concreteType:"UserSensitiveMediaSettingsInfo",kind:"LinkedField",name:"sensitive_media_settings",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SensitiveMediaOptions_userSensitiveMediaSettingsInfo"},r={alias:null,args:null,kind:"ScalarField",name:"can_user_allow_sensitive_content",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:'viewer_v2(s:"cd25")'}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SensitiveMediaSettingsQuery",selections:[{alias:"viewer",args:i,concreteType:"Viewer",kind:"LinkedField",name:"viewer_v2",plural:!1,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[s,{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"UserSensitiveMediaSettingsInfo",kind:"LinkedField",name:"sensitive_media_settings",plural:!1,selections:[{alias:null,args:null,concreteType:"SensitiveMediaSettings",kind:"LinkedField",name:"sensitive_media_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"view_adult_content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"view_violent_content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"view_other_content",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:null},r],storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"User",abstractKey:null}],storageKey:null},o],storageKey:null}],storageKey:'viewer_v2(s:"cd25")'}]},params:{id:"ft92vAsha0RhDxwgq_ojWQ",metadata:{},name:"SensitiveMediaSettingsQuery",operationKind:"query",text:null}};l.hash="47444c8ec7640b723fc59a35b0544d70";const d=l},498510:(e,t,n)=>{n.d(t,{Z:()=>d});var i,s,a,r,o,l={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"fetchDownloadSettingAllowedQuery",selections:[{kind:"RequiredField",field:i={alias:null,args:null,concreteType:"UserPreferences",kind:"LinkedField",name:"user_preferences",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"allow_video_downloads",storageKey:null}],storageKey:null},action:"THROW"},{alias:"viewer",args:s=[{kind:"Literal",name:"s",value:"4721"}],concreteType:"Viewer",kind:"LinkedField",name:"viewer_v2",plural:!1,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[r={alias:null,args:null,concreteType:"LegacyExtendedUserProfile",kind:"LinkedField",name:"legacy_extended_profile",plural:!1,selections:[{alias:null,args:null,concreteType:"LegacyExtendedBirthDate",kind:"LinkedField",name:"birthdate",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"month",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"day",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"year",storageKey:null}],storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:'viewer_v2(s:"4721")'}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"fetchDownloadSettingAllowedQuery",selections:[i,{alias:"viewer",args:s,concreteType:"Viewer",kind:"LinkedField",name:"viewer_v2",plural:!1,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[a,{kind:"InlineFragment",selections:[r,o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"User",abstractKey:null}],storageKey:null},o],storageKey:null}],storageKey:'viewer_v2(s:"4721")'}]},params:{id:"P4Y9VY-Vn1cJuBnjOVZ4xA",metadata:{},name:"fetchDownloadSettingAllowedQuery",operationKind:"query",text:null}};l.hash="8a9c6728758bc2d477246d6d2dbf9e46";const d=l},882127:(e,t,n)=>{n.d(t,{Z:()=>s});var i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"fetchDownloadSettingAllowed_viewer",selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"LegacyExtendedUserProfile",kind:"LinkedField",name:"legacy_extended_profile",plural:!1,selections:[{alias:null,args:null,concreteType:"LegacyExtendedBirthDate",kind:"LinkedField",name:"birthdate",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"month",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"day",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"year",storageKey:null}],storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null,hash:"7c8218ed97677fa6b6cff281b5c2fef5"};const s=i},19697:(e,t,n)=>{n.d(t,{q8:()=>d,$i:()=>a});n(571372);var i=n(790187);const s=(e,t)=>{const n=document.createElement("canvas");n.width=e,n.height=t;const i=n.getContext("2d");return i.fillStyle="#FFFFFF",i.fillRect(0,0,e,t),n};function a(e,t,n,s,a){return l(t,n).then((t=>(function(e,t,n,s,a,r){const o=r||{top:0,left:0,width:t.width,height:t.height};let l=o.left,d=o.top,u=o.width,c=o.height,h=0,m=0,p=n,g=s;switch(e.save(),a){case i.Z.TOP_RIGHT:e.scale(-1,1),l=t.width-o.width-o.left,h=-n;break;case i.Z.BOTTOM_RIGHT:e.rotate(Math.PI),l=t.width-o.width-o.left,d=t.height-o.height-o.top,h=-n,m=-s;break;case i.Z.BOTTOM_LEFT:e.scale(1,-1),d=t.height-o.height-o.top,m=-s;break;case i.Z.LEFT_TOP:e.translate(n/2,s/2),e.rotate(-Math.PI/2),e.scale(-1,1),l=o.top,d=o.left,u=o.height,c=o.width,h=-s/2,m=-n/2,p=s,g=n;break;case i.Z.LEFT_BOTTOM:e.translate(n/2,s/2),e.rotate(Math.PI/2),l=o.top,d=t.height-o.width-o.left,u=o.height,c=o.width,h=-s/2,m=-n/2,p=s,g=n;break;case i.Z.RIGHT_BOTTOM:e.translate(n/2,s/2),e.rotate(Math.PI/2),e.scale(-1,1),l=t.width-o.height-o.top,d=t.height-o.width-o.left,u=o.height,c=o.width,h=-s/2,m=-n/2,p=s,g=n;break;case i.Z.RIGHT_TOP:e.translate(n/2,s/2),e.rotate(-Math.PI/2),l=t.width-o.height-o.top,d=o.left,u=o.height,c=o.width,h=-s/2,m=-n/2,p=s,g=n}e.drawImage(t,l,d,u,c,h,m,p,g),e.restore()}(t.getContext("2d"),e,t.width,t.height,s,a),t)))}const r=3145728,o=5242880;function l(e,t){if(window.CanvasRenderingContext2D){const n=s(e,t);return d(n).then((()=>n)).catch((()=>{const n=e*t;if(n>o){const n=u(o,e,t);return l(n.width,n.height)}if(n>r){const n=u(r,e,t);return l(n.width,n.height)}throw Error("Could not create valid canvas for resizing")}))}return Promise.reject(Error("Canvas is not supported in this browser"))}function d(e){return new Promise(((t,n)=>{const i=e.toDataURL("image/jpeg");i&&"data:,"!==i?t(i):n(new Error("Malformed canvas"))}))}function u(e,t,n){const i=Math.sqrt(e*n/t),s=t*i/n;return{height:Math.floor(i),width:Math.floor(s)}}},790187:(e,t,n)=>{n.d(t,{C:()=>a,Z:()=>i});n(694898),n(38857),n(540171),n(157093),n(265688),n(270315),n(592529),n(86943),n(691157);const i=Object.freeze({UNKNOWN:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,LEFT_TOP:5,LEFT_BOTTOM:6,RIGHT_BOTTOM:7,RIGHT_TOP:8}),s=(e,t,n=65536)=>{let i=new Uint8Array([]),s=0;function a(a,r,o){const l=a-s,d=l+r;if(l>=0&&d<=i.length)o(i.subarray(l,d),a);else{const l=new FileReader;l.onload=function(){i=new Uint8Array(this.result),s=a,o(i.subarray(0,r),a)},l.onerror=t.bind(null,0),null!==e&&l.readAsArrayBuffer(e.slice(a,a+Math.max(n,r)))}}function r(e){const n={"MM\0*":!0,"II*\0":!1}[String.fromCharCode.apply(null,e.subarray(0,4))];if(void 0===n)return void t(0);function i(t,i){let s=0;for(let a=0;a<i;a++)s=(s<<8)+e[t+(n?a:i-1-a)];return s}const s=e.length>8&&i(4,4);if(!s||s+2>e.length)return void t(0);let a=i(s,2);if(s+12*a+6>e.length)return void t(0);let r=s+2;for(;a>0;){if(a-=1,274===i(r,2)&&3===i(r+2,2)&&1===i(r+4,4))return void t(i(r+8,2));r+=12}t(0)}e instanceof Blob?a(0,10,(function e(n,i){const s=n[1];if(n.length<4||255!==n[0]||217===s)return void t(0);const o=s<208||s>217?(n[2]<<8)+n[3]:0;225===s&&o>8&&"Exif\0\0"===String.fromCharCode.apply(null,n.subarray(4,10))?a(i+10,o-8,r):a(i+2+o,10,e)})):t(0)},a=(e,t)=>{const n=document.documentElement&&"from-image"===getComputedStyle(document.documentElement).imageOrientation;return new Promise((a=>{n?a(i.TOP_LEFT):s(e,(e=>{a(e)}),t)}))}},276259:(e,t,n)=>{n.d(t,{Lw:()=>s,Re:()=>c,VJ:()=>o,ZF:()=>h,hv:()=>l,ku:()=>i,qp:()=>a,uv:()=>r,v5:()=>u});n(571372),n(875640),n(694898),n(38857),n(540171),n(157093),n(265688),n(270315),n(592529),n(86943),n(691157),n(543673),n(240753),n(128399);function i(e){const t=e.match(/=*$/);return t?Math.floor(.75*(e.length-t[0].length)):.75*e.length}function s(e){return new Promise(((t,n)=>{const i=e.split(/data:|;base64,/);if(Blob)if(3!==i.length)n(Error("Invalid dataUri"));else if(atob)if(Uint8Array){const[,e,n]=i,s=atob(n),a=s.length,r=Array(a);for(let e=0;e<a;e++)r[e]=s.charCodeAt(e);t(new Blob([new Uint8Array(r)],{type:e}))}else n(Error("The Uint8Array type is not available"));else n(Error("The atob API is not available"));else n(Error("The Blob API is not available"))}))}const a=(e,t)=>new Promise(((n,i)=>{const s=new FileReader;t&&(t.signal.onabort=()=>{s.abort?.(),i(Error(h))}),s.onload=e=>{e.target instanceof FileReader&&e.target.result instanceof ArrayBuffer?n(e.target.result):i(Error("The FileReader result was not of type ArrayBuffer"))},s.onerror=e=>{i(e)},s.readAsArrayBuffer(e)})),r=(e,t)=>{const n=document.createElement("a");n.href=e,n.download=t,n.target="_blank",n.click(),n.remove()},o=e=>(e=>new Promise((t=>{const n=new Image;n.onload=function(){const e=document.createElement("canvas");e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n,0,0),e.toBlob((e=>t(e)),"image/png")},n.crossOrigin="anonymous",n.src=e})))(e).then((e=>navigator.clipboard.write([new ClipboardItem({"image/png":e})]))),l=async(e,t)=>{if(e.size<=t)return e;let n=e,i=1;for(;n&&n.size>t;)try{i>.2?(i*=.7,n=await d(n,1,i)):n=await d(n,.7,i)}catch(e){n=void 0}return n},d=(e,t,n)=>new Promise(((i,s)=>{const a=new Image;a.onload=()=>{const e=document.createElement("canvas"),s=e.getContext("2d"),r=a.width*t,o=a.height*t;e.width=r,e.height=o,s.drawImage(a,0,0,r,o),e.toBlob((e=>{i(new File([e],"image.jpeg",{type:"image/jpeg"}))}),"image/jpeg",n)},a.onerror=()=>s(new Error("Failed to load image while resizing")),a.src=URL.createObjectURL(e)})),u=["image/jpeg","image/png","image/webp"],c="image/gif",h="Reading aborted"},549755:(e,t,n)=>{n.d(t,{Z:()=>i});n(571372);class i extends Error{constructor(e,t,n){super(e),this.code=t,this.type=n||null}}},205074:(e,t,n)=>{n.d(t,{DS:()=>o,ZP:()=>l});n(543673),n(240753),n(128399);var i=n(790187),s=n(276259),a=n(122123);function r(e,t){const n=function(e){return[i.Z.LEFT_BOTTOM,i.Z.LEFT_TOP,i.Z.RIGHT_BOTTOM,i.Z.RIGHT_TOP].indexOf(e)>=0}(t),[s,a]=n?[e.height,e.width]:[e.width,e.height];return{width:s,height:a}}const o=e=>{const t=e instanceof l,n=e.isImage||e.isGif,i=e.orientation,s=e.width&&e.height,a=e.img;return!!(t&&n&&i&&s&&a)};class l{constructor(e){this.fileHandle=e,e instanceof File&&(this.name=e.name),this.size=e.size,this.type=e.type,this.url=window.URL.createObjectURL(this.fileHandle),this.isGif=this.type===s.Re,this.isImage=s.v5.some((e=>e===this.type)),this.isVideo=!1,this.isSubtitles=!1}withDimensionsAndOrientation(){return this.isGif||this.isImage?(0,a.po)(this.url).then((e=>{const t=t=>{const{height:n,width:i}=r(e,t);return this.img=e,this.width=i,this.height=n,this.orientation=t,this};return(0,i.C)(this.fileHandle).then((e=>t(e===i.Z.UNKNOWN?i.Z.TOP_LEFT:e))).catch((()=>t(i.Z.TOP_LEFT)))})):Promise.resolve(this)}dispose(){this.url&&window.URL.revokeObjectURL(this.url)}}},122123:(e,t,n)=>{n.d(t,{gK:()=>s,o2:()=>r,po:()=>a});var i=n(549755);const s={type:"image-load",NO_DIMENSIONS:1,LOAD_FAILED:2};function a(e){return new Promise(((t,n)=>{const a=(e,t)=>{const a=new i.Z(e,t,s.type);n(a)},r=new Image;r.onload=()=>{r.width&&r.height?t(r):a("Image lacks height or width",s.NO_DIMENSIONS)},r.onerror=()=>{a("Error loading image",s.LOAD_FAILED)},r.src=e}))}function r(e){return new Promise(((t,n)=>{const a=(e,t)=>{const a=new i.Z(e,t,s.type);n(a)},r=new Image;r.setAttribute("crossorigin","anonymous"),r.onload=()=>{if(r.width&&r.height){const e=document.createElement("canvas"),n=e.getContext("2d");e.width=r.width,e.height=r.height,n.drawImage(r,0,0),e.toBlob((e=>{if(e){const n=new File([e],"file.jpg",{type:"image/jpeg"});t(n)}else a("Failed to convert image to blob",s.LOAD_FAILED)}),"image/jpeg")}else a("Image lacks height or width",s.NO_DIMENSIONS)},r.onerror=()=>{a("Error loading image",s.LOAD_FAILED)},r.src=e}))}},514354:(e,t,n)=>{n.d(t,{Q:()=>l,S:()=>o});var i=n(332775),s=n.n(i),a=n(276259),r=n(549755);const o={ERROR_READING_IMAGE_FILE:0,HASHING_ABORTED:1,INVALID_HASH:2},l=(e,t)=>(0,a.qp)(e,t).catch((e=>{throw new r.Z(`An error occurred while reading the image file: ${e}`,e.message===a.ZF?o.HASHING_ABORTED:o.ERROR_READING_IMAGE_FILE)})).then((e=>{const t=s()(e);if(t&&"string"==typeof t)return t;throw new r.Z("Hash is not a non-empty string",o.INVALID_HASH)}))},653843:(e,t,n)=>{n.d(t,{Y7:()=>m,ZP:()=>T,m2:()=>_});var i=n(19697),s=n(790187),a=n(549755),r=n(205074),o=n(276259);function l(e,{maxDimension:t,maxFileSize:n,targetQuality:i}){return function(e,t,n,i){function s(a,r){return d(e,e.width,e.height,a,r).then((e=>{const l=e.width>n||e.height>n,d=e.toDataURL("image/jpeg",i),u=d.split(";base64,")[1],c=(0,o.ku)(u);if(l||c>t){let e=.8;return l&&(e=a>r?n/a:n/r),s(a*e,r*e)}return d}))}return s(e.width,e.height)}(e,n,t,i).then(o.Lw)}function d(e,t,n,s,a){const r=t/2,o=n/2;return e instanceof HTMLCanvasElement&&t<=s&&n<=a?Promise.resolve(e):r<=s&&o<=a?(0,i.$i)(e,s,a):(0,i.$i)(e,r,o).then((e=>d(e,e.width,e.height,s,a)))}const u=5242880,c=4096,h=.85,m={GIF_IS_TOO_LARGE:1,CANNOT_BE_PROCESSED:2,FILE_IS_NOT_AN_IMAGE:3},p=e=>e.orientation!==s.Z.TOP_LEFT&&e.orientation!==s.Z.UNKNOWN,g=(e,t=u,n=c)=>{const{height:i,size:s,width:a}=e;return a>n||i>n||s>t},f=(e,t)=>t||{top:0,left:0,width:e.width,height:e.height},y=(e,t)=>{const{height:n,left:i,top:s,width:a}=f(e,t);return!(0===s&&0===i&&a===e.width&&n===e.height)};function _(e,t){const{maxFileSize:n=u,maxDimension:i=c,cropData:s,jpgPixelsPerByteForResize:a}=t||{},r="image/jpeg"===e.type,o=e.width*e.height/e.size;return p(e)||g(e,n,i)||y(e,s)||r&&!!a&&o<a}const S=(e,t)=>{const{height:n,width:i}=e;return i<=t&&n<=t?{width:i,height:n}:i>n?{width:t,height:Math.round(n/(i/t))}:{width:Math.round(i/(n/t)),height:t}},v=e=>"function"==typeof e.decode?e.decode():Promise.resolve();function T(e,t){const{maxFileSize:n=u,maxDimension:s=c,targetQuality:o=h,cropData:d}=t||{},p=f(e,d);if(!_(e,t))return Promise.resolve(e.fileHandle);if(!(0,r.DS)(e)){const e=new a.Z("The provided file is not a valid image",m.FILE_IS_NOT_AN_IMAGE);return Promise.reject(e)}if(e.isGif){const e=new a.Z("Gifs cannot be processed.",m.GIF_IS_TOO_LARGE);return Promise.reject(e)}const g=e=>l(e,{maxFileSize:n,maxDimension:s,targetQuality:o});return e.withDimensionsAndOrientation().then((({img:e,orientation:t})=>{const n=({height:n,width:s})=>(0,i.$i)(e,s,n,t,p);return v(e).then((()=>(e=>e(S(p,s)))(n))).then(g)})).catch((()=>{const e=new a.Z("Image cannot be processed",m.CANNOT_BE_PROCESSED);return Promise.reject(e)}))}},417144:(e,t,n)=>{function i(e,t=1){let n=t;const i=new Map;let s=0,a=0,r=0,o=null;function l(){i.clear(),s=0,a=0,r=0}return{uploadStart:function(e,t){i.set(e,{time:Date.now(),bytes:t}),a||(a=Date.now())},uploadFinish:function(d,u){const c=i.get(d);c&&(s+=u-c.bytes,i.delete(d),++r===n&&function(){if(!a)return;const i=Date.now()-a;if(i<=0)return;if(1!==t)return;const r=s/i;if(r<5e3&&1===n)return;!o||o.byterate<r?(n+=1,e(),o={byterate:r,poolSize:n}):(n-=2,n=Math.max(n,1),o=null);l()}())},reset:l,getPoolSize:()=>n,start:function(){for(let t=0;t<n;++t)e()}}}n.d(t,{Z:()=>u,d:()=>_});n(543673),n(240753),n(128399);function s(e){const t=new URLSearchParams;for(const n of Object.keys(e)){const i=e[n];i&&t.set(n,i)}return`&${String(t)}`}function a(e,t=o,n=r){const i=Math.max(e,t);return Math.min(i,n)}const r=5242880,o=65536,l=2e3,d=1e4;class u{constructor(e,t=T){var n;this.timeoutIdMap={},this.mediaId="",this.mediaKey="",this.fileHandle=e,this.inflightSegments=new Map,this.totalBytes=e?e.size:0,this.mediaType=e?e.type:void 0,this.initStartTime=new Date,this.sruHeaders=t.sruHeaders||{},this.uploadUrl=t.uploadUrl||p,this.retainMediaForever=!!t.retainMediaForever,this.sruParameterOverrides=t.sruParameterOverrides,this.minSegmentBytes=this.sruParameterOverrides?.minSegmentBytes||(n=this.totalBytes,a(Math.ceil(n/d))),this._clearState()}upload(e){(this.hasAttemptedFinalize&&(this.uploadOptions.trimRanges!==e.trimRanges||this.uploadOptions.extraFinalizeParams!==e.extraFinalizeParams)||this.uploadOptions.extraInitParams!==e.extraInitParams)&&this._clearState(),this.uploadOptions=e,this.state!==v.SUCCEEDED&&this.state!==v.PENDING&&(this.state=v.PENDING,this.hasAttemptedFinalize?this._postFinalize():this.mediaId?this._startNextAppendSegment():this._postInit()),this._bitrateMonitor=e.withMultiRequests?i((()=>{this._startNextAppendSegment()}),e.withMultiRequestsDefaultPoolSize):void 0,this._notifyResult(),this._notifyProgress(this._uploadProgress())}cancel(){"function"==typeof this.uploadOptions.error&&this.uploadOptions.error({code:_.CANCELED}),this._clearState()}pollStatusOfExistingMediaId(e,t){this.mediaId=e,this.uploadOptions=t||T,this.state=v.PENDING,this._getStatus()}_clearState(){for(const e of Object.keys(this.timeoutIdMap))clearTimeout(this.timeoutIdMap[e]),delete this.timeoutIdMap[e];this.state=v.RESET,this.mediaId="",this.mediaKey="",this.uploadOptions=T,this.nextSegmentBytes=this.sruParameterOverrides?.minSegmentBytes||function(){const e=window.navigator.connection;if(e){const t=e.type||e.effectiveType;if(e.downlink)return a(1e3*e.downlink/8/2*l);if("wifi"===t)return a(5*o)}return a(2*o)}(),this.segmentIndex=0,this.totalUploadDuration=0,this.uploadedBytes=0,this.hasAttemptedFinalize=!1,this.inflightSegments.forEach((({request:e})=>e.abort())),this.inflightSegments=new Map,this._bitrateMonitor?.reset()}uploadExternalMedia(e,t,n,i=T){this.uploadOptions=i,this.state=v.PENDING,this.progressMode="uploading";let a=s({source_url:e,media_type:t,media_category:n});a+=this.uploadOptions.extraInitParams||"",a+=this.uploadOptions.extraFinalizeParams||"";this._sendXhr("POST","INIT",a,(e=>{this.mediaId=e.media_id_string,this._getStatus()}),((...e)=>this._uploadError(...e)),h)}_postInit(){if(this.totalBytes){this.progressMode="uploading";const e={total_bytes:String(this.totalBytes),media_type:this.mediaType||""};this.uploadOptions.enable_1080p_variant&&(e.enable_1080p_variant=String(!0));const{mediaItem:t}=this.uploadOptions;if(t?.mediaFile?.duration){const n=1e3*t.mediaFile.duration;e.video_duration_ms=String(n)}let n=s(e);this.uploadOptions.extraInitParams&&(n+=this.uploadOptions.extraInitParams),this._sendXhr("POST","INIT",n,((...e)=>this._initSuccess(...e)),((...e)=>this._uploadError(...e)),h)}else this._uploadError({code:_.ZERO_FILE_LENGTH})}_initSuccess(e){this.state===v.PENDING&&(this.mediaId=e.media_id_string,this.mediaKey=e.media_key,this._setSessionTimeout(e.expires_after_secs),this._bitrateMonitor?this._bitrateMonitor.start():this._startNextAppendSegment())}_setSessionTimeout(e){if(this.timeoutIdMap.session&&(clearTimeout(this.timeoutIdMap.session),delete this.timeoutIdMap.session),e){const t=Math.min(c,1e3*e);this.timeoutIdMap.session=setTimeout((()=>{this._uploadError({code:_.TIMEOUT}),this._stats("NONE","timeout"),this._clearState()}),t)}}_startNextAppendSegment(){if(this.hasAttemptedFinalize||this.inflightSegments.size>=(this._bitrateMonitor?.getPoolSize()??g))return;if(this.uploadedBytes===this.totalBytes)return this._postFinalize();if(!this.fileHandle)return;let e=0;this.inflightSegments.forEach((({bytes:t})=>e+=t));const t=e+this.uploadedBytes,n=Math.min(this.nextSegmentBytes,this.totalBytes-t);if(n<=0)return;const i=new FormData;if(this.fileHandle){const e=this.fileHandle.slice(t,t+n);i.append("media",e)}const a=this.segmentIndex;this.segmentIndex+=1;const r=s({media_id:this.mediaId,segment_index:String(a)}),o=this._sendXhr("POST","APPEND",r,(()=>{if(this.state===v.PENDING){const e=this.inflightSegments.get(a);e&&(this.inflightSegments.delete(a),this.uploadedBytes+=e.bytes),this._notifyProgress(this._uploadProgress(),this.mediaId),0===this.inflightSegments.size&&this._startNextAppendSegment()}}),((...e)=>this._uploadError(...e)),5,i,(()=>this._startNextAppendSegment()),n);this.inflightSegments.set(a,{bytes:n,request:o})}_postFinalize(){if(this.uploadOptions.pauseBeforeFinalize)this.state=v.PAUSED,this.uploadOptions.pause&&this.uploadOptions.pause();else{this.hasAttemptedFinalize=!0;const e={media_id:this.mediaId};this.uploadOptions.trimRanges&&(e.trim_ranges=this.uploadOptions.trimRanges),this.mediaType&&/^video\//.test(this.mediaType)&&(e.allow_async=String(!0)),this.retainMediaForever&&(e.ttl="infinite");let t=s(e);t+=this.uploadOptions.extraFinalizeParams||"",this._sendXhr("POST","FINALIZE",t,((...e)=>this._finalizeOrStatusSuccess(...e)),((...e)=>this._uploadError(...e)),h)}}_finalizeOrStatusSuccess(e){this._setSessionTimeout(e.expires_after_secs);const t=e.processing_info;if(!t)return void this._finalizeSuccess(e);let n=0;switch(t.state){case"pending":this.progressMode="waiting";break;case"in_progress":this.progressMode="processing","number"==typeof t.progress_percent&&(n=t.progress_percent),n>=100&&(n=99);break;case"succeeded":return void this._finalizeSuccess(e);case"failed":{const e=t.error;let n;return n=e?.code?S[String(e.code)]:_.INTERNAL_ERROR,void this._uploadError({...e,code:n})}default:return void this._uploadError()}this._notifyProgress(n,this.mediaId,this.mediaKey);const i=t.check_after_secs||10;setTimeout(((...e)=>this._getStatus(...e)),1e3*i)}_getStatus(){if(this.state===v.PENDING){const e=s({media_id:this.mediaId});this._sendXhr("GET","STATUS",e,((...e)=>this._finalizeOrStatusSuccess(...e)),((...e)=>this._uploadError(...e)),h)}}_finalizeSuccess(e){this.state===v.PENDING&&(this.state=v.SUCCEEDED,this._notifyResult())}_uploadError(e){if(this.state!==v.PENDING)return;const t=e.error?.match(/{ "message": "maxFileSizeExceeded", "maxFileSizeBytes": \d+ }/);if(t){const e=JSON.parse(t[0]);this.error={code:_.FILE_TOO_LARGE,message:e.message,maxSizeBytes:e.maxFileSizeBytes}}else e&&e.code?this.error=e:this.error={code:_.INTERNAL_ERROR,message:e?.error};this.state=v.FAILED,this._notifyResult()}_uploadProgress(){if(this.totalBytes){return 100*(this.uploadedBytes/this.totalBytes)}return 0}_notifyProgress(e,t,n){this.state!==v.FAILED&&this.uploadOptions.progress&&this.uploadOptions.progress(e,this.progressMode,t,n)}_notifyResult(){this.state===v.SUCCEEDED&&this.uploadOptions.success&&this.uploadOptions.success(this.mediaId,this.mediaKey),this.state===v.FAILED&&this.uploadOptions.error&&this.uploadOptions.error(this.error)}_stats(e,t,n={}){const i=n.requestStartTime||this.initStartTime,s=(new Date).getTime()-i.getTime();if(this.totalUploadDuration+=s,this.uploadOptions.stats){const i={mediaType:this.mediaType||"",command:e,status:t,duration:s,totalByteSize:this.totalBytes,totalDuration:this.totalUploadDuration};n.segmentBytes&&(i.appendByteSize=n.segmentBytes),this.uploadOptions.stats(i)}}_sendXhr(e,t,n,i,s,r,o,d,u=0){const c=`${this.uploadUrl}?command=${t}${n}`;let h=!1;const p=new Date,g=a=>{if(r){const a=[c,r].join("-");this.timeoutIdMap[a]=setTimeout((()=>{this._sendXhr(e,t,n,i,s,r-1,o,d,u)}),y)}else S(a)},S=e=>{this._stats(t,e||"unknown-error",{requestStartTime:p,segmentBytes:u}),"function"==typeof s&&s(w(v)||{code:_.INVALID_RES_STATUS,mediaId:this.mediaId})},v=new XMLHttpRequest;v.open(e,c,!0),v.withCredentials=!0,v.timeout=this.sruParameterOverrides?.clientsideSruUploadTimeoutMs||m,v.onload=()=>{if(v.status>=200&&v.status<400){const e=w(v);204===v.status||e?(this._stats(t,"success",{requestStartTime:p,segmentBytes:u}),i(e||{}),!h&&d&&d()):g("parsererror")}else v.status&&503!==v.status?S("invalid-response"):g("503")},v.onerror=()=>g("error"),v.ontimeout=()=>{this.nextSegmentBytes=this.minSegmentBytes,g("timeout")};let T=!1;v.upload.onprogress=e=>{T?e.loaded===e.total&&this._bitrateMonitor?.uploadFinish(c,e.total):(T=!0,this._bitrateMonitor?.uploadStart(c,e.loaded));const t=e.loaded,n=(this.uploadedBytes+t)/this.totalBytes*100;if(this._notifyProgress(n,this.mediaId),t/e.total>f&&!h&&(h=!0,o)){const e=Math.max(1,(new Date).getTime()-p.getTime()),n=this.minSegmentBytes,i=this.sruParameterOverrides?.maxSegmentBytes;this.nextSegmentBytes=function(e){const t=e.idealUploadTimeMs||l,n=e.sentBytes/e.uploadTimeMs;return a(Math.round(t*n),e.minSegmentBytes,e.maxSegmentBytes)}({minSegmentBytes:n,sentBytes:t,uploadTimeMs:e,maxSegmentBytes:i,idealUploadTimeMs:this.sruParameterOverrides?.idealUploadTimeMs}),"function"==typeof d&&d()}};for(const e in this.sruHeaders)v.setRequestHeader(e,this.sruHeaders[e]);return o?v.send(o):v.send(),v}}const c=2147483647,h=1,m=45e3,p=(window.location.host.includes("twitter.com")?"https://upload.twitter.com":"https://upload.x.com")+"/i/media/upload.json",g=2,f=.95,y=1e3,_=Object.freeze({FILE_TOO_LARGE:2,INTERNAL_ERROR:131,INVALID_MEDIA:1,RATE_LIMIT:88,TIMEOUT:67,UNSUPPORTED_MEDIA:3,ZERO_FILE_LENGTH:4,CANCELED:999,INVALID_RES_STATUS:-1}),S=Object.freeze({0:_.INTERNAL_ERROR,1:_.INVALID_MEDIA,2:_.FILE_TOO_LARGE,3:_.UNSUPPORTED_MEDIA,4:_.TIMEOUT}),v=Object.freeze({RESET:0,PENDING:1,PAUSED:2,SUCCEEDED:3,FAILED:4}),T={};function w(e){try{return JSON.parse(e.responseText)}catch(e){return null}}},452661:(e,t,n)=>{n.d(t,{Z:()=>g});var i=n(18198),s={centroidDimension:function(e,t,n,i){var a=e.touchBank,r=0,o=0,l=1===e.numberActiveTouches?e.touchBank[e.indexOfSingleActiveTouch]:null;if(null!==l)l.touchActive&&l.currentTimeStamp>t&&(r+=i&&n?l.currentPageX:i&&!n?l.currentPageY:!i&&n?l.previousPageX:l.previousPageY,o=1);else for(var d=0;d<a.length;d++){var u=a[d];if(null!=u&&u.touchActive&&u.currentTimeStamp>=t){r+=i&&n?u.currentPageX:i&&!n?u.currentPageY:!i&&n?u.previousPageX:u.previousPageY,o++}}return o>0?r/o:s.noCentroid},currentCentroidXOfTouchesChangedAfter:function(e,t){return s.centroidDimension(e,t,!0,!0)},currentCentroidYOfTouchesChangedAfter:function(e,t){return s.centroidDimension(e,t,!1,!0)},previousCentroidXOfTouchesChangedAfter:function(e,t){return s.centroidDimension(e,t,!0,!1)},previousCentroidYOfTouchesChangedAfter:function(e,t){return s.centroidDimension(e,t,!1,!1)},currentCentroidX:function(e){return s.centroidDimension(e,0,!0,!0)},currentCentroidY:function(e){return s.centroidDimension(e,0,!1,!0)},noCentroid:-1};const a=s;var r=a.currentCentroidXOfTouchesChangedAfter,o=a.currentCentroidYOfTouchesChangedAfter,l=a.previousCentroidXOfTouchesChangedAfter,d=a.previousCentroidYOfTouchesChangedAfter,u=a.currentCentroidX,c=a.currentCentroidY,h={_initializeGestureState(e){e.moveX=0,e.moveY=0,e.x0=0,e.y0=0,e.dx=0,e.dy=0,e.vx=0,e.vy=0,e.numberActiveTouches=0,e._accountsForMovesUpTo=0},_updateGestureStateOnMove(e,t){e.numberActiveTouches=t.numberActiveTouches,e.moveX=r(t,e._accountsForMovesUpTo),e.moveY=o(t,e._accountsForMovesUpTo);var n=e._accountsForMovesUpTo,i=l(t,n),s=r(t,n),a=d(t,n),u=o(t,n),c=e.dx+(s-i),h=e.dy+(u-a),m=t.mostRecentTimeStamp-e._accountsForMovesUpTo;e.vx=(c-e.dx)/m,e.vy=(h-e.dy)/m,e.dx=c,e.dy=h,e._accountsForMovesUpTo=t.mostRecentTimeStamp},create(e){var t={handle:null,shouldCancelClick:!1,timeout:null},n={stateID:Math.random(),moveX:0,moveY:0,x0:0,y0:0,dx:0,dy:0,vx:0,vy:0,numberActiveTouches:0,_accountsForMovesUpTo:0};return{panHandlers:{onStartShouldSetResponder:t=>null!=e.onStartShouldSetPanResponder&&e.onStartShouldSetPanResponder(t,n),onMoveShouldSetResponder:t=>null!=e.onMoveShouldSetPanResponder&&e.onMoveShouldSetPanResponder(t,n),onStartShouldSetResponderCapture:t=>(1===t.nativeEvent.touches.length&&h._initializeGestureState(n),n.numberActiveTouches=t.touchHistory.numberActiveTouches,null!=e.onStartShouldSetPanResponderCapture&&e.onStartShouldSetPanResponderCapture(t,n)),onMoveShouldSetResponderCapture(t){var i=t.touchHistory;return n._accountsForMovesUpTo!==i.mostRecentTimeStamp&&(h._updateGestureStateOnMove(n,i),!!e.onMoveShouldSetPanResponderCapture&&e.onMoveShouldSetPanResponderCapture(t,n))},onResponderGrant:s=>(t.handle||(t.handle=i.Z.createInteractionHandle()),t.timeout&&function(e){clearTimeout(e.timeout)}(t),t.shouldCancelClick=!0,n.x0=u(s.touchHistory),n.y0=c(s.touchHistory),n.dx=0,n.dy=0,e.onPanResponderGrant&&e.onPanResponderGrant(s,n),null==e.onShouldBlockNativeResponder||e.onShouldBlockNativeResponder(s,n)),onResponderReject(i){m(t,e.onPanResponderReject,i,n)},onResponderRelease(i){m(t,e.onPanResponderRelease,i,n),p(t),h._initializeGestureState(n)},onResponderStart(t){var i=t.touchHistory;n.numberActiveTouches=i.numberActiveTouches,e.onPanResponderStart&&e.onPanResponderStart(t,n)},onResponderMove(t){var i=t.touchHistory;n._accountsForMovesUpTo!==i.mostRecentTimeStamp&&(h._updateGestureStateOnMove(n,i),e.onPanResponderMove&&e.onPanResponderMove(t,n))},onResponderEnd(i){var s=i.touchHistory;n.numberActiveTouches=s.numberActiveTouches,m(t,e.onPanResponderEnd,i,n)},onResponderTerminate(i){m(t,e.onPanResponderTerminate,i,n),p(t),h._initializeGestureState(n)},onResponderTerminationRequest:t=>null==e.onPanResponderTerminationRequest||e.onPanResponderTerminationRequest(t,n),onClickCapture:e=>{!0===t.shouldCancelClick&&(e.stopPropagation(),e.preventDefault())}},getInteractionHandle:()=>t.handle}}};function m(e,t,n,s){e.handle&&(i.Z.clearInteractionHandle(e.handle),e.handle=null),t&&t(n,s)}function p(e){e.timeout=setTimeout((()=>{e.shouldCancelClick=!1}),250)}const g=h},372612:(e,t,n)=>{n.d(t,{Z:()=>v});var i=n(133028),s=n(807896),a=n(231461),r=n(202784),o=n(890601),l=/^[+-]?\d*(?:\.\d+)?(?:[Ee][+-]?\d+)?(%|\w*)/;const d=(e,t)=>{var n;return"string"==typeof e?""+parseFloat(e)*t+e.match(l)[1]:(n=e,!isNaN(parseFloat(n))&&isFinite(n)?e*t:void 0)};var u=n(297689),c=n(325686),h=["aria-label","accessibilityLabel","activeThumbColor","activeTrackColor","disabled","onValueChange","style","thumbColor","trackColor","value"],m={},p="0px 1px 3px rgba(0,0,0,0.5)",g=p+", 0 0 0 10px rgba(0,0,0,0.1)",f="#D5D5D5",y="#BDBDBD",_=r.forwardRef(((e,t)=>{var n=e["aria-label"],i=e.accessibilityLabel,l=e.activeThumbColor,_=e.activeTrackColor,v=e.disabled,T=void 0!==v&&v,w=e.onValueChange,E=e.style,I=void 0===E?m:E,O=e.thumbColor,F=e.trackColor,R=e.value,b=void 0!==R&&R,k=(0,a.Z)(e,h),P=r.useRef(null);function A(e){var t="focus"===e.nativeEvent.type?g:p;null!=P.current&&(P.current.style.boxShadow=t)}var M=u.Z.flatten(I),D=M.height,L=M.width,C=D||"20px",x=d(C,2),N=L>x?L:x,B=d(C,.5),U=!0===b?null!=F&&"object"==typeof F?F.true:null!=_?_:"#A3D3CF":null!=F&&"object"==typeof F?F.false:null!=F?F:"#939393",K=b?null!=l?l:"#009688":null!=O?O:"#FAFAFA",Z=C,G=Z,z=[S.root,I,T&&S.cursorDefault,{height:C,width:N}],H=!0===b?"string"==typeof _&&null!=_||"object"==typeof F&&null!=F&&F.true?U:f:"string"==typeof F&&null!=F||"object"==typeof F&&null!=F&&F.false?U:f,j=!0===b?null==l?y:K:null==O?y:K,q=[S.track,{backgroundColor:T?H:U,borderRadius:B}],X=[S.thumb,b&&S.thumbActive,{backgroundColor:T?j:K,height:Z,marginStart:b?d(G,-1):0,width:G}],V=(0,o.Z)("input",{"aria-label":n||i,checked:b,disabled:T,onBlur:A,onChange:function(e){null!=w&&w(e.nativeEvent.target.checked)},onFocus:A,ref:t,style:[S.nativeControl,S.cursorInherit],type:"checkbox",role:"switch"});return r.createElement(c.Z,(0,s.Z)({},k,{style:z}),r.createElement(c.Z,{style:q}),r.createElement(c.Z,{ref:P,style:X}),V)}));_.displayName="Switch";var S=u.Z.create({root:{cursor:"pointer",userSelect:"none"},cursorDefault:{cursor:"default"},cursorInherit:{cursor:"inherit"},track:(0,i.Z)((0,i.Z)({forcedColorAdjust:"none"},u.Z.absoluteFillObject),{},{height:"70%",margin:"auto",transitionDuration:"0.1s",width:"100%"}),thumb:{forcedColorAdjust:"none",alignSelf:"flex-start",borderRadius:"100%",boxShadow:p,start:"0%",transform:"translateZ(0)",transitionDuration:"0.1s"},thumbActive:{insetInlineStart:"100%"},nativeControl:(0,i.Z)((0,i.Z)({},u.Z.absoluteFillObject),{},{height:"100%",margin:0,appearance:"none",padding:0,width:"100%"})});const v=_}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/bundle.GrokDrawer-6107ac1a.26d7ccaa.js.map