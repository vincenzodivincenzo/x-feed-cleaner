(self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["bundle.GrokDrawer-9f4db315"],{155074:e=>{e.exports={queryId:"83Gg0lfI-47Z3-ZOxyUjiQ",operationName:"ClearGrokConversations",operationType:"mutation",metadata:{featureSwitches:[],fieldToggles:[]}}},834949:e=>{e.exports={queryId:"vvC5uy7pWWHXS2aDi1FZeA",operationName:"CreateGrokConversation",operationType:"mutation",metadata:{featureSwitches:[],fieldToggles:[]}}},491156:e=>{e.exports={queryId:"kaH0vdJmbuocpRAeWpRC7A",operationName:"DeleteGrokMessage",operationType:"mutation",metadata:{featureSwitches:[],fieldToggles:[]}}},645513:e=>{e.exports={queryId:"b5KcXWCNr_I_O-m7_WjKBA",operationName:"GrokConversationItemsByRestId",operationType:"query",metadata:{featureSwitches:["creator_subscriptions_tweet_preview_api_enabled","premium_content_api_read_enabled","communities_web_enable_tweet_community_results_fetch","c9s_tweet_anatomy_moderator_badge_enabled","responsive_web_grok_analyze_button_fetch_trends_enabled","responsive_web_grok_analyze_post_followups_enabled","responsive_web_jetfuel_frame","responsive_web_grok_share_attachment_enabled","articles_preview_enabled","responsive_web_edit_tweet_api_enabled","graphql_is_translatable_rweb_tweet_is_translatable_enabled","view_counts_everywhere_api_enabled","longform_notetweets_consumption_enabled","responsive_web_twitter_article_tweet_consumption_enabled","tweet_awards_web_tipping_enabled","responsive_web_grok_show_grok_translated_post","responsive_web_grok_analysis_button_from_backend","creator_subscriptions_quote_tweet_preview_enabled","freedom_of_speech_not_reach_fetch_enabled","standardized_nudges_misinfo","tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled","longform_notetweets_rich_text_read_enabled","longform_notetweets_inline_media_enabled","payments_enabled","profile_label_improvements_pcf_label_in_post_enabled","rweb_tipjar_consumption_enabled","verified_phone_label_enabled","responsive_web_grok_image_annotation_enabled","responsive_web_grok_community_note_auto_translation_is_enabled","responsive_web_graphql_skip_user_profile_image_extensions_enabled","responsive_web_graphql_timeline_navigation_enabled","responsive_web_enhance_cards_enabled"],fieldToggles:["withArticleRichContentState","withArticlePlainText","withGrokAnalyze","withDisallowedReplyControls","withAuxiliaryUserLabels"]}}},470969:e=>{e.exports={queryId:"9Hyh5D4-WXLnExZkONSkZg",operationName:"GrokHistory",operationType:"query",metadata:{featureSwitches:[],fieldToggles:[]}}},374709:e=>{e.exports={queryId:"ZYQK0wvMfoTAwGTKIu71zQ",operationName:"GrokHome",operationType:"query",metadata:{featureSwitches:[],fieldToggles:[]}}},709401:e=>{e.exports={queryId:"azn3Sg0APPjb2Jtd7gqxsw",operationName:"GrokMediaHistory",operationType:"query",metadata:{featureSwitches:[],fieldToggles:[]}}},965508:e=>{e.exports={queryId:"_6czUDKiWzcvBUKMoDZ19w",operationName:"GrokPinConversation",operationType:"mutation",metadata:{featureSwitches:[],fieldToggles:[]}}},416024:e=>{e.exports={queryId:"BHKxYTkc5SCupV7oqJBr0g",operationName:"GrokPinnedConversations",operationType:"query",metadata:{featureSwitches:[],fieldToggles:[]}}},716442:e=>{e.exports={queryId:"Sr2QEitvnemma5D2NJlA2Q",operationName:"SearchGrokConversations",operationType:"query",metadata:{featureSwitches:[],fieldToggles:[]}}},985289:e=>{e.exports={queryId:"gxbY2KieRwxhs7i8Km5Ixw",operationName:"GrokShare",operationType:"query",metadata:{featureSwitches:["creator_subscriptions_tweet_preview_api_enabled","premium_content_api_read_enabled","communities_web_enable_tweet_community_results_fetch","c9s_tweet_anatomy_moderator_badge_enabled","responsive_web_grok_analyze_button_fetch_trends_enabled","responsive_web_grok_analyze_post_followups_enabled","responsive_web_jetfuel_frame","responsive_web_grok_share_attachment_enabled","articles_preview_enabled","responsive_web_edit_tweet_api_enabled","graphql_is_translatable_rweb_tweet_is_translatable_enabled","view_counts_everywhere_api_enabled","longform_notetweets_consumption_enabled","responsive_web_twitter_article_tweet_consumption_enabled","tweet_awards_web_tipping_enabled","responsive_web_grok_show_grok_translated_post","responsive_web_grok_analysis_button_from_backend","creator_subscriptions_quote_tweet_preview_enabled","freedom_of_speech_not_reach_fetch_enabled","standardized_nudges_misinfo","tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled","longform_notetweets_rich_text_read_enabled","longform_notetweets_inline_media_enabled","payments_enabled","profile_label_improvements_pcf_label_in_post_enabled","rweb_tipjar_consumption_enabled","verified_phone_label_enabled","responsive_web_grok_image_annotation_enabled","responsive_web_grok_community_note_auto_translation_is_enabled","responsive_web_graphql_skip_user_profile_image_extensions_enabled","responsive_web_graphql_timeline_navigation_enabled","responsive_web_enhance_cards_enabled"],fieldToggles:["withArticleRichContentState","withArticlePlainText","withGrokAnalyze","withDisallowedReplyControls","withAuxiliaryUserLabels"]}}},524816:e=>{e.exports={queryId:"-5e798p4EVbuhGGFFuw3Tg",operationName:"GrokUnpinConversation",operationType:"mutation",metadata:{featureSwitches:[],fieldToggles:[]}}},917665:e=>{e.exports={queryId:"AB0damyVo0wBhhebQIwtsg",operationName:"GrokUserEventsLog",operationType:"mutation",metadata:{featureSwitches:[],fieldToggles:[]}}},587068:e=>{e.exports={queryId:"NqLS09LPofalCjVhFolKtA",operationName:"SetGrokPreferences",operationType:"mutation",metadata:{featureSwitches:[],fieldToggles:[]}}},6157:(e,t,s)=>{"use strict";s.d(t,{Z:()=>k});var a=s(468811),i=s.n(a),r=s(163889),o=s(155074),n=s.n(o),d=s(491156),l=s.n(d),_=s(645513),c=s.n(_),u=s(470969),m=s.n(u),p=s(374709),h=s.n(p),g=s(709401),b=s.n(g),w=s(965508),f=s.n(w),S=s(416024),T=s.n(S),I=s(716442),y=s.n(I),v=s(985289),x=s.n(v),C=s(524816),E=s.n(C),L=s(917665),P=s.n(L),D=s(587068),O=s.n(D);function k({apiClient:e}){return{clearConversations:(t,s)=>e.graphQL(n(),{}).then((e=>(e.clear_grok_conversations?.grok_deletion_error?.error_code&&(0,r.ZP)("GraphQL clear grok conversations failed."),e))),setPreferences:({grokMode:t,grokModelOptionId:s})=>e.graphQL(O(),{grokMode:t,grokModelOptionId:s}).then((e=>(e.set_grok_preferences?.preference_update_error?.error_code&&(0,r.ZP)("GraphQL set grok preferences failed."),e))),fetchConversation:({restId:t})=>e.graphQL(c(),{restId:t}).then((e=>e)),fetchGrokShareGraphQL:({grok_share_id:t})=>e.graphQL(x(),{grok_share_id:t}).then((e=>e)),fetchGrokHome:()=>e.graphQL(h(),{}).then((e=>e)),fetchHistory:({cursor:t})=>e.graphQL(m(),{cursor:t}).then((e=>e)),fetchPinnedConversations:({cursor:t})=>e.graphQL(T(),{cursor:t}).then((e=>e)),fetchMediaHistory:({cursor:t})=>e.graphQL(b(),{cursor:t}).then((e=>e)),searchConversations:({keyword:t})=>e.graphQL(y(),{keyword:t}).then((e=>(e.grok_conversation_search_timeline?.items??[]).map((e=>({chatItemId:e.chat_item_id,conversation:{id:e.grokConversation?.rest_id},message:e.chat_item?.message,createdAt:e.chat_item?.created_at_ms,title:e.conversation_title}))).filter((e=>e.chatItemId&&e.conversation.id)))),deleteMessage:({chat_item_id:t,conversation_id:s})=>e.graphQL(l(),{conversation_id:s,chat_item_id:t}).then((e=>e)),logUserEventGrok:({action_type:t,group_id:s,object_id:a})=>e.graphQL(P(),{group_id:s,object_id:a,action_type:t}).then((e=>e)),grokPinConversation:({conversationId:t})=>e.graphQL(f(),{conversationId:t}).then((e=>e)),grokUnpinConversation:({conversationId:t})=>e.graphQL(E(),{conversationId:t}).then((e=>e)),uploadFile:({abortController:t,file:s})=>{const a=new FormData;return a.append("image",s),e.postForm("grok/attachment",a,{},{"x-xai-request-id":i().v4()},void 0,t.signal).then((e=>e.map((e=>({...e,url:e.url??(void 0!==e.mediaId?`https://api.x.com/2/grok/attachment.json?mediaId=${e.mediaId}`:void 0)})))))}}}},904940:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});const a=({apiClient:e,featureSwitches:t})=>({metadataCreate:(t,s)=>e.post("media/metadata/create",t,{},{...s,"content-type":"application/json"}),attachSubtitles:(t,s)=>e.post("media/subtitles/create",{media_id:t.videoMediaUploadId,media_category:t.videoMediaCategory,subtitle_info:{subtitles:[{media_id:t.subtitlesMediaUploadId,language_code:t.subtitlesLang,display_name:t.subtitlesDisplayName}]}},{},{...s,"content-type":"application/json"})})},708482:(e,t,s)=>{"use strict";s.d(t,{s:()=>r});var a=s(10622),i=s.n(a);function r(e,t,s,a){return i()(e,t,s,a?{networkCacheConfig:{metadata:{isFatalError:a}}}:void 0).toPromise()}},301758:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var a=s(807896),i=s(202784),r=s(235902),o=s(521288),n=s(401388),d=s(988566),l=s(725516),_=s(443781),c=s(71620),u=s(668214),m=s(425182),p=s(836255);const h=(e,t)=>t.tweetId,g=(e,t)=>{const s=t.tweetId,a=s&&p.Z.select(e,s);return a?(0,m.z0)(e,a):void 0},b=(0,u.Z)().propsFromState((()=>({community:g,hydratedTweet:p.Z.createHydratedTweetSelector(h)}))).propsFromActions((()=>({createLocalApiErrorHandler:(0,c.zr)("QUOTE_TWEET_CONTAINER"),fetchCommunityIfNeeded:m.ZP.fetchOneIfNeeded})))((({community:e,createLocalApiErrorHandler:t,fetchCommunityIfNeeded:s,hydratedTweet:c,onAvatarClick:u,onMediaClick:m,onPress:p,onScreenNameClick:h,tweetId:g,withBirdwatchPivot:b=!0,...w})=>{const{featureSwitches:f,viewerUserId:S}=i.useContext(_.rC),T=(0,l.z)(),I=c?.community_id_str;i.useEffect((()=>{I&&(0,n.Z)(e)&&s(I).catch(t())}),[e,I,t,s]);const y=i.useCallback((e=>{T.scribeAction("click"),p&&p(e)}),[p,T]),v=!!b,x=c&&(0,d.D$)(c,S,e),C=x&&(0,d.rl)(x);return i.createElement(r.ZP.Provider,{value:{isEditTweetConsumptionEnabled:()=>f.isTrue("responsive_web_edit_tweet_enabled")||f.isTrue("subscriptions_feature_labs_1004")}},i.createElement(o.Z,(0,a.Z)({},w,{loggedInUserId:S,onAvatarClick:u,onMediaClick:m,onPress:y,onScreenNameClick:h,shouldShowAltLabelAlways:!0,socialContextProps:C,tweet:c,withBirdwatchPivot:v})))}))},306677:(e,t,s)=>{"use strict";s.d(t,{D:()=>n});var a=s(202784),i=s(325686),r=s(392237),o=s(390686);function n(e){const{id:t,onFullyVisible:s,position:r,testID:n}=e,l=a.useMemo((()=>{switch(r){case"top":return d.topPixel;case"bottom":return d.bottomPixel;case"right":return d.rightPixel;case"left":return d.leftPixel;default:return}}),[r]),_=a.useCallback((e=>{e.visibleFraction()>=o.xn&&s()}),[s]);return a.createElement(i.Z,{style:[d.impressionPixelContainer,l],testID:n},a.createElement(o.ZP,{key:t,onPlacementChange:_},a.createElement(i.Z,{style:d.impressionPixel})))}const d=r.default.create((e=>({impressionPixel:{visibility:"hidden",height:"1px",width:"1px"},impressionPixelContainer:{position:"absolute"},topPixel:{top:"0",end:"50%"},bottomPixel:{bottom:"0",end:"50%"},rightPixel:{end:"0",top:"50%"},leftPixel:{start:"0",top:"50%"}})))},944681:(e,t,s)=>{"use strict";s.d(t,{k:()=>i,Q:()=>r});const a=(e,t,s)=>{const a=new Date;let i=a.getFullYear()-e;const r=a.getMonth()+1-t;if(r<0)i-=1;else if(0===r){a.getDate()-s<0&&(i-=1)}return i},i=(e,t,s,i=!1)=>e&&t&&s?a(e,t,s)<18:i,r=()=>(new Date).getFullYear()-120},128225:(e,t,s)=>{"use strict";s.d(t,{f:()=>a});s(543673),s(240753),s(128399),s(571372);const a=(e,t=!1,s=!1)=>new Promise(((a,i)=>{const r=new URL(e);s&&!e.startsWith("blob:")&&r.searchParams.set("grok_timestamp",Date.now().toString());const o=new window.XMLHttpRequest;o.responseType="blob",o.onreadystatechange=()=>{o.readyState===window.XMLHttpRequest.DONE&&(200===o.status?a(o.response):i(new Error("Unexpected status code")))},o.withCredentials=t,o.onerror=e=>i(e),o.ontimeout=e=>i(e),o.open("GET",r.toString(),!0),o.send()}))},166677:(e,t,s)=>{"use strict";s.d(t,{$r:()=>X,O9:()=>$,ZP:()=>K,vK:()=>Y});var a=s(688715),i=s(111677),r=s.n(i),o=s(653843),n=s(122123),d=s(417144),l=s(884495),_=s(716233),c=s(540387);const u=r().b8098028,m=r().b36f4170,p=r().hab3781e,h=r().f6c4fb02,g=r().g0af3dd2,b=r().b8c8b0be,w=r().ica6d718,f=r().b28d44f7({limit:15}),S=r().i1db7d13,T=r().baac0ed7,I=S({limit:512}),y=r().a22385bb,v=r().be0440bf,x=y({limit:140}),C=r().feeba512,E=r().db123c02,L=r().db6001e7({limit:5}),P=r().eb96d952,D=r().i859a9d4,O=r().b3880588,k=r().ca058b68,A=r().id24379c,U=r().h4d7cbcc,R=(0,a.ju)("https://support.x.com/articles/20156423"),M=(0,a.ju)("https://help.x.com/using-twitter/twitter-videos"),N=e=>({text:e}),F=e=>({text:e,action:{label:D,link:R}}),G=e=>({text:e,action:{label:D,link:M}}),z={[o.Y7.GIF_IS_TOO_LARGE]:N(f),[o.Y7.CANNOT_BE_PROCESSED]:N(u),[o.Y7.FILE_IS_NOT_AN_IMAGE]:N(p)},q={[d.d.ZERO_FILE_LENGTH]:N(m),[d.d.TIMEOUT]:N(O)},Z={...q,[d.d.FILE_TOO_LARGE]:N(L),[d.d.UNSUPPORTED_MEDIA]:F(E),[d.d.INVALID_MEDIA]:F(C)},Q={...q,[d.d.FILE_TOO_LARGE]:N(f),[d.d.UNSUPPORTED_MEDIA]:F(g),[d.d.INVALID_MEDIA]:F(h)},j={...q,[d.d.FILE_TOO_LARGE]:N(I),[d.d.UNSUPPORTED_MEDIA]:G(w),[d.d.INVALID_MEDIA]:G(b)},V=Object.freeze({RESIZE:"resize",UPLOAD:"upload",METADATA:"metadata",MAXDURATION:"maxduration",MAXSIZE:"maxsize"}),B=1048576,W=1073741824,$=e=>Object.values(V).includes(e.type),H=e=>{const{code:t,limit:s,type:a}=e;if(t)switch(a){case V.MAXSIZE:return t===_.BW.GIF_IS_TOO_LARGE?N(f):t===_.BW.VIDEO_IS_TOO_LARGE&&void 0!==s?N(s>=W?T({limit:Math.round(s/W)}):S({limit:Math.round(s/B)})):N(I);case V.MAXDURATION:return void 0!==s?s>140?N(v({limit:Math.round(s/60)})):{text:y({limit:Math.round(s)}),action:{label:l.Z.LongerVideoUpload.defaultContent.actionLabel,link:{pathname:`/i/premium_sign_up?referring_page=${l.Z.LongerVideoUpload.referringPage}`,external:!0}}}:N(x);case V.RESIZE:return z[t];case V.UPLOAD:if(e.isImage)return Z[t];if(e.isGif)return Q[t];if(e.isVideo)return j[t];break;case V.METADATA:return N(U)}},X=e=>{if($(e))return e};function K(e,t=A){const s=X(e);if(s){const a=e.message?`${t} ${e.message}`:t;return H(s)||N(a)}}function Y(e,t=k){return e.type===n.gK.type&&e.code===n.gK.NO_DIMENSIONS?N(P):e.type===c.hb.type&&e.code===c.hb.NO_DIMENSIONS?G(b):N(t)}},221562:(e,t,s)=>{"use strict";s.d(t,{BX:()=>g,Uk:()=>c,Xj:()=>u,ZP:()=>y});var a=s(468811),i=s.n(a),r=s(595088),o=s(161821),n=s(184605),d=s(716233),l=s(774717);const _=Object.freeze({LocalFile:"local_file",Remote:"remote"}),c=Object.freeze({Cancel:"cancel",Failure:"failure",Success:"success",Complete:"complete",Invalid:"invalid"}),u=Object.freeze({InProgress:"in_progress",Complete:"complete",Failure:"failure",Canceled:"canceled"}),m=e=>e?p(e):void 0,p=e=>(0,r.Z)(e).filter((([e,t])=>void 0!==t)).map((([t,s])=>"object"==typeof s?`${t}=${h(e[t])}`:`${t}=${String(s)}`)).join(";"),h=e=>(0,o.Z)(e).filter((e=>void 0!==e)).map(String).join(":"),g=Object.freeze({Full:"full",Hash:"hash",Processing:"processing",SruUpload:"sru_upload",UploadSubmitUntilSruFinish:"upload_submit_until_sru_finish",Metadata:"metadata"}),b=Object.freeze({SruUpload:"sru_upload_no_eager",UploadSubmitUntilSruFinish:"upload_submit_until_sru_finish_no_eager"}),w={[g.SruUpload]:b.SruUpload,[g.UploadSubmitUntilSruFinish]:b.UploadSubmitUntilSruFinish},f=Object.freeze({All:"all",Short:"short",Medium:"medium",Long:"long",XLong:"xlong",L90to140s:"l90to140s",L140to300s:"l140to300s",L300to600s:"l300to600s",L600to1200s:"l600to1200s",L1200to1800s:"l1200to1800s",L1800to2700s:"l1800to2700s",L2700to3600s:"l2700to3600s",L3600to4500s:"l3600to4500s",L4500to5400s:"l4500to5400s",L5400to6300s:"l5400to6300s",L6300to7200s:"l6300to7200s",L7200to10800s:"l7200to10800s",L10800to14400s:"l10800to14400s",LGT14400s:"lgt14400s"}),S=(e,t)=>(0,n.Z)(e)&&(0,n.Z)(t)?Math.round(t-e):void 0,T=()=>window.performance?window.performance.now():Date.now(),I=(e,t)=>e===d.xz.DMGif||e===d.xz.TweetGif?f.All:e!==d.xz.DMVideo&&e!==d.xz.TweetVideo&&e!==d.xz.AmplifyVideo||void 0===t?"":t<10?f.Short:t<20?f.Medium:t<45?f.Long:t<90?f.XLong:t<140?f.L90to140s:t<300?f.L140to300s:t<600?f.L300to600s:t<1200?f.L600to1200s:t<1800?f.L1200to1800s:t<2700?f.L1800to2700s:t<3600?f.L2700to3600s:t<4500?f.L3600to4500s:t<5400?f.L4500to5400s:t<6300?f.L5400to6300s:t<7200?f.L6300to7200s:t<10800?f.L7200to10800s:t<14400?f.L10800to14400s:f.LGT14400s;class y{constructor(e,t=!1){this._pausedDuration={},this._pauseTimes={},this._startTimes={},this._eagerUploadDisabled=t,this._impressionId=i().v4(),this._keyPrefix=(e=>{const{isExternal:t,mediaCategory:s,videoDuration:a}=e;return`${t?_.Remote:_.LocalFile}:${s}:${I(s,a)}`})(e),this.setMetadata({submitted:!1})}reportOperationComplete(e,t){(Array.isArray(e)?e:[e]).forEach((e=>{void 0!==this._pauseTimes[e]&&this.toggleOperationPaused(e,!1);let s=S(this._startTimes[e],T());if(this._keyPrefix&&void 0!==s){void 0!==this._pausedDuration[e]&&(s-=this._pausedDuration[e]);const a=this._getKey(e,t);this._record(a,s,e===g.Full?this._metadata:e===g.Metadata?this._fileMetadata:void 0),this._startTimes[e]=void 0}}))}reportOperationStart(e,t=!1){(Array.isArray(e)?e:[e]).forEach((e=>{if(void 0===this._startTimes[e]&&(this._startTimes[e]=T(),this._keyPrefix&&t)){const t=this._getKey(e,"start");this._record(t,0)}}))}reportUploadSubmit(){if(this._metadata?.submitted)return;this.setMetadata({submitted:!0});let e=S(this._startTimes[g.Full],T());if(this._keyPrefix&&void 0!==e){void 0!==this._pausedDuration[g.Full]&&(e-=this._pausedDuration[g.Full]);const t=this._getKey(g.Full,"submit");this._record(t,e,this._metadata)}}setMetadata(e){this._metadata={...this._metadata,...e}}setFileMetadata(e){this._fileMetadata={...this._fileMetadata,...e}}toggleOperationPaused(e,t){if(t&&void 0===this._pauseTimes[e])this._pauseTimes[e]=T();else if(!t){const t=S(this._pauseTimes[e],T());void 0!==t&&(this._pausedDuration[e]=this._pausedDuration[e]?this._pausedDuration[e]+t:t,this._pauseTimes[e]=void 0)}}_getKey(e,t){const s=this._eagerUploadDisabled&&w[e]||e;return`${this._keyPrefix}:${s}:${t}`}_record(e,t,s){const a={duration_ms:t,impression_id:this._impressionId,metadata:m(s)};l.IM(e,a,"media_upload")}_getStartTimes(){return this._startTimes}_resetStartTimes(e){this._startTimes={...e}}}},716233:(e,t,s)=>{"use strict";s.d(t,{BW:()=>g,SB:()=>I,TO:()=>v,Tz:()=>w,U$:()=>T,ff:()=>b,vC:()=>S,vn:()=>y,xz:()=>f,y$:()=>p});var a=s(182056),i=s(323265),r=s(540387);const o=1024,n=1024*o,d=1,l=4096,_=2048,c=400,u=1500,m={Image:5,Gif:15,Avatar_Gif:5},p={Duration:{0:140,1:600,2:7200},Size:{0:512,1:1024,2:40960}},h=600,g={GIF_IS_TOO_LARGE:1,VIDEO_IS_TOO_LARGE:2},b={VIDEO_IS_TOO_LONG:1},w={MEDIA_NOT_FOUND:0,INVALID_MEDIA_CODE:1},f=Object.freeze({AmplifyVideo:"amplify_video",CommunityBanner:"community_banner_image",ListBanner:"list_banner_image",TweetImage:"tweet_image",TweetVideo:"tweet_video",TweetGif:"tweet_gif",DMImage:"dm_image",DMVideo:"dm_video",DMGif:"dm_gif",Subtitles:"subtitles",ProfileBanner:"banner_image"}),S=Object.freeze({Tweet:"tweet",Dm:"dm",CommunityBanner:"community_banner",ListBanner:"list_banner",ProfileBanner:"profile_banner",Avatar:"avatar",Verification:"verification",TwitterArticle:"twitter_article"}),T=e=>{const{height:t,left:s,width:a}=e,i=Math.round(t/2);return`&salient_rect=${Math.round(s+a/2)},${i},1,1`};function I(e){const t=e.featureSwitches?.isTrue("blue_longer_video_enabled"),s=function(e){return e.userClaims.isTrueAndEnabled("subscriptions_long_video_upload")||e.featureSwitches.isTrue("subscriptions_long_video_upload_override")||!1}(e);return t||s?1:0}function y(e,t,s,g,b){const w=g?.location,f=I({featureSwitches:e,userClaims:t});let T,y;if(s.isSubtitles)T=0;else if(s.isGif)switch(w){case S.Avatar:T=e.getNumberValue("media_async_upload_max_avatar_gif_size",m.Avatar_Gif)*n;break;case S.Dm:case S.Tweet:default:T=e.getNumberValue("media_async_upload_max_gif_size",m.Gif)*n}else{if(!(s instanceof r.ZP))return function(e,t,s){let r;switch(t){case S.Avatar:r=c;break;case S.CommunityBanner:case S.ListBanner:case S.ProfileBanner:r=u;break;default:r=i.ZP.isDesktopOS()?l:_}const d=e.getNumberValue("media_async_upload_max_image_size",m.Image)*n;return a.Z.getConnectionInfo().then((a=>{let n=d;return"slow-2g"===a.effectiveType?n=e.getNumberValue("responsive_web_media_upload_limit_slow_2g",150)*o:s||"2g"===a.effectiveType?n=e.getNumberValue("responsive_web_media_upload_limit_2g",250)*o:"3g"===a.effectiveType?n=e.getNumberValue("responsive_web_media_upload_limit_3g",1500)*o:"4g"!==a.effectiveType||i.ZP.isDesktopOS()||t!==S.Tweet||(r=l),{maxDimension:r,maxFileSize:Math.min(d,n)}}),(()=>({maxDimension:r,maxFileSize:d})))}(e,w,b);if(1===f){if("dm"===w)y=e.getNumberValue("media_async_upload_longer_dm_video_max_video_duration",h);else y=e.getNumberValue("media_async_upload_longer_video_max_video_duration",p.Duration[f])*d;T=e.getNumberValue("media_async_upload_longer_video_max_video_size",p.Size[f])*n}else y=e.getNumberValue("media_async_upload_max_video_duration",p.Duration[f])*d,T=e.getNumberValue("media_async_upload_max_video_size",p.Size[f])*n}return Promise.resolve({maxFileSize:T,maxDuration:y})}function v(e){return!(i.ZP.isIOS()&&e.size>3e8)}},397159:(e,t,s)=>{"use strict";s.d(t,{B2:()=>m,Fi:()=>c,fQ:()=>p,iS:()=>_,uk:()=>u});s(136728),s(574858),s(543673),s(240753),s(128399);var a=s(468811),i=s.n(a),r=s(111677),o=s.n(r),n=s(187268);const d=o().c3f04d9c,l=o().cbdddb0a,_={HEADER:"header",ASSISTANT:"assistant",DECISION:"decision",RAW_FUNCTION_RESULT:"raw_function_result",FUNCTION:"function",SUMMARY:"summary",FINAL:"final",SOFT_STOP:"softstop",FINAL_LONG:"final_long"},c={IN_PROGRESS:"IN_PROGRESS",COMPLETED:"COMPLETED",FAILED:"FAILED"},u={GenericSearchQueryFormatter:o().ie2bbeed,GenericSearchQueryMarkdownFormatter:o().b0d1e205,WebSearchQueryFormatter:o().ie2bbeed,XSearchQueryFormatter:o().bf970edd,XUserSearchFormatter:o().ad342369,BrowsePageFormatter:o().g008d475,GenericURLQueryFormatter:o().c91e3971,GenericURLQueryMarkdownFormatter:o().acb9b845,XUsernameSearchFormatter:o().j9006405,XUsernameQuerySearchFormatter:o().a2dd07e5,XUsernameQuerySearchMarkdownFormatter:o().e99fb7a3,CodeExecutionFormatter:o().a02d1657},m={WebSearchQueryFormatter:o().aa9d42c0,XSearchQueryFormatter:o().c731d702,XUserSearchFormatter:o().d0e02476,BrowsePageFormatter:o().c43ef93e,XUsernameSearchFormatter:o().dab166ec,XUsernameQuerySearchFormatter:o().dab166ec,CodeExecutionFormatter:o().jb097f6e};class p{constructor(e){this.initiateFromHistoryResponses=(e,t=!1)=>{this.lastStreamedDataTimestamp=Date.now();const s={};for(const t of e)for(let e=0;e<t.steps.length;e++){const a=t.steps[e];for(const e of a.toolUsageCardResults||[])s[e.toolUsageCardId]=e}for(const t of e){const e={id:i().v4(),state:c.COMPLETED,header:t.header||d,subSteps:[]};for(let a=0;a<t.steps.length;a++){const i=t.steps[a];this.addWebResults(i.webResults||[]),this.addXPostIds(i.xPostIds||[]);let r=0;if(i.assistant&&(this.accumulatedTrace+=i.assistant,this.traceEnabled=!0),i.summary){const t=(0,n.Ez)(i.summary);this.accumulatedSummary+=t;const o=[];i.toolUsageCardResults?.forEach((e=>{s[e.toolUsageCardId]&&(o.push(s[e.toolUsageCardId]),delete s[e.toolUsageCardId])})),e.subSteps.push({messageStepId:a+r,messageTag:_.SUMMARY,summary:t,webResults:i.webResults,xPostIds:i.xPostIds,toolUsageCardResults:o}),r++}if(i.decision){const t=this.parseMessageJSON(i.decision),{markdown:s,text:o}=this.getContentForDecisionAction(t);e.subSteps.push({messageStepId:a+r,messageTag:_.DECISION,actionIcon:this.getIconForDecisionAction(t),actionType:t?.action,actionMarkdownSummary:s,actionSummary:o,actionWebResult:this.webResults.find((e=>e.url===t?.action_input?.url)),actionState:"COMPLETED",webResults:i.webResults,xPostIds:i.xPostIds}),r++}}this.steps.push(e)}t||(this.isPastSummary=!0,this.state="COMPLETED")},this.addDebugMessageTagCount=e=>{e&&(this.debugMessageTagCount[e]||(this.debugMessageTagCount[e]=0),this.debugMessageTagCount[e]++,this.debugMessageTagCount={...this.debugMessageTagCount})},this.updateStepsFromRawMessage=e=>{e.messageTag&&(e.messageTag=e.messageTag.toLowerCase());const t=this.steps.length-1,s=e.messageTag===_.HEADER,a=s||this.steps.length<=0;if(this.addDebugMessageTagCount(e.messageTag),this.lastStreamedDataTimestamp=Date.now(),"PENDING"===this.state&&(this.streamStartTimestamp=Date.now(),this.state="STARTED"),a){const a={id:i().v4(),state:"COMPLETED"===this.state?c.COMPLETED:c.IN_PROGRESS,header:s?e.message:d,subSteps:[],isThinkingStep:0===this.steps.length&&!s};if(s){if(1===this.steps.length&&this.steps[0].header===d)return void(this.steps=[{...this.steps[0],header:a.header,isThinkingStep:!1}]);this.steps=[...this.steps,a]}else e.messageTag===_.ASSISTANT&&(this.accumulatedTrace+=e.message,this.traceEnabled=!0,this.steps=[...this.steps,a]);return void(t>=0&&this.completeStep(t))}const r=this.steps[t],o=r.subSteps.findLastIndex((t=>{const s=t.messageStepId===e.messageStepId,a=t.messageTag===e.messageTag;if(e.messageTag===_.RAW_FUNCTION_RESULT){const e=t.messageTag===_.DECISION;return s&&(a||e)}if(e.toolUsageCardId){const s=t.orderedContentToPreview?.some((t=>t.toolUsageCard?.id===e.toolUsageCardId));return s}return s&&a})),l=o>-1?r.subSteps[o]:void 0;let u=!1;if(l){switch(e.messageTag){case _.ASSISTANT:this.accumulatedTrace+=e.message,this.traceEnabled=!0;break;case _.SUMMARY:{const t=(0,n.Ez)(e.message);this.accumulatedSummary+=t,l.summary=(l.summary||"")+t;const s=(0,n.QK)(e.message);if(s){const t=(0,n.jU)(s);t&&(l.orderedContentToPreview=[...l.orderedContentToPreview||[],{header:t,type:"TOOL_USAGE",toolUsageCard:s}]),l.toolUsageCardResults=[...l.toolUsageCardResults||[],{toolUsageCardId:s.id,webResults:e.webResults,xPostIds:e.xPostIds}]}else{const t=h(e.message);if(t.trim()&&(l.orderedContentToPreview=[...l.orderedContentToPreview||[],{header:r.header,summary:t,type:"SUMMARY"}]),e.webResults&&e.webResults.length||e.xPostIds&&e.xPostIds.length){if(this.addWebResults(e.webResults||[]),this.addXPostIds(e.xPostIds||[]),e.toolUsageCardId){const t=l.toolUsageCardResults?.map((t=>t.toolUsageCardId===e.toolUsageCardId?{...t,webResults:e.webResults,xPostIds:e.xPostIds}:t));l.toolUsageCardResults=t}const t=l.orderedContentToPreview?.find((t=>t.toolUsageCard?.id===e.toolUsageCardId));t&&(l.orderedContentToPreview=[...l.orderedContentToPreview||[],{header:t.header,type:"TOOL_USAGE_RESULT",toolUsageCard:t.toolUsageCard,toolUsageCardResult:{toolUsageCardId:t.toolUsageCard?.id||"",webResults:e.webResults,xPostIds:e.xPostIds}}])}}u=!0;break}case _.DECISION:{const t=this.parseMessageJSON(e.message),{markdown:s,text:a}=this.getContentForDecisionAction(t);l.actionIcon=this.getIconForDecisionAction(t),l.actionType=t?.action,l.actionSummary=a,l.actionMarkdownSummary=s,u=!0;break}case _.RAW_FUNCTION_RESULT:if(!(e.webResults&&e.webResults.length||e.xPostIds&&e.xPostIds.length))break;e.webResults&&(l.webResults=e.webResults,this.addWebResults(e.webResults||[])),e.xPostIds&&(l.xPostIds=e.xPostIds,this.addXPostIds(e.xPostIds||[])),l.actionState,u=!0}u&&(r.subSteps[o]={...l},r.subSteps=[...r.subSteps])}else{let t=null;switch(e.messageTag){case _.ASSISTANT:this.accumulatedTrace+=e.message,this.traceEnabled=!0;break;case _.SUMMARY:{const s=(0,n.QK)(e.message)??void 0,a=(0,n.Ez)(e.message);this.accumulatedSummary+=a;let i=[];if(s){const e=(0,n.jU)(s);e&&(i=[{header:e,toolUsageCard:s,type:"TOOL_USAGE"}])}else{const t=h(e.message);t.trim()&&(i=[{header:r.header,summary:t,type:"SUMMARY"}])}t={messageStepId:e.messageStepId,messageTag:e.messageTag,summary:a,toolUsageCardResults:s?[{toolUsageCardId:s.id,webResults:e.webResults,xPostIds:e.xPostIds}]:[],orderedContentToPreview:i};break}case _.DECISION:{const s=this.parseMessageJSON(e.message),{markdown:a,text:i}=this.getContentForDecisionAction(s);t={messageStepId:e.messageStepId,messageTag:e.messageTag,actionIcon:this.getIconForDecisionAction(s),actionType:s?.action,actionSummary:i,actionMarkdownSummary:a,actionWebResult:this.webResults.find((e=>e.url===s?.action_input?.url)),actionState:"STARTED"};break}case _.RAW_FUNCTION_RESULT:{const s=e.webResults||[];this.addWebResults(s);const a=e.xPostIds||[];this.addXPostIds(a),(s.length>0||a.length>0)&&(t={messageStepId:e.messageStepId,messageTag:e.messageTag,webResults:e.webResults,xPostIds:e.xPostIds});break}}if(t){const e=[...r.subSteps];for(const t of e)t.actionState="COMPLETED";r.subSteps=[...e,t],r.subSteps=this.sortSubstepsByStepIdMessageTag(r.subSteps),this.steps=[...this.steps]}}this.steps[t]={...this.steps[t]}},this.sortSubstepsByStepIdMessageTag=e=>{const t=[_.SUMMARY,_.DECISION,_.RAW_FUNCTION_RESULT];return e.sort(((e,s)=>e.messageStepId!==s.messageStepId?e.messageStepId-s.messageStepId:t.indexOf(e.messageTag)-t.indexOf(s.messageTag)))},this.completeStep=e=>{this.steps[e].state=c.COMPLETED},this.parseMessageJSON=e=>{try{return JSON.parse(e)}catch(e){return null}},this.getContentForDecisionAction=e=>{if(!e)return{text:"",markdown:""};if(e.action_input?.username){if(e.action_input?.query)return{text:u.XUsernameQuerySearchFormatter({username:e.action_input?.username,query:e.action_input?.query}),markdown:u.XUsernameQuerySearchMarkdownFormatter({username:e.action_input?.username,query:e.action_input?.query})};const t=u.XUsernameSearchFormatter({username:e.action_input?.username});return{text:t,markdown:t}}if(e.action_input?.query){if(e.action_input?.url){let t=e.action_input?.url;"x.com"===t&&(t="https://x.com");let s="",a="";try{s=new URL(t).hostname,s.startsWith("www.")&&(s=s.replace("www.","")),a=`[${s}](${t})`}catch(e){a=t}return{text:u.GenericURLQueryFormatter({url:s,query:e.action_input?.query}),markdown:u.GenericURLQueryMarkdownFormatter({url:a,query:e.action_input?.query})}}return{text:u.GenericSearchQueryFormatter({query:e.action_input?.query}),markdown:u.GenericSearchQueryMarkdownFormatter({query:e.action_input?.query})}}return{text:"",markdown:""}},this.getIconForDecisionAction=e=>{if(!e)return"IconSearchStroke";switch(e.action){case"web_search":default:return"IconSearchStroke";case"x_search":case"x_user_timeline":case"fetch_x_post_context":return"IconTwitter";case"browse_page":return"IconGlobeStroke"}},this.complete=(e=!0)=>{"COMPLETED"!==this.state&&(this.streamCompletedTimestamp=Date.now(),this.state="COMPLETED",this.steps.forEach((e=>{e.state=c.COMPLETED,e.subSteps.forEach((e=>{e.actionState="COMPLETED"}))})),e&&this.steps.push({id:i().v4(),state:c.COMPLETED,header:l,subSteps:[],isCompleteHeader:!0}),this.steps=[...this.steps])},this.onAbort=()=>{for(let e=0;e<this.steps.length;e++)this.steps[e].state===c.IN_PROGRESS&&(this.steps[e].state=c.FAILED),this.steps[e].subSteps.forEach((e=>{e.actionState="COMPLETED"}));this.steps=[...this.steps],this.state="ABORTED"},this.getNumSources=()=>this.webResults.length+this.xPostIds.length,this.addWebResults=e=>{this.webResults=[...this.webResults,...e].filter(((e,t,s)=>t===s.findIndex((t=>t.url===e.url))))},this.addXPostIds=e=>{this.xPostIds=[...this.xPostIds,...e].filter(((e,t,s)=>t===s.findIndex((t=>t===e))))},this.getStreamDuration=()=>this.streamStartTimestamp?this.streamCompletedTimestamp?this.streamCompletedTimestamp-this.streamStartTimestamp:Date.now()-Number(this.streamStartTimestamp):-1,this.updateFinalAnswer=({message:e,messageTag:t})=>{this.defaultFinalAnswer+=e,this.addDebugMessageTagCount(t)},this.steps=[],this.state="PENDING",this.streamStartTimestamp=null,this.streamCompletedTimestamp=null,this.accumulatedTrace="",this.accumulatedSummary="",this.traceEnabled=!1,this.webResults=[],this.xPostIds=[],this.showLongFinalAnswer=!1,this.defaultFinalAnswer="",this.debugMessageTagCount={},this.lastStreamedDataTimestamp=null,this.deepsearchArgs=e?.deepsearchArgs||null,this.isDeepsearch=e?.isDeepsearch??!1}}function h(e){let t=e;return t=t.replace(/^(?:[-*]\s+)/,""),t=t.split("\n")[0],t}},988566:(e,t,s)=>{"use strict";s.d(t,{D$:()=>n,Du:()=>_,GK:()=>l,Iv:()=>u,pz:()=>m,rl:()=>c});var a=s(202784),i=s(688715),r=s(946409),o=s(788993);const n=(e,t,s)=>e.retweeted_status?d(e,t):e.community_id_str&&s?l(e,s):void 0,d=(e,t)=>{if(e.retweeted_status)return{contextType:o.Z.Retweet,isSelfRetweet:e.user.id_str===t,name:e.user.name,screenName:e.user.screen_name}},l=(e,t)=>({contextType:o.Z.Community,landingUrl:{url:(0,i.ju)(`https://x.com/i/communities/${t.id_str}`),urlType:"ExternalUrl"},text:t.name}),_=({isCellWithProminentSocialContext:e,socialContext:t,topic:s})=>{if(t?.topicContext){const a=t.topicContext;return{contextType:e?o.Z.TextOnly:o.Z.Topic,landingUrl:{url:`twitter://topics_timeline?id=${a.topicId}`,urlType:"DeepLink"},text:s?.name,topicContext:a}}if(t?.generalContext)return{...t.generalContext}},c=e=>{const{contextType:t,landingUrl:s,text:a}=e;return{link:s?(0,r.s9)(s):void 0,text:a,contextType:t}},u={contextType:o.Z.Pin,text:""},m=a.createContext(void 0)},946208:(e,t,s)=>{"use strict";s.d(t,{Id:()=>a,ZP:()=>o,h_:()=>i});s(543673),s(240753),s(128399);const a=[".srt","text/plain",""],i=e=>-1!==a.indexOf(e.type),r=e=>`WEBVTT FILE\r\n\r\n${e.replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/\r\n\{\\an8\}/g," line:5%\r\n")}`;class o{constructor(e){this.fileHandle=new Blob([e],{type:"text/plain charset=UTF-8"}),e instanceof File&&(this.name=e.name),this.size=e.size,this.type=this.fileHandle.type,this.url=window.URL.createObjectURL(this.fileHandle),this.fileHandle.text&&this.fileHandle.text().then((e=>{this.vtt=URL.createObjectURL(new Blob([r(e)],{type:"text/plain charset=UTF-8"}))})),this.isVideo=!1,this.isImage=!1,this.isGif=!1,this.isSubtitles=!0}dispose(){this.url&&window.URL.revokeObjectURL(this.url)&&window.URL.revokeObjectURL(this.vtt)}}},540387:(e,t,s)=>{"use strict";s.d(t,{Wv:()=>i,ZP:()=>o,hb:()=>r,jn:()=>a});s(571372),s(543673),s(240753),s(128399);const a=["video/mp4","video/quicktime"],i=e=>-1!==a.indexOf(e.type),r={type:"video-load",NO_DIMENSIONS:10,LOAD_FAILED:11,TOO_LARGE:12};class o{constructor(e,t){this.fileHandle=e,e instanceof File&&(this.name=e.name),this.size=e.size,this.type=e.type;try{this.url=window.URL.createObjectURL(this.fileHandle)}catch(e){this.url=""}this.isVideo=!0,this.isImage=!1,this.isGif=!1,this.isSubtitles=!1,this.isAmplify=!!t}withDimensionsAndOrientation(e){return((e,t)=>new Promise(((s,a)=>{const i=(e,t)=>{const s=new Error(e);s.code=t,s.type=r.type,a(s)},o=document.createElement("video");o.onloadedmetadata=()=>{t||o.videoWidth&&o.videoHeight?s(o):i("Video lacks height or width",r.NO_DIMENSIONS)},o.onerror=()=>{i("Error loading image",r.LOAD_FAILED)},o.src=e})))(this.url,e).then((e=>{const{duration:t,videoHeight:s,videoWidth:a}=e;return this.width=a,this.height=s,this.duration=t,this.video=e,this.isBrowserSupported=!(0===s||0===a),this}))}dispose(){this.url&&window.URL.revokeObjectURL(this.url)}}}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/bundle.GrokDrawer-9f4db315.744e748a.js.map