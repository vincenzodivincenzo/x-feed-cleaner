"use strict";(self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["bundle.Grok-7a6ce5c4"],{986274:(e,t,n)=>{n.d(t,{E:()=>i});var a=n(202784),r=n(325686),o=n(731708),s=n(392237);const i=({performanceMetrics:e,userChatItemId:t})=>{const[n,s]=a.useState(void 0),{timeToCompletion:i,timeToFirstChunkMs:c,timeToFirstTextMs:d,traceId:m}=e;return void 0===n?a.createElement(r.Z,{style:l.container},d?a.createElement(o.ZP,{onClick:()=>s(!0),style:l.showDebugLink},(d/1e3).toString(),"s"):a.createElement(o.ZP,{onClick:()=>s(!1),style:l.showDebugLink},"Debug")):!1===n?null:a.createElement(r.Z,{style:l.container},a.createElement(o.ZP,{style:l.text},"Debug / Performance"),m?a.createElement(o.ZP,{style:l.text},"Trace ID: ",m):null,t?a.createElement(o.ZP,{style:l.text},"Item ID: ",t):null,c?a.createElement(o.ZP,{style:l.text},"Time to first chunk: ",(c/1e3).toString(),"s"):null,d?a.createElement(o.ZP,{style:l.text},"Time to first text: ",(d/1e3).toString(),"s"):null,i?a.createElement(o.ZP,{style:l.text},"Time to completion: ",(i/1e3).toString(),"s"):null,a.createElement(o.ZP,{onClick:()=>s(!1),style:l.showDebugLink},"hide this"))},l=s.default.create((e=>({container:{marginStart:e.spaces.space8,alignItems:"flex-start",justifyContent:"flex-start"},text:{color:e.colors.gray700,fontSize:e.fontSizes.subtext1},showDebugLink:{cursor:"pointer",width:"fit-content",color:e.colors.gray700,fontSize:e.fontSizes.subtext1,borderBottomColor:e.colors.gray100,borderBottomStyle:"dotted",borderBottomWidth:e.spaces.space1}})))},799027:(e,t,n)=>{n.d(t,{i:()=>$,Z:()=>K});var a=n(207274),r=n(822343),o=n(202784),s=n(325686),i=n(10622),l=n.n(i),c=(n(585488),n(437429)),d=n.n(c),m=n(525271),u=n(731708),p=n(154003),g=n(392237),h=n(111677),f=n.n(h),y=n(306677),b=n(725516),x=n(623494),w=n(970205),v=n(988290),E=(n(136728),n(107267)),k=n(370006),C=n(530732),Z=n(530243),I=n(207683);const _=f().d9d36880,S=f().g9677c6e;function T({analytics:e,memoryConversation:t,onBack:n,onForget:a}){const r=(0,E.useHistory)(),[i,l]=o.useState(!1),c=o.useCallback((()=>{l(!0)}),[]);return o.createElement(s.Z,{style:R.container},o.createElement(s.Z,{style:R.headerContainer},o.createElement(s.Z,{style:R.leftHeaderContainer},o.createElement(k.Z,{onClick:n}),o.createElement(C.Z,{onClick:()=>{(0,x.qQ)(e,t.conversation_id),r.push(`/i/grok?conversation=${t.conversation_id}`)},style:R.conversationTitleContainer,withoutInteractiveStyles:!0},(({isHovered:e})=>o.createElement(s.Z,{style:[R.conversationTitleContainer,e?R.hoveredConversationTitleContainer:void 0]},o.createElement(s.Z,{style:R.conversationTitle},o.createElement(u.ZP,{numberOfLines:1,size:"headline2"},t.conversation_title)),o.createElement(s.Z,{style:R.goToIconContainer},o.createElement(Z.default,{style:R.goToIcon})))))),o.createElement(p.ZP,{backgroundColor:"gray50",borderColor:"transparent",fontWeight:"normal",hoverLabel:{label:i?S:_},onClick:i?a:c,type:i?"destructiveFilled":void 0},i?S:_)),!!t.conversation_summary&&o.createElement(u.ZP,{size:"body",style:R.summary,weight:"normal"},o.createElement(I.GrokMarkdown,{isAnimated:!1,markdownText:t.conversation_summary})))}const R=g.default.create((e=>({container:{paddingHorizontal:e.spaces.space12,animationDuration:"0.3s",animationTimingFunction:"ease",animationKeyframes:[{"0%":{opacity:0,transform:"translateX(30px)"},"100%":{opacity:1,transform:"translateX(0px)"}}],animationFillMode:"both"},headerContainer:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:e.spaces.space20},leftHeaderContainer:{flex:1,display:"flex",flexDirection:"row",alignItems:"center",gap:e.spaces.space8},conversationTitleContainer:{maxWidth:"100%",flexGrow:0,flexShrink:1,display:"flex",flexDirection:"row",alignItems:"center",borderBottomWidth:1,borderColor:"transparent",borderStyle:"solid",transition:"border-color 0.2s ease",cursor:"pointer",gap:e.spaces.space4},conversationTitle:{maxWidth:"100%",textOverflow:"ellipsis",overflow:"hidden",flexGrow:0,flexShrink:1},hoveredConversationTitleContainer:{borderColor:e.colors.brandColor},goToIconContainer:{width:e.spaces.space16,height:e.spaces.space16},goToIcon:{width:"100%",height:"100%",transform:[{scaleX:-1}]},summary:{marginTop:e.spaces.space16,width:"100%"}})));var P=n(757483),D=n(215337),M=n(207137);const L=f().g02dacc0,z=f().c6e845c0,A=[f().a5fa4a86,f().c51724a4,f().j244ceb2,f().b22b12e0,f().h3023cac,f().b10dbffa,f().c81da1b6,f().d4e4d3ce,f().c3418f9a,f().b64dada6,f().ad24ec20,f().c7902252];function H({memoryConversation:e,onClick:t,style:n}){const a=g.default.theme.colors.navigationBackground,r=o.useCallback((()=>[P.Z.hexToCss(a,0),P.Z.hexToCss(a,.8),P.Z.hexToCss(a,1)]),[a]),i=o.useMemo((()=>{if(!e.updated_at_sec)return"";const t=new Date(1e3*e.updated_at_sec);if((0,M.zk)(t))return L;if((0,M.gO)(t))return z;return`${A[t.getMonth()]} ${t.getDate()}`}),[e.updated_at_sec]);return o.createElement(C.Z,{onClick:t,withoutInteractiveStyles:!0},(({isHovered:t})=>o.createElement(s.Z,{style:[B.outerContainer,t?B.outerHoveredContainer:void 0,n]},o.createElement(s.Z,{style:B.container},o.createElement(s.Z,{style:B.contentContainer},o.createElement(s.Z,{style:B.headerContainer},!!e.conversation_title&&o.createElement(s.Z,{style:B.conversationTitleContainer},o.createElement(u.ZP,{numberOfLines:1,style:B.conversationTitle},e.conversation_title)),!!i&&o.createElement(s.Z,null,o.createElement(u.ZP,{numberOfLines:1,style:B.date},i))),!!e.conversation_summary&&o.createElement(s.Z,{style:B.summaryContainer},o.createElement(u.ZP,{size:"subtext2",weight:"normal"},o.createElement(I.GrokMarkdown,{isAnimated:!1,markdownText:e.conversation_summary}))))),o.createElement(D.Z,{colors:r(),style:[B.traceGradientBottom,t?{height:"40%"}:void 0]}))))}const B=g.default.create((e=>({outerContainer:{backgroundColor:"transparent",transition:"background-color 0.2s ease",width:"100%",cursor:"pointer",borderRadius:e.borderRadii.medium,position:"relative"},outerHoveredContainer:{backgroundColor:e.colors.gray0},container:{padding:e.spaces.space12},contentContainer:{display:"flex",flexDirection:"column",gap:e.spaces.space8,flexShrink:1},headerContainer:{width:"100%",maxWidth:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:e.spaces.space8},conversationTitleContainer:{maxWidth:"100%",textOverflow:"ellipsis",overflow:"hidden",flexGrow:0,flexShrink:1},conversationTitle:{},date:{fontSize:e.fontSizes.subtext1,color:e.colors.gray800},summaryContainer:{maxHeight:80,overflow:"hidden"},traceGradientBottom:{position:"absolute",width:"100%",height:"30%",transition:"height 0.2s ease",start:0,bottom:0,borderBottomStartRadius:e.borderRadii.medium,borderBottomEndRadius:e.borderRadii.medium}}))),$=f().d700b268,O=f().cd7bdab2,F=f().f21b84de,W=f().gf5e9ea6,G=3e3,U=f().i52a9cb8,N=r.Z,j=a.Z;function K({memoryReferences:e,onDrawerDismiss:t}){const{isCompactLayout:n,isGrokDrawer:a}=(0,v.ZP)(),r=n&&!a,i=(0,b.z)(),c=d()(),g=o.useRef(null),[h,f]=o.useState(!0),[E,k]=o.useState([]),[C,Z]=o.useState(!1),[I,_]=o.useState(null),[S,R]=o.useState(null);o.useEffect((()=>{l()(c,N,{conversation_ids:e.map((e=>e.conversation_id))}).toPromise().then((e=>{k(e?.get_grok_memory_related_conversations?.related_conversations||[]),f(!1)})).catch((()=>{k([]),f(!1)}))}),[c,e]);const P=o.useCallback((()=>{(0,x.NH)(i)}),[i]),D=o.useCallback((e=>{const t={idx:e,memory:E[e]},n=t.memory.conversation_id;R(t),k([...E.slice(0,e),...E.slice(e+1)]),_(null),Z(!0),g.current=setTimeout((()=>{Z(!1),l()(c,j,{conversation_ids:[n]}).toPromise().then((()=>{R(null)})).catch((e=>{(0,x.zX)(i,n,e.message)}))}),G),(0,x.UV)(i,n)}),[E,c,i]),M=o.useCallback((()=>{S&&(Z(!1),clearTimeout(g.current),k([...E.slice(0,S.idx),S.memory,...E.slice(S.idx)]))}),[S,E]);return o.createElement(m.Z,{align:"right",buttonType:"primaryText",onDismissed:t,style:V.drawer,subtitle:O,title:$},o.createElement(s.Z,{style:[V.container,r?V.compactContainer:void 0]},o.createElement(y.D,{id:"grok_memory_drawer",onFullyVisible:P,position:"top",testID:"grok_memory_drawer"}),null!==I?o.createElement(T,{analytics:i,memoryConversation:E[I],onBack:()=>_(null),onForget:()=>D(I)}):o.createElement(s.Z,{style:V.memoriesPreviewContainer},h?o.createElement(s.Z,{style:V.spinnerContainer},o.createElement(w.Z,null)):E.length>0?E.map(((e,t)=>o.createElement(H,{key:`${e.conversation_id}-${e.conversation_title?.length||""}-${e.conversation_summary?.length||""}`,memoryConversation:e,onClick:()=>{_(t),(0,x.zC)(i,E[t].conversation_id)},style:[V.memoryCard,{animationDelay:.02*t+"s"}]}))):o.createElement(u.ZP,{style:V.noMemoriesLabel},U))),C&&o.createElement(s.Z,{style:V.undoToastContainer},o.createElement(s.Z,{style:[V.undoToast,{animationDuration:(G-500)/1e3+"s"}]},o.createElement(u.ZP,null,F),o.createElement(p.ZP,{backgroundColor:"transparent",borderColor:"gray200",onClick:M,size:"small"},W))))}const V=g.default.create((e=>({drawer:{paddingTop:e.spaces.space16,position:"relative"},container:{height:"100%",padding:e.spaces.space16,width:500},compactContainer:{width:"100%"},memoriesPreviewContainer:{width:"100%",display:"flex",flexDirection:"column",gap:e.spaces.space16},spinnerContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},pageSelector:{marginVertical:e.spaces.space12},memoryCard:{flex:1,animationDuration:"0.3s",animationTimingFunction:"ease",animationKeyframes:[{"0%":{opacity:0,transform:"translateX(-30px)"},"100%":{opacity:1,transform:"translateX(0px)"}}],animationFillMode:"both"},undoToastContainer:{position:"fixed",bottom:e.spaces.space16,width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},undoToast:{display:"flex",flexDirection:"row",alignItems:"center",gap:e.spaces.space16,padding:e.spaces.space16,backgroundColor:e.colors.gray50,borderRadius:e.borderRadii.medium,animationTimingFunction:"ease",animationKeyframes:[{"0%":{opacity:0,transform:"translateY(10px)"},"10%":{opacity:1,transform:"translateY(0px)"},"90%":{opacity:1,transform:"translateY(0px)"},"100%":{opacity:0,transform:"translateY(10px)"}}],animationFillMode:"both"},noMemoriesLabel:{marginHorizontal:e.spaces.space4}})))},674756:(e,t,n)=>{n.d(t,{R:()=>k});n(136728);var a=n(202784),r=n(325686),o=n(392237),s=n(111677),i=n.n(s),l=n(166852),c=n(916559),d=n(520595),m=n(154003),u=n(642153),p=n(731708);const g=({images:e,label:t,onClick:n,withAnimation:o})=>a.createElement(m.ZP,{backgroundColor:"transparent",borderColor:"gray200",hoverLabel:{label:t},onClick:n,style:[h.button,o?h.animation:void 0]},a.createElement(r.Z,{style:h.container},e.length>0?a.createElement(u.Z,{userAvatarSize:"medium",userAvatarUrls:e.slice(0,3),withIncreasedSpacing:e.length<2}):null,a.createElement(p.ZP,{color:"gray900",size:"subtext1",weight:"normal"},t))),h=o.default.create((e=>({button:{display:"flex",paddingStart:e.spaces.space12,paddingEnd:e.spaces.space12},container:{display:"flex",flexDirection:"row",alignItems:"center",gap:e.spaces.space8},animation:{opacity:1,animationDuration:"0.2s",animationKeyframes:[{"0%":{opacity:0},"100%":{opacity:1}}]}})));var f=n(24949),y=(n(353644),n(125363)),b=n(836255),x=n(464023);n(263160);o.default.create((e=>({container:{width:"100%",flex:1,maxHeight:"50%",padding:e.spaces.space16,justifyContent:"center",alignItems:"flex-start",borderRadius:e.borderRadii.large,overflow:"hidden",cursor:"pointer",gap:e.spaces.space8,backgroundColor:e.colors.gray50,transition:"background-color 0.5s"},hovered:{backgroundColor:"light"===e.paletteName?e.colors.gray300:e.colors.gray200}}))),i().a3186bff,i().f9b2d343,o.default.create((e=>({container:{width:"100%",flexDirection:"row",maxWidth:x.vf,paddingHorizontal:e.spaces.space8,marginTop:e.spaces.space16,position:"relative",gap:e.spaces.space8},containerMobile:{zoom:.85,paddingHorizontal:e.spaces.space16},carouselWrapper:{backgroundColor:e.colors.gray0,borderRadius:e.borderRadii.large,overflow:"hidden",position:"relative",flex:3},tweets:{width:"100%",position:"relative"},tweet:{marginEnd:0,width:"100%"},seeAllButton:{flex:1,width:120,minWidth:120,gap:e.spaces.space8,height:"100%"}})));function w({postIds:e}){const t=a.useMemo((()=>(0,f.P1)([e=>e,(e,t)=>t],((e,t)=>{const n=t.map((e=>b.Z.createHydratorForTweet(e))).map((t=>t(e)));return(0,l.Z)(n.filter(Boolean).map((e=>e?.user?.profile_image_url_https)).filter(Boolean))}))),[]);return(0,y.v9)((n=>t(n,e)))}const v=i().a3186bff,E=i().f9b2d343,k=a.memo((({isAnimated:e,postIds:t,webResults:n})=>{const[o,s]=a.useState(!1),[i,m]=a.useState(!1),u=a.useCallback((()=>{s(!0)}),[]),p=a.useCallback((()=>{s(!1)}),[]),h=a.useCallback((()=>{m(!0)}),[]),f=a.useCallback((()=>{m(!1)}),[]),y=w({postIds:t}),b=a.useMemo((()=>(0,l.Z)(n.map((e=>e.favicon_base64||e.favicon)).filter(Boolean))),[n]),x=a.useRef([]),k="postIds",Z="webResults";return t.length>0&&!x.current.includes(k)&&x.current.push(k),n.length>0&&!x.current.includes(Z)&&x.current.push(Z),a.createElement(a.Fragment,null,a.createElement(r.Z,{style:C.container},x.current.map((r=>r===k?a.createElement(g,{images:y,key:"post_ids_button",label:E({count:t.length}),onClick:u,withAnimation:e}):r===Z?a.createElement(g,{images:b,key:"web_results_button",label:v({count:n.length}),onClick:h,withAnimation:e}):void 0))),o?a.createElement(d.a,{onDrawerDismiss:p,paginationOptions:{numResultsPerPage:50},postIds:t}):null,i?a.createElement(c.E,{onDrawerDismiss:f,paginationOptions:{numResultsPerPage:50},webResults:n}):null)})),C=o.default.create((e=>({container:{flexDirection:"row",gap:e.spaces.space8,justifyContent:"flex-start",alignItems:"stretch",flexWrap:"wrap"}})))},617568:(e,t,n)=>{n.d(t,{w:()=>y});n(136728),n(901951);var a=n(202784),r=n(719870),o=n(325686),s=n(731708),i=n(392237),l=n(187669),c=n(33474),d=n(342430),m=n(230606),u=n(978921),p=n(122670);function g({children:e,token:t}){if(e&&e.length)return a.createElement(s.ZP,{color:"gray900",size:"subtext2",style:b.text},e);const n=t.text?.replace(new RegExp("<br>","g"),"\n")??"";return a.createElement(s.ZP,{color:"gray900",size:"subtext2",style:b.text},n)}function h({token:e}){const t=a.useMemo((()=>{const t=[];return e.tokens?.length&&e.tokens.forEach(((e,n)=>{const r=`${n}`;t.push(a.createElement(h,{key:r,token:e}))})),t}),[e.tokens]);switch(e.type){case"link":return a.createElement(m.Z,{token:e});case"heading":return a.createElement(c.X,{token:e},t);case"strong":return a.createElement(s.ZP,{color:"gray900",size:"subtext2",weight:"bold"},a.createElement(g,{token:e},t));case"blockLatex":return a.createElement(d.Z,{content:e.text,isBlock:!0});case"inlineLatex":return a.createElement(d.Z,{content:e.text});default:return a.createElement(g,{token:e},t)}}function f({blockSizes:e,index:t,last:n,setBlockHeight:s,text:i}){const[l,c]=a.useState(-1),d=a.useCallback((({nativeEvent:e})=>{const n=e.layout.height;n!==l&&(c(n),s(t,n))}),[t,c,s,l]),m=a.useMemo((()=>{let n=0;for(let a=0;a<t;a++)n+=e[a]||0,n+=10;return n}),[t,e]),u=a.useMemo((()=>{return r.TU.lexer((e=i,/^\s*[-*+]\s+/.test(e)?e.replace(/^(\s*)[-*+]\s+/,"$1• "):/^\s*\d+.\s+/.test(e)?e.replace(/^(\s*)(\d+).\s+/,"$1$2 "):e)).map(((e,t)=>a.createElement(h,{key:`parsedToken-${t}`,token:e})));var e}),[i]);return a.createElement(o.Z,{onLayout:d,style:{width:"100%",top:m,position:"absolute",opacity:l>=0?1:.1}},u)}function y({charLimit:e,height:t,text:n}){const r=a.useRef(0);(0,l.q)((()=>{r.current=Math.max(0,n.split("\n\n").length-4)}));const s=a.createRef(),[i,c]=a.useState([]),d=a.useRef({curr:0,currSmoothed:0,target:0,alpha:.01,beta:0,velocity:0,lastTimestamp:0}),[m,u]=a.useState(t||0),p=a.useCallback((({nativeEvent:e})=>{const n=t||e.layout.height;u(n),d.current.currSmoothed||(d.current.currSmoothed=.5*n)}),[u,t]),g=a.useCallback(((e,t)=>{c((n=>{const a=[...n];return a[e]=t,a}))}),[c]),h=a.useMemo((()=>n.split("\n\n").slice(r.current).map(((e,t)=>({idx:t,blockText:e})))),[n]),y=a.useMemo((()=>{const t=[];let n=e||1200,a=h.length-1;const r=function(e){const t=e.findIndex((e=>void 0===e));return-1===t?e.length:t}(i);for(;a>=0&&(n>=0||a>=r);)t.unshift(h[a]),n-=h[a].blockText.length,a--;return t}),[h,i,e]),b=n.length>0;return a.useEffect((()=>{b&&i.length&&h.length&&(d.current.target=i.reduce(((e,t)=>(e||0)+(t||0)),0)+10*h.length)}),[h,b,i]),a.useEffect((e=>{let t,n=!0;return t=requestAnimationFrame((function e(a){const r=d.current;0===r.lastTimestamp&&(r.lastTimestamp=a);let o=Math.min(a-r.lastTimestamp,100);o<.001&&(o=.001),r.lastTimestamp=a;const i=r.curr+r.velocity*o,l=r.target-i;r.curr=i+r.alpha*l,r.velocity=r.velocity+r.beta*l/o;let c=Math.floor(-r.curr+.95*m);const u=m?Math.max(0,c/m):1;c-=u*m*.7,r.currSmoothed+=(c-r.currSmoothed)/30,s.current&&(s.current.style.top=`${r.currSmoothed}px`,s.current.style.filter=`blur(${2*u}px)`,s.current.style.opacity=""+(1-function(e,t,n){let a=Math.max(e,Math.min(t,n));return a=(a-e)/(t-e),a*a*(3-2*a)}(.5,1,u))),n&&(t=requestAnimationFrame(e))})),()=>{cancelAnimationFrame(t),n=!1}}),[s,m]),a.createElement(o.Z,{onLayout:p,style:{flex:1,overflow:"hidden"}},a.createElement(o.Z,{ref:s,style:{paddingEnd:12,position:"absolute",width:"95%"}},y&&y.map(((e,t)=>a.createElement(f,{blockSizes:i,index:e.idx,key:`block${e.idx}`,last:!1,setBlockHeight:g,text:e.blockText})))))}r.TU.use({extensions:[p._,...u.Z]});const b=i.default.create((e=>({text:{lineHeight:e.lineHeights.subtext2}})))},813107:(e,t,n)=>{n.d(t,{I:()=>c});var a=n(202784),r=n(325686),o=n(366635),s=n(392237),i=n(125363),l=n(919022);const c=({screenName:e})=>{const t=(0,i.I0)(),n=(0,i.v9)((t=>l.ZP.selectByScreenName(t,e)));return a.useEffect((()=>{t(l.ZP.fetchOneByScreenNameIfNeeded(e))}),[t,e]),n?a.createElement(a.Fragment,null,a.createElement(r.Z,{style:d.container},a.createElement(o.Z,{isVerified:n.is_blue_verified,name:n.name,profileImageUrl:n.profile_image_url_https,screenName:n.screen_name,withStackedLayout:!0}))):null},d=s.default.create((e=>({container:{flexDirection:"row",gap:e.spaces.space8,justifyContent:"flex-start",alignItems:"stretch",flexWrap:"wrap",paddingHorizontal:e.spaces.space12,paddingVertical:e.spaces.space8,borderRadius:e.borderRadii.large,borderWidth:e.spaces.space1,borderColor:e.colors.gray200},header:{fontSize:e.fontSizes.body}})))},994515:(e,t,n)=>{n.d(t,{U:()=>c});var a=n(202784),r=n(325686),o=n(392237),s=n(988290);n(543673),n(240753),n(128399),n(136728);const i=/^(https?:\/\/)(?:www\.)?(x|twitter)\.com\/([A-Za-z0-9_]+)\/status\/([0-9]+)/;function l(e,t,n,a,r,o){const s=o||r?1:2,{allowXPostEmbeds:l,allowYoutubeEmbeds:c}=a,d=function(e){const t=/\[.*?\]\((.*?)\)/g,n=e.matchAll(t);return Array.from(n,(e=>e[1])).filter((e=>{try{return new URL(e),!0}catch(e){return!1}}))}(e),m=[];if(c){d.filter((e=>{const t=new URL(e);return"www.youtube.com"===t.hostname&&t.searchParams.get("v")})).forEach((e=>{const n=new URL(e),a=n.searchParams.get("v"),r=t.find((t=>t.url===e));"www.youtube.com"===n.hostname&&a&&r&&m.push(`https://www.youtube.com/embed/${a}`)}))}const u=[];if(l){d.filter((e=>i.test(e))).forEach((e=>{const t=function(e){try{const t=e.match(i);return t?t[4]:null}catch(e){return null}}(e);t&&n.includes(t)&&!u.includes(t)&&u.push(t)}))}return{embeddedYoutubeVideoURLs:m.slice(0,1),embeddedPostIds:u.slice(0,s)}}n(299631),n(322314);const c=({postIds:e,response:t,style:n,webResults:o})=>{const{isCompactLayout:i,isGrokDrawer:c}=(0,s.ZP)(),m=!1,u=!1,p=a.useMemo((()=>l(t,o,e,{allowXPostEmbeds:u,allowYoutubeEmbeds:m},i,c)),[t,o,e,u,m,i,c]);return 0===p.embeddedPostIds.length&&0===p.embeddedYoutubeVideoURLs.length?null:a.createElement(r.Z,{style:[d.container,n]},!1,!1)},d=o.default.create((e=>({container:{display:"flex",flexDirection:"column",gap:e.spaces.space12},embeddedXPosts:{width:"100%"}})))},263160:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(202784),r=n(392237),o=n(370751),s=n(725516),i=n(623494);function l(){const e=a.useRef((0,o.Z)([])),t=(0,s.z)();return a.useMemo((()=>({buttonsContainerStyle:c.buttonsContainer,navButtonStyle:c.navButtons,onVisibleRangeChange:({index:n,intersectionRatio:a})=>{if(1!==a)return;if(0===n)return;const r=e.current;r.has(n)||((0,i.hf)(t,n),r.add(n))}})),[t])}const c=r.default.create((e=>({buttonsContainer:{},navButtons:{}})))},819102:(e,t,n)=>{n.d(t,{u:()=>o});var a=n(202784);const r=2;function o(e,t){const n=a.useRef(),[o,i]=a.useState(!1);let l=e;if(t&&o){const t=s(e);t>-1&&(l=e.substring(0,t))}return a.useEffect((()=>{t&&(i(!0),n.current&&clearTimeout(n.current),n.current=window.setTimeout((()=>{i(!1)}),1e3*r))}),[t,l]),l}const s=e=>{let t=-1;(e.match(/\*\*/g)??[]).length%2==1&&(t=e.lastIndexOf("**"));let n=-1;const a=e.lastIndexOf("[](");a>e.lastIndexOf(")")&&(n=a);let r=-1;const o=e.lastIndexOf("\\[");o>e.lastIndexOf("]")&&(r=o);let s=-1;const i=e.lastIndexOf("\\(");i>e.lastIndexOf("\\)")&&(s=i);let l=-1;(e.match(/`/g)??[]).length%2==1&&(l=e.lastIndexOf("`"));let c=-1;const d=/\n+\s*([-*+]|\d+\.)\s*/g;let m;for(;null!==(m=d.exec(e));)if(null!=m?.index){const t=e.substring(m.index+m[0].length);(t.length<10||/^\*\*[^*]*$/.test(t))&&(c=m.index)}const u=[t,r,s,n,l,c].filter((t=>-1!==t&&t>e.length-100));return 0===u.length?e.length:Math.min(...u)}},997041:(e,t,n)=>{n.d(t,{T:()=>a,p:()=>r});n(136728);function a(e,t){let n=e;return n=function(e){const t=/(<grok:render[^>]*>)[\s\S]*?(<\/grok:render>)/g;return e.replace(t,((e,t,n)=>`${t}${n}`))}(n),n=function(e,t){try{const n=/<grok:render(?=.*type="render_inline_citation")(?:.*?card_id="([^"]*)")?(?:.*?card_type="([^"]*)")?.*?>[\s\S]*?<\/grok:render>/g;let a,r=e;const o=new Set;for(;null!==(a=n.exec(e));){if(void 0===a?.index)continue;const s=a.index;if(o.has(s))continue;const i=[];let l,c=s;const d=new RegExp(n.source,"g");for(d.lastIndex=c;null!==(l=d.exec(e))&&void 0!==l?.index;){const n=e.slice(c,l.index);if(c!==l.index&&""!==n.trim())break;const a=l[1];t.find((e=>e.id===a))&&i.push(a),o.add(l.index),c=l.index+l[0].length,d.lastIndex=c}if(i.length>0){const t=c,n=e.slice(s,t),a=` [](grok_render_citation_card_json=${JSON.stringify({cardIds:i})})`;r=r.replace(n,a)}}return r}catch(t){return e}}(n,t),n}function r(e){return e.replace(/<grok:render[\s\S]*?<\/grok:render>/g,(e=>""))}},413145:(e,t,n)=>{n.d(t,{y:()=>C});var a=n(202784),r=n(325686),o=n(721266),s=n(392237),i=n(323265),l=n(125363),c=n(389071),d=n(189953),m=n(654917),u=n(730372),p=n(293115),g=n(725405),h=n(155918),f=n(919022),y=n(464023),b=n(22463),x=n(262985),w=n(848957);const v=s.default.create((e=>({container:{width:"100%",alignItems:"center"}}))),E=function({analysisEntityId:e,containerRef:t,conversationKey:n,id:o,isLastResponse:s,isLoading:i,onLayout:d}){const m=(0,c.bD)(n),u=(0,g.Z)(),E=(0,l.v9)((e=>m?.selectUsingExperiment(e))),k=(0,l.v9)((e=>m?.selectExperiments(e))),C=(0,l.v9)((e=>m.selectMessageById(e,o,!1))),Z=(0,l.v9)((e=>m?.selectConversationId(e)))??"",I=(0,l.v9)((e=>m.selectMessageById(e,o,!0))),_=(0,l.v9)((e=>m.selectPromptSourceForMessageId(e,o))),S=(0,l.v9)(f.ZP.selectViewerUser),T=(0,l.v9)((e=>f.ZP.select(e,y.c0))),R=C?.sender===h.CI.ASSISTANT,P=R?T:S,D=a.useMemo((()=>C?.bannerMessages??[]),[C?.bannerMessages]),M=a.useMemo((()=>({grok_details:{...u.contextualScribeData.grok_details??{},chat_item_id:C?.agentChatItemId}})),[u,C?.agentChatItemId]);return S&&C&&P?E&&R&&(C?.message===(k[0]?.message??null)||null==o)?a.createElement(r.Z,{onLayout:d,ref:t,style:v.container},a.createElement(p.nO,{data:M},a.createElement(w.Z,{conversationId:Z,grokModule:m,isLoading:i,message1:k[0]??C,message2:k[1]??I}))):a.createElement(r.Z,{onLayout:d,ref:t,style:v.container},R?a.createElement(p.nO,{data:M},a.createElement(x.Z,{allowRetry:C.allowRetry,analysisEntityId:e,bannerMessages:D,cardAttachments:C.cardAttachments,chatItemId:C.agentChatItemId,chatResponseAnnotations:C.chatResponseAnnotations,citedWebResults:C.citedWebResults,conversationKey:n,disclaimer:C.disclaimer,error:C.error,expectedImageAspectRatio:C.expectedImageAspectRatio,fileAttachments:C.fileAttachments,id:o,intermediateImageResults:C.intermediateImageResults,isAborted:C.isAborted,isDeleted:C.isDeleted,isLastResponse:s,isLoading:i,isPastThinkingTrace:C.isPastThinkingTrace,memoryReferences:C.memoryReferences,messageStepAccumulator:C.messageStepAccumulator,performanceMetrics:C.performanceMetrics,promptSource:_,query:C.query,sender:C.sender,streamDisconnected:C.streamDisconnected,text:C.message,trace:C.thinkingTrace,tweetIds:C.postIds,uiLayout:C.uiLayout,upsell:C.upsell,userChatItemId:C.userChatItemId||"",webResults:C.webResults})):a.createElement(b.Z,{bannerMessages:D,conversationKey:n,fileAttachments:C.fileAttachments,hideAttachments:C.hideAttachments,id:o,isDeepsearch:C.isDeepsearch,isReasoning:C.isReasoning,text:C.message,user:{profile_image_shape:P.profile_image_shape,profile_image_url_https:P.profile_image_url_https}})):null};var k=n(988290);const C=({contentPadding:e})=>{const{analysisEntityId:t,conversationKey:n,messageIds:s,status:p}=(0,m.ZP)(),{isPagedScroll:g,scrollable:h}=(0,k.ZP)(),f=(0,c.bD)(n),y=(0,l.v9)(f.selectEditingMessage);(0,u.$E)();const b=a.useMemo((()=>p!==d.Q_.IDLE?[...s,null]:s),[p,s]),x=i.ZP.isWebView(),w=a.useRef(0);a.useEffect((()=>{const e=()=>{const e=h?h===window?window.innerHeight:h.scrollHeight:0;w.current=Math.max(e,w.current)};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[h]);const v=p===d.Q_.IDLE?void 0:b[b.length-2],C=a.useRef(),[I,_]=a.useState(!1),[S,T]=a.useState(0);a.useLayoutEffect((()=>{if(!I||!y&&v&&g&&S>0){_(!0);const e=h===window?document.body.scrollHeight:h?.scrollHeight;h?.scroll({top:e,behavior:"smooth"})}}),[v,y,I,g,S,h]);const R=a.useCallback((t=>{const n=t.nativeEvent.layout.height;let a=h===window?h.innerHeight:h?.clientHeight??0;x&&(a=Math.max(w.current,a));const r=n>.6*a?Math.max(0,a-e-50):Math.max(0,a-n-e);T(r)}),[h,x,e]),P=a.useMemo((()=>({minHeight:g?S:0})),[S,g]),D=a.useCallback((({index:e,item:o})=>{const s=b.length,i=o===v;return i||e<s-1?a.createElement(r.Z,{key:`message_${e}`},a.createElement(E,{analysisEntityId:t,conversationKey:n,id:o,onLayout:i?R:void 0})):a.createElement(r.Z,{key:`message_${e}`,style:[Z.lastResponse,P]},a.createElement(E,{analysisEntityId:t,conversationKey:n,id:o,isLastResponse:!0,isLoading:p===d.Q_.TYPING||p===d.Q_.WAITING}))}),[v,n,P,t,R,p,b]);return a.createElement(r.Z,{ref:C,style:[Z.content,g?void 0:Z.bottomScroll]},a.createElement(o.Z,{size:"space8"}),a.createElement(r.Z,{style:{flexDirection:"column"}},a.createElement(o.Z,{size:"space12"}),b.map(((e,t)=>D({item:e,index:t})))))},Z=s.default.create((e=>({lastResponse:{width:"100%"},content:{flexGrow:"1"},bottomScroll:{overflow:"auto",flexDirection:"column-reverse",height:"fit-content",maxHeight:"100%",borderWidth:15,borderColor:"green"}})))}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/bundle.Grok-7a6ce5c4.e614c19a.js.map